%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:26 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (1y26_x)
} def

/sequence { (\
GCUUCAUAUAAUCCUAAUGAUAUGGUUUGGGAGUUUCUACCAAGAGCCUUAAACUCUUGAUUAUGAAGUG\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 69 0.964086629 ubox
2 33 0.003569917 ubox
2 68 0.999371450 ubox
3 32 0.003549670 ubox
3 67 0.999251503 ubox
4 31 0.003513102 ubox
4 66 0.999470272 ubox
5 30 0.003479275 ubox
5 65 0.999424351 ubox
6 36 0.003259276 ubox
6 38 0.004966848 ubox
6 61 0.003580410 ubox
6 64 0.988371321 ubox
7 22 0.003449494 ubox
7 33 0.003378442 ubox
7 39 0.012767177 ubox
7 60 0.006263553 ubox
7 63 0.963030884 ubox
7 65 0.028656413 ubox
8 21 0.003847626 ubox
8 23 0.009723055 ubox
8 34 0.030351687 ubox
8 35 0.023338951 ubox
8 36 0.045636653 ubox
8 38 0.018395313 ubox
8 61 0.129153585 ubox
8 62 0.889949944 ubox
8 64 0.120771202 ubox
9 16 0.009188999 ubox
9 20 0.003874747 ubox
9 22 0.013274848 ubox
9 24 0.004925087 ubox
9 29 0.030713895 ubox
9 32 0.007246908 ubox
9 33 0.040635936 ubox
9 39 0.021541231 ubox
9 59 0.019992898 ubox
9 60 0.174075989 ubox
9 63 0.221044395 ubox
10 15 0.009241887 ubox
10 18 0.003219986 ubox
10 21 0.010412496 ubox
10 23 0.007170790 ubox
10 27 0.019619863 ubox
10 28 0.036544190 ubox
10 34 0.119841744 ubox
10 35 0.162974062 ubox
10 36 0.061060198 ubox
10 38 0.019513052 ubox
10 58 0.021442334 ubox
10 61 0.084642303 ubox
10 62 0.274371011 ubox
11 18 0.008307467 ubox
11 21 0.065993898 ubox
11 23 0.004449037 ubox
11 26 0.022838981 ubox
11 27 0.035732403 ubox
11 28 0.006283872 ubox
11 34 0.171639194 ubox
11 35 0.062372331 ubox
11 36 0.022201435 ubox
11 38 0.014265618 ubox
11 57 0.017732664 ubox
11 58 0.013647153 ubox
11 61 0.349741746 ubox
11 62 0.010513338 ubox
12 17 0.007960583 ubox
12 20 0.069628488 ubox
12 22 0.004162527 ubox
12 25 0.019502330 ubox
12 31 0.060056374 ubox
12 32 0.851827773 ubox
12 33 0.090893900 ubox
12 59 0.005994399 ubox
12 60 0.357866854 ubox
12 66 0.004032285 ubox
13 19 0.069401874 ubox
13 24 0.019756941 ubox
13 25 0.053998160 ubox
13 29 0.003785291 ubox
13 30 0.095441768 ubox
13 31 0.915715964 ubox
13 59 0.351901188 ubox
13 65 0.004297752 ubox
14 19 0.056286544 ubox
14 24 0.055291215 ubox
14 25 0.025478223 ubox
14 29 0.096053698 ubox
14 30 0.915988816 ubox
14 31 0.006085695 ubox
14 33 0.005271958 ubox
14 59 0.031743722 ubox
15 19 0.003594801 ubox
15 20 0.006039285 ubox
15 22 0.028268078 ubox
15 24 0.026307853 ubox
15 29 0.912540799 ubox
15 30 0.005774990 ubox
15 32 0.005271983 ubox
15 59 0.023283673 ubox
15 63 0.040820405 ubox
16 21 0.027029796 ubox
16 23 0.026041892 ubox
16 26 0.005213809 ubox
16 27 0.253940169 ubox
16 28 0.876183085 ubox
16 55 0.015051365 ubox
16 57 0.045186891 ubox
16 58 0.068540785 ubox
16 61 0.006274331 ubox
16 62 0.053552665 ubox
17 21 0.005714205 ubox
17 23 0.017907559 ubox
17 26 0.352463976 ubox
17 27 0.817511399 ubox
17 28 0.019831793 ubox
17 55 0.034397455 ubox
17 57 0.074462331 ubox
17 58 0.042845736 ubox
17 61 0.071745035 ubox
17 62 0.003612322 ubox
17 64 0.010813867 ubox
18 22 0.019458332 ubox
18 24 0.040517598 ubox
18 25 0.420559545 ubox
18 29 0.009348305 ubox
18 51 0.016646930 ubox
18 52 0.012051839 ubox
18 53 0.029699461 ubox
18 59 0.013931872 ubox
18 60 0.071547803 ubox
18 63 0.018778960 ubox
19 23 0.029834678 ubox
19 26 0.073123859 ubox
19 27 0.106314640 ubox
19 28 0.038245877 ubox
19 37 0.003954207 ubox
19 50 0.017727253 ubox
19 54 0.065562324 ubox
19 55 0.010617043 ubox
19 56 0.134325636 ubox
19 57 0.006213379 ubox
19 58 0.085631968 ubox
19 61 0.008684672 ubox
19 62 0.025167032 ubox
20 26 0.130472380 ubox
20 27 0.047281359 ubox
20 28 0.005955850 ubox
20 36 0.003883173 ubox
20 49 0.017519857 ubox
20 50 0.011091759 ubox
20 55 0.114261990 ubox
20 57 0.085089099 ubox
20 58 0.063976876 ubox
20 61 0.030324243 ubox
21 25 0.122864691 ubox
21 29 0.003330559 ubox
21 51 0.179058061 ubox
21 52 0.016957941 ubox
21 53 0.012611495 ubox
21 59 0.024573709 ubox
21 60 0.028862856 ubox
22 26 0.010902396 ubox
22 27 0.012725088 ubox
22 28 0.005223648 ubox
22 49 0.026879311 ubox
22 50 0.181765975 ubox
22 55 0.005664540 ubox
22 57 0.052047658 ubox
22 58 0.044694908 ubox
22 61 0.007296913 ubox
23 39 0.004541654 ubox
23 42 0.018562010 ubox
23 51 0.005467500 ubox
23 52 0.007471306 ubox
23 59 0.004046667 ubox
23 60 0.007433698 ubox
23 63 0.003406465 ubox
24 38 0.005126020 ubox
24 41 0.027892418 ubox
24 47 0.007741995 ubox
24 48 0.295179356 ubox
24 49 0.004963944 ubox
24 54 0.008210583 ubox
24 55 0.205416799 ubox
24 56 0.063251386 ubox
24 57 0.004583459 ubox
24 62 0.004438946 ubox
25 37 0.005175175 ubox
25 40 0.028942090 ubox
25 47 0.295559440 ubox
25 48 0.004699610 ubox
25 54 0.239901653 ubox
25 55 0.007841459 ubox
25 56 0.003716253 ubox
25 61 0.006752573 ubox
26 39 0.026576352 ubox
26 44 0.040156121 ubox
26 45 0.021845886 ubox
26 46 0.290469868 ubox
26 53 0.240170269 ubox
26 60 0.006394350 ubox
27 43 0.131086757 ubox
27 44 0.023100552 ubox
27 45 0.255390086 ubox
27 52 0.240006502 ubox
27 59 0.005546486 ubox
27 60 0.020914090 ubox
28 39 0.037678549 ubox
28 42 0.174265819 ubox
28 43 0.021909234 ubox
28 44 0.233200524 ubox
28 51 0.239912368 ubox
28 59 0.023159708 ubox
29 36 0.006450859 ubox
29 37 0.014025115 ubox
29 38 0.046775613 ubox
29 40 0.007966374 ubox
29 41 0.193387020 ubox
29 49 0.015149289 ubox
29 50 0.239134060 ubox
29 58 0.029274792 ubox
30 35 0.005444204 ubox
30 36 0.013098911 ubox
30 37 0.047816870 ubox
30 38 0.035907499 ubox
30 40 0.193184533 ubox
30 41 0.156409718 ubox
30 48 0.020605925 ubox
30 49 0.238908435 ubox
30 57 0.032286346 ubox
31 35 0.008737820 ubox
31 36 0.037796954 ubox
31 37 0.048291237 ubox
31 38 0.011344624 ubox
31 40 0.156919470 ubox
31 41 0.157735150 ubox
31 47 0.020577426 ubox
31 48 0.239078673 ubox
31 50 0.011195393 ubox
31 56 0.033981455 ubox
32 36 0.042559584 ubox
32 38 0.150698211 ubox
32 49 0.014475993 ubox
32 55 0.034107496 ubox
32 62 0.004628808 ubox
33 37 0.172305646 ubox
33 38 0.036954141 ubox
33 40 0.494447048 ubox
33 41 0.007779347 ubox
33 47 0.232166952 ubox
33 48 0.016061505 ubox
33 54 0.034217524 ubox
33 61 0.016471588 ubox
34 39 0.483068967 ubox
34 44 0.007891855 ubox
34 45 0.036302851 ubox
34 46 0.199536836 ubox
34 53 0.034118739 ubox
34 60 0.016951959 ubox
34 68 0.004032834 ubox
35 39 0.017783153 ubox
35 43 0.008523533 ubox
35 44 0.036369870 ubox
35 45 0.159830874 ubox
35 46 0.127737585 ubox
35 52 0.031777442 ubox
35 59 0.005711545 ubox
35 60 0.007916571 ubox
35 67 0.005583929 ubox
36 42 0.008372392 ubox
36 43 0.032206014 ubox
36 44 0.105580050 ubox
36 45 0.175460194 ubox
36 51 0.026591617 ubox
36 60 0.017108318 ubox
36 66 0.005919069 ubox
37 44 0.211958762 ubox
37 46 0.015277900 ubox
37 59 0.014616412 ubox
37 65 0.005962085 ubox
38 42 0.021697060 ubox
38 43 0.202241793 ubox
38 44 0.003327233 ubox
38 45 0.014922832 ubox
38 59 0.003168711 ubox
38 60 0.020540152 ubox
38 63 0.010775524 ubox
39 61 0.085753952 ubox
39 62 0.013715994 ubox
40 44 0.003789504 ubox
40 46 0.005678372 ubox
40 59 0.026988328 ubox
41 46 0.012897475 ubox
41 59 0.919773778 ubox
42 50 0.009621191 ubox
42 58 0.922270383 ubox
43 49 0.009753384 ubox
43 57 0.923010369 ubox
44 48 0.009558420 ubox
44 56 0.923636031 ubox
45 55 0.923288458 ubox
46 54 0.920416535 ubox
49 53 0.028361452 ubox
49 60 0.014160964 ubox
50 59 0.015410689 ubox
51 58 0.015570884 ubox
52 57 0.013650476 ubox
54 59 0.008132639 ubox
1 69 0.9500000 lbox
2 68 0.9500000 lbox
3 67 0.9500000 lbox
4 66 0.9500000 lbox
5 65 0.9500000 lbox
6 64 0.9500000 lbox
7 63 0.9500000 lbox
8 62 0.9500000 lbox
12 32 0.9500000 lbox
13 31 0.9500000 lbox
14 30 0.9500000 lbox
15 29 0.9500000 lbox
16 28 0.9500000 lbox
17 27 0.9500000 lbox
41 59 0.9500000 lbox
42 58 0.9500000 lbox
43 57 0.9500000 lbox
44 56 0.9500000 lbox
45 55 0.9500000 lbox
46 54 0.9500000 lbox
showpage
end
%%EOF
