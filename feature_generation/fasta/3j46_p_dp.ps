%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:31 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (3j46_p)
} def

/sequence { (\
GCGGGAAUAGCUCAGUUGGUAGAGCACGACCUUGCCAAGGUCGGGGUCGCGAGUUCGAGUCUCGUUUCCCGCUCCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 11 0.004330433 ubox
1 72 0.997170737 ubox
1 73 0.006017501 ubox
1 74 0.004861006 ubox
1 75 0.012241113 ubox
2 10 0.004338077 ubox
2 71 0.998909117 ubox
3 13 0.004258337 ubox
3 69 0.007957672 ubox
3 70 0.998895452 ubox
3 74 0.013299943 ubox
3 75 0.021798274 ubox
4 12 0.004272179 ubox
4 68 0.011062043 ubox
4 69 0.998875522 ubox
4 73 0.013334905 ubox
4 74 0.021729021 ubox
4 75 0.035059591 ubox
5 11 0.004271909 ubox
5 67 0.013429752 ubox
5 68 0.998778670 ubox
5 72 0.014784109 ubox
5 73 0.017196362 ubox
5 74 0.035138742 ubox
6 65 0.004415080 ubox
6 66 0.081218597 ubox
6 67 0.983581102 ubox
6 73 0.033507159 ubox
7 20 0.003586992 ubox
7 62 0.003791569 ubox
7 65 0.110196773 ubox
7 66 0.860066604 ubox
7 67 0.018982688 ubox
8 18 0.020793453 ubox
8 21 0.042406731 ubox
8 26 0.077158040 ubox
8 64 0.126082088 ubox
8 71 0.006075880 ubox
9 17 0.023559181 ubox
9 20 0.044642330 ubox
9 55 0.006071786 ubox
9 62 0.187732870 ubox
9 65 0.070653674 ubox
9 66 0.024088971 ubox
9 67 0.003326457 ubox
10 16 0.024414476 ubox
10 20 0.037755297 ubox
10 25 0.961099223 ubox
10 47 0.007608919 ubox
10 54 0.007443449 ubox
10 60 0.163694133 ubox
10 61 0.190858846 ubox
10 62 0.004359490 ubox
10 63 0.064658366 ubox
10 65 0.015527204 ubox
11 15 0.024339101 ubox
11 18 0.046054645 ubox
11 19 0.038713597 ubox
11 22 0.003413267 ubox
11 24 0.962196425 ubox
11 46 0.008117949 ubox
11 53 0.007660938 ubox
11 59 0.260261221 ubox
11 64 0.015617407 ubox
12 18 0.033958316 ubox
12 19 0.009011443 ubox
12 21 0.003641920 ubox
12 23 0.962048888 ubox
12 45 0.008103458 ubox
12 52 0.007656693 ubox
12 58 0.260277667 ubox
13 18 0.019344847 ubox
13 19 0.006546964 ubox
13 22 0.961889090 ubox
13 44 0.008058039 ubox
13 51 0.007635026 ubox
13 57 0.259999206 ubox
14 20 0.146926137 ubox
14 54 0.044112472 ubox
14 55 0.208232490 ubox
14 60 0.013064219 ubox
14 62 0.016069678 ubox
15 20 0.047865921 ubox
15 25 0.021334944 ubox
15 27 0.003341470 ubox
15 50 0.005232946 ubox
15 54 0.198938687 ubox
15 55 0.039064813 ubox
15 56 0.043569374 ubox
15 61 0.016392742 ubox
15 63 0.005066567 ubox
16 21 0.037348918 ubox
16 24 0.021318943 ubox
16 49 0.005169024 ubox
16 52 0.057708565 ubox
16 53 0.216309575 ubox
16 58 0.017958113 ubox
16 59 0.006883548 ubox
17 21 0.010350812 ubox
17 23 0.021058094 ubox
17 26 0.007856242 ubox
17 51 0.057225100 ubox
17 52 0.234056097 ubox
17 53 0.024992193 ubox
17 57 0.018093607 ubox
17 58 0.007052774 ubox
17 59 0.004924825 ubox
18 25 0.009156854 ubox
18 50 0.053861185 ubox
18 54 0.005033551 ubox
18 56 0.018610810 ubox
18 60 0.005583796 ubox
18 61 0.003927614 ubox
18 62 0.004974550 ubox
19 25 0.004796590 ubox
19 48 0.003914353 ubox
19 50 0.242726948 ubox
19 55 0.017471124 ubox
19 56 0.008277280 ubox
19 60 0.003695903 ubox
19 61 0.005142841 ubox
20 24 0.004508079 ubox
20 49 0.227824290 ubox
20 51 0.006055877 ubox
20 52 0.004173123 ubox
20 58 0.006330257 ubox
21 47 0.004920309 ubox
21 55 0.007126022 ubox
22 47 0.007972846 ubox
22 48 0.262577428 ubox
22 54 0.008448244 ubox
22 56 0.051991390 ubox
22 74 0.006883518 ubox
23 47 0.262113473 ubox
23 55 0.052080737 ubox
23 73 0.007086774 ubox
24 47 0.019665063 ubox
24 50 0.008516461 ubox
24 54 0.052067429 ubox
24 72 0.007099175 ubox
25 44 0.025253940 ubox
25 45 0.253133228 ubox
25 46 0.024420948 ubox
25 49 0.007810646 ubox
25 51 0.018999782 ubox
25 53 0.051894852 ubox
25 71 0.007092276 ubox
26 47 0.007861109 ubox
26 65 0.003487327 ubox
27 43 0.457631215 ubox
27 44 0.019053173 ubox
27 45 0.004855643 ubox
27 46 0.006637358 ubox
27 49 0.733732754 ubox
28 42 0.463439262 ubox
28 48 0.885656754 ubox
29 41 0.463436384 ubox
29 47 0.885897958 ubox
30 40 0.463477089 ubox
30 45 0.020395436 ubox
30 46 0.885841137 ubox
31 39 0.463443812 ubox
31 40 0.004260010 ubox
31 44 0.027878251 ubox
31 45 0.885632190 ubox
32 37 0.011608205 ubox
32 38 0.456515143 ubox
32 39 0.006037737 ubox
32 43 0.033122071 ubox
32 44 0.883604049 ubox
33 37 0.380072147 ubox
33 38 0.036681883 ubox
33 40 0.003706181 ubox
33 43 0.876298588 ubox
33 44 0.004828764 ubox
34 41 0.143694129 ubox
34 42 0.871717597 ubox
35 39 0.023014230 ubox
35 40 0.850738372 ubox
35 43 0.005123493 ubox
35 44 0.030077184 ubox
36 40 0.141435157 ubox
36 43 0.031015751 ubox
37 41 0.010104296 ubox
42 64 0.005152276 ubox
43 48 0.010723931 ubox
43 62 0.022822434 ubox
43 63 0.027501192 ubox
43 70 0.004999128 ubox
44 48 0.030970081 ubox
44 50 0.008727634 ubox
44 56 0.003236685 ubox
44 61 0.070368274 ubox
44 62 0.032941093 ubox
44 63 0.167118382 ubox
44 65 0.004713177 ubox
44 66 0.004395986 ubox
44 69 0.005619061 ubox
44 70 0.045485841 ubox
45 50 0.009480259 ubox
45 55 0.003234181 ubox
45 60 0.070315000 ubox
45 61 0.034498725 ubox
45 62 0.167563632 ubox
45 63 0.007680068 ubox
45 66 0.006948935 ubox
45 67 0.005086795 ubox
45 68 0.006006499 ubox
45 69 0.045618586 ubox
46 60 0.032024209 ubox
46 61 0.167722783 ubox
46 62 0.004509793 ubox
46 63 0.006341697 ubox
46 65 0.004291580 ubox
46 66 0.009240795 ubox
46 67 0.007497754 ubox
46 68 0.045703097 ubox
47 58 0.080141037 ubox
47 59 0.004364273 ubox
48 53 0.003942387 ubox
48 57 0.080639020 ubox
48 59 0.157556638 ubox
48 64 0.011030748 ubox
49 56 0.077319917 ubox
49 60 0.016072121 ubox
49 63 0.012190403 ubox
49 65 0.575007358 ubox
49 66 0.013470656 ubox
50 57 0.167766016 ubox
50 59 0.018187181 ubox
50 64 0.933476588 ubox
51 55 0.005498278 ubox
51 56 0.166089019 ubox
51 61 0.024428915 ubox
51 63 0.945271263 ubox
52 60 0.024324790 ubox
52 62 0.945083054 ubox
53 60 0.006539935 ubox
53 61 0.943853024 ubox
54 58 0.024295051 ubox
54 59 0.143856633 ubox
55 59 0.081634735 ubox
56 64 0.033468443 ubox
57 61 0.003249812 ubox
57 63 0.034902273 ubox
58 62 0.030375262 ubox
58 65 0.003374269 ubox
1 72 0.9500000 lbox
2 71 0.9500000 lbox
3 70 0.9500000 lbox
4 69 0.9500000 lbox
5 68 0.9500000 lbox
6 67 0.9500000 lbox
7 66 0.9500000 lbox
10 25 0.9500000 lbox
11 24 0.9500000 lbox
12 23 0.9500000 lbox
13 22 0.9500000 lbox
27 49 0.9500000 lbox
28 48 0.9500000 lbox
29 47 0.9500000 lbox
30 46 0.9500000 lbox
31 45 0.9500000 lbox
32 44 0.9500000 lbox
33 43 0.9500000 lbox
34 42 0.9500000 lbox
35 40 0.9500000 lbox
50 64 0.9500000 lbox
51 63 0.9500000 lbox
52 62 0.9500000 lbox
53 61 0.9500000 lbox
showpage
end
%%EOF
