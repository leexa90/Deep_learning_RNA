%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:05:10 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (5t7v_d)
} def

/sequence { (\
CCCGGAUAGCUCAGUCGGUAGAGCAGGGGAUUGAAAAUCCCCGUGUCCUUGGUUCGAUUCCGAGUCCGGGCAC\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 5 0.004190425 ubox
1 69 0.009236417 ubox
1 70 0.976523620 ubox
2 18 0.016775397 ubox
2 68 0.006690077 ubox
2 69 0.990176468 ubox
2 70 0.006650896 ubox
3 17 0.016864060 ubox
3 18 0.005159669 ubox
3 68 0.990251560 ubox
3 69 0.005413562 ubox
4 16 0.015010129 ubox
4 48 0.020661402 ubox
4 67 0.990111575 ubox
5 12 0.003356892 ubox
5 15 0.010231841 ubox
5 16 0.010039527 ubox
5 47 0.021523418 ubox
5 66 0.989834375 ubox
5 67 0.003489378 ubox
6 11 0.003162394 ubox
6 15 0.012681748 ubox
6 44 0.003628802 ubox
6 46 0.022247194 ubox
6 65 0.849118461 ubox
7 13 0.004841196 ubox
7 14 0.012482873 ubox
7 20 0.018184898 ubox
7 25 0.052476928 ubox
7 43 0.003887880 ubox
7 45 0.022488230 ubox
7 62 0.003585283 ubox
7 63 0.017176891 ubox
7 64 0.540235680 ubox
8 19 0.019601938 ubox
8 44 0.020668513 ubox
8 54 0.008817980 ubox
8 59 0.004095570 ubox
8 65 0.023508579 ubox
9 15 0.007939834 ubox
9 16 0.004036202 ubox
9 19 0.037662246 ubox
9 24 0.641883591 ubox
9 53 0.014831545 ubox
9 58 0.003445622 ubox
9 60 0.036369531 ubox
9 61 0.156287243 ubox
9 65 0.453884196 ubox
9 66 0.003241599 ubox
10 14 0.008649399 ubox
10 17 0.020280392 ubox
10 18 0.038598982 ubox
10 21 0.008787257 ubox
10 23 0.643382511 ubox
10 52 0.015216897 ubox
10 62 0.275222673 ubox
10 64 0.620065762 ubox
11 17 0.034458586 ubox
11 18 0.008181211 ubox
11 20 0.008685696 ubox
11 22 0.643393535 ubox
11 51 0.006378242 ubox
11 52 0.008120112 ubox
11 57 0.013649550 ubox
11 62 0.021677247 ubox
11 63 0.640124358 ubox
12 17 0.017743454 ubox
12 18 0.007125166 ubox
12 21 0.643282287 ubox
12 51 0.017141418 ubox
12 56 0.013777023 ubox
12 62 0.638206662 ubox
12 64 0.004191075 ubox
13 19 0.098317492 ubox
13 49 0.004480961 ubox
13 50 0.017168587 ubox
13 54 0.008536301 ubox
13 58 0.011988583 ubox
13 59 0.623708416 ubox
13 65 0.007330977 ubox
14 19 0.032014605 ubox
14 24 0.005125313 ubox
14 48 0.004330133 ubox
14 49 0.013162380 ubox
14 53 0.008587479 ubox
14 54 0.003333230 ubox
14 55 0.007595921 ubox
14 58 0.751667434 ubox
14 59 0.018775992 ubox
14 60 0.069174559 ubox
14 61 0.023353714 ubox
15 20 0.012010409 ubox
15 22 0.023714024 ubox
15 52 0.010473467 ubox
15 57 0.759095355 ubox
15 63 0.060880606 ubox
16 21 0.025994562 ubox
16 51 0.012203228 ubox
16 52 0.012910801 ubox
16 56 0.759643506 ubox
16 62 0.061347018 ubox
17 48 0.026237117 ubox
17 49 0.004679455 ubox
17 50 0.011110756 ubox
17 53 0.025496164 ubox
17 54 0.016509477 ubox
17 55 0.757697146 ubox
17 59 0.003387869 ubox
17 61 0.061617305 ubox
18 24 0.003950155 ubox
18 47 0.026632953 ubox
18 48 0.008139140 ubox
18 49 0.008851433 ubox
18 50 0.039036712 ubox
18 53 0.075093690 ubox
18 54 0.667103145 ubox
18 55 0.011068867 ubox
18 58 0.004284299 ubox
18 60 0.061542512 ubox
19 23 0.003716490 ubox
19 51 0.248600837 ubox
19 52 0.051517346 ubox
19 57 0.007126647 ubox
20 46 0.006758903 ubox
20 49 0.479398854 ubox
20 50 0.224485944 ubox
20 53 0.048200640 ubox
20 54 0.005248187 ubox
20 58 0.007501656 ubox
20 59 0.005207328 ubox
21 46 0.005898155 ubox
21 47 0.137299802 ubox
21 48 0.530631041 ubox
21 49 0.152734305 ubox
21 50 0.444395191 ubox
21 53 0.005355451 ubox
21 54 0.015708352 ubox
21 55 0.057497409 ubox
22 44 0.004211113 ubox
22 46 0.132723638 ubox
22 49 0.444164084 ubox
22 50 0.098319481 ubox
22 53 0.020038870 ubox
22 54 0.057464280 ubox
23 44 0.064454389 ubox
23 46 0.608070787 ubox
23 47 0.174653761 ubox
23 48 0.382407753 ubox
23 49 0.031853039 ubox
23 50 0.008438707 ubox
23 53 0.052648107 ubox
24 43 0.075895723 ubox
24 45 0.720573765 ubox
24 51 0.023625939 ubox
24 52 0.050805753 ubox
25 44 0.695888088 ubox
25 46 0.041520795 ubox
25 49 0.006057666 ubox
25 50 0.025646382 ubox
26 41 0.005136053 ubox
26 42 0.994750190 ubox
26 48 0.005601975 ubox
26 49 0.011746509 ubox
26 50 0.030051231 ubox
27 40 0.004885007 ubox
27 41 0.996148112 ubox
27 42 0.064727276 ubox
27 47 0.005113681 ubox
27 48 0.011208214 ubox
27 49 0.038135264 ubox
27 61 0.042379307 ubox
28 39 0.004580848 ubox
28 40 0.996531312 ubox
28 41 0.058783445 ubox
28 46 0.004518923 ubox
28 47 0.010835666 ubox
28 48 0.038425615 ubox
28 60 0.042447819 ubox
29 38 0.003812317 ubox
29 39 0.996895710 ubox
29 40 0.052117144 ubox
29 46 0.009346287 ubox
29 47 0.038503009 ubox
29 59 0.042447283 ubox
30 38 0.995539702 ubox
30 44 0.006033496 ubox
30 46 0.038521525 ubox
30 58 0.042516170 ubox
31 35 0.007645422 ubox
31 36 0.027218675 ubox
31 37 0.978666252 ubox
31 43 0.005566144 ubox
31 45 0.037124272 ubox
31 57 0.042556113 ubox
32 36 0.815089062 ubox
32 37 0.085890464 ubox
32 43 0.025447949 ubox
32 56 0.042539824 ubox
33 39 0.009187980 ubox
33 40 0.003849155 ubox
33 41 0.007602486 ubox
33 42 0.031424647 ubox
33 55 0.042574849 ubox
34 38 0.008061437 ubox
34 54 0.042390866 ubox
35 53 0.041486609 ubox
36 53 0.003740433 ubox
37 53 0.003759870 ubox
38 52 0.003521354 ubox
39 51 0.003578663 ubox
39 52 0.010514800 ubox
40 51 0.010478765 ubox
40 52 0.008013608 ubox
41 51 0.007602602 ubox
41 52 0.040018402 ubox
42 51 0.040435145 ubox
42 62 0.006060061 ubox
43 47 0.039276821 ubox
43 48 0.050047430 ubox
43 49 0.006095148 ubox
43 50 0.039001484 ubox
43 55 0.004581805 ubox
43 60 0.041697675 ubox
43 61 0.017988088 ubox
43 65 0.003744509 ubox
43 73 0.136394320 ubox
44 51 0.009785225 ubox
44 52 0.006283341 ubox
44 56 0.004634231 ubox
44 62 0.004002919 ubox
44 72 0.137756023 ubox
45 49 0.003462611 ubox
45 50 0.012916364 ubox
45 53 0.005961352 ubox
45 55 0.006227774 ubox
45 58 0.052762075 ubox
45 60 0.003429920 ubox
45 61 0.004933024 ubox
45 65 0.006855243 ubox
45 66 0.003972344 ubox
45 71 0.138226782 ubox
45 73 0.005168325 ubox
46 51 0.004311146 ubox
46 52 0.014997052 ubox
46 57 0.055041720 ubox
46 63 0.015745244 ubox
46 70 0.131827248 ubox
46 72 0.005175626 ubox
47 51 0.020167756 ubox
47 52 0.013583270 ubox
47 56 0.055201432 ubox
47 62 0.016560506 ubox
47 64 0.019460418 ubox
47 69 0.131636879 ubox
47 70 0.040744890 ubox
48 52 0.009735110 ubox
48 56 0.004808240 ubox
48 62 0.007857788 ubox
48 64 0.535468018 ubox
48 68 0.129753823 ubox
48 69 0.040910236 ubox
48 70 0.010695730 ubox
49 57 0.008895784 ubox
49 62 0.005179828 ubox
49 63 0.598116803 ubox
49 64 0.003779218 ubox
49 68 0.031328763 ubox
49 69 0.014353019 ubox
50 56 0.009601266 ubox
50 57 0.003604763 ubox
50 62 0.604928052 ubox
50 63 0.010279632 ubox
50 68 0.034778260 ubox
51 55 0.009750308 ubox
51 59 0.003270092 ubox
51 60 0.014681288 ubox
51 61 0.609539768 ubox
51 65 0.003969351 ubox
51 66 0.048340925 ubox
51 67 0.129108437 ubox
52 58 0.004844574 ubox
52 59 0.015191876 ubox
52 60 0.608889631 ubox
52 61 0.008162038 ubox
52 65 0.046792609 ubox
52 66 0.129677029 ubox
53 57 0.013256926 ubox
53 63 0.006213566 ubox
53 64 0.138761981 ubox
54 63 0.197540469 ubox
55 62 0.202503399 ubox
55 64 0.003221176 ubox
56 60 0.003815107 ubox
56 61 0.199803467 ubox
1 70 0.9500000 lbox
2 69 0.9500000 lbox
3 68 0.9500000 lbox
4 67 0.9500000 lbox
5 66 0.9500000 lbox
6 65 0.9500000 lbox
9 24 0.9500000 lbox
10 23 0.9500000 lbox
11 22 0.9500000 lbox
12 21 0.9500000 lbox
26 42 0.9500000 lbox
27 41 0.9500000 lbox
28 40 0.9500000 lbox
29 39 0.9500000 lbox
30 38 0.9500000 lbox
31 37 0.9500000 lbox
32 36 0.9500000 lbox
48 64 0.9500000 lbox
49 63 0.9500000 lbox
50 62 0.9500000 lbox
51 61 0.9500000 lbox
52 60 0.9500000 lbox
showpage
end
%%EOF
