%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:05:06 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (5mrc_bb)
} def

/sequence { (\
GCUACGUAGCUCAGUUGGUAGAGCACAUCACUCAUAAUGAUGGGGUCACAGGUUCGAAUCCCGUCGUAGCCACCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 5 0.005043433 ubox
1 7 0.006511391 ubox
1 10 0.055268141 ubox
1 19 0.006622122 ubox
1 24 0.022840432 ubox
1 29 0.008264460 ubox
1 31 0.012112265 ubox
1 33 0.006416761 ubox
1 70 0.984808539 ubox
1 71 0.093765749 ubox
1 73 0.005252666 ubox
1 74 0.008049965 ubox
2 6 0.006713957 ubox
2 9 0.055353907 ubox
2 14 0.003371496 ubox
2 18 0.006879570 ubox
2 21 0.019554091 ubox
2 23 0.022696715 ubox
2 69 0.992476804 ubox
3 8 0.051801636 ubox
3 13 0.003256884 ubox
3 17 0.006746145 ubox
3 20 0.021011440 ubox
3 22 0.021718512 ubox
3 27 0.003476246 ubox
3 30 0.003518883 ubox
3 68 0.991749524 ubox
4 15 0.007777294 ubox
4 16 0.004958868 ubox
4 19 0.022347320 ubox
4 28 0.014977364 ubox
4 67 0.987227017 ubox
5 14 0.009372563 ubox
5 18 0.022423112 ubox
5 21 0.013498697 ubox
5 66 0.984821067 ubox
5 69 0.003636578 ubox
6 12 0.009132222 ubox
6 24 0.006046510 ubox
6 26 0.797218548 ubox
6 28 0.047510890 ubox
6 29 0.065721760 ubox
6 31 0.051173827 ubox
6 33 0.010897476 ubox
6 35 0.004734349 ubox
6 38 0.004128866 ubox
6 65 0.248861140 ubox
6 70 0.007251999 ubox
6 73 0.010015376 ubox
7 17 0.029832725 ubox
7 20 0.031391468 ubox
7 23 0.005410549 ubox
7 25 0.794438958 ubox
7 27 0.050153966 ubox
7 30 0.049949205 ubox
7 34 0.004737424 ubox
7 36 0.008122184 ubox
7 37 0.003958247 ubox
7 63 0.046244541 ubox
7 69 0.007098869 ubox
7 72 0.009792056 ubox
8 15 0.003767498 ubox
8 16 0.032248666 ubox
8 19 0.032991640 ubox
8 28 0.022240571 ubox
8 32 0.005264266 ubox
8 35 0.008565878 ubox
8 64 0.044641193 ubox
9 15 0.032948089 ubox
9 19 0.025785641 ubox
9 24 0.995318601 ubox
9 26 0.004379960 ubox
9 29 0.003617771 ubox
9 31 0.003634251 ubox
9 64 0.006388229 ubox
9 70 0.009320147 ubox
10 14 0.032818305 ubox
10 17 0.034256608 ubox
10 18 0.026485919 ubox
10 21 0.003485026 ubox
10 23 0.995865889 ubox
10 63 0.006713413 ubox
10 69 0.009330373 ubox
11 17 0.023234778 ubox
11 18 0.006721784 ubox
11 20 0.003590528 ubox
11 22 0.995704425 ubox
11 34 0.003674287 ubox
11 40 0.006247968 ubox
11 68 0.008634050 ubox
12 17 0.014183812 ubox
12 18 0.006409477 ubox
12 21 0.995537906 ubox
12 39 0.008036914 ubox
13 19 0.152021017 ubox
13 32 0.015520575 ubox
13 38 0.007998701 ubox
14 19 0.049496186 ubox
14 24 0.012440971 ubox
14 26 0.004679087 ubox
14 29 0.007635428 ubox
14 31 0.016509343 ubox
14 33 0.004236557 ubox
14 35 0.012218446 ubox
14 38 0.008612400 ubox
14 73 0.021990394 ubox
14 74 0.032461463 ubox
15 20 0.038504749 ubox
15 23 0.012427431 ubox
15 25 0.003438779 ubox
15 30 0.013184278 ubox
15 34 0.012315343 ubox
15 37 0.009279506 ubox
15 72 0.015616477 ubox
16 20 0.010598414 ubox
16 22 0.012281473 ubox
16 25 0.006383972 ubox
16 27 0.012224681 ubox
16 30 0.011985081 ubox
16 34 0.013421108 ubox
16 36 0.009284497 ubox
16 72 0.046617149 ubox
16 75 0.018306492 ubox
17 24 0.007498068 ubox
17 26 0.012907876 ubox
17 29 0.015756996 ubox
17 32 0.018147004 ubox
17 33 0.014767752 ubox
17 35 0.008266019 ubox
17 61 0.003385461 ubox
17 71 0.051828229 ubox
17 74 0.023290181 ubox
18 24 0.006655651 ubox
18 26 0.004065341 ubox
18 28 0.015597464 ubox
18 31 0.023436504 ubox
18 32 0.006872431 ubox
18 35 0.010881828 ubox
18 49 0.005220208 ubox
18 60 0.003399737 ubox
18 70 0.051822296 ubox
18 73 0.023290134 ubox
19 23 0.006239876 ubox
19 25 0.003985417 ubox
19 27 0.015373205 ubox
19 30 0.023362387 ubox
19 34 0.011486501 ubox
19 36 0.008429828 ubox
19 48 0.005299243 ubox
19 69 0.050521724 ubox
19 72 0.022469262 ubox
20 35 0.010420933 ubox
21 26 0.009061900 ubox
21 29 0.030189121 ubox
21 31 0.003201554 ubox
21 33 0.072016984 ubox
21 47 0.010694958 ubox
21 55 0.005059193 ubox
21 71 0.011951651 ubox
22 28 0.029917881 ubox
22 32 0.072121373 ubox
22 46 0.010707988 ubox
22 54 0.005082743 ubox
23 31 0.071910051 ubox
23 53 0.005094906 ubox
23 70 0.013694541 ubox
24 44 0.010371543 ubox
24 52 0.005091169 ubox
24 69 0.013670876 ubox
25 32 0.017701185 ubox
25 35 0.008572072 ubox
25 38 0.007031908 ubox
25 41 0.004471647 ubox
25 46 0.003769864 ubox
25 64 0.004153468 ubox
25 67 0.005437858 ubox
26 39 0.101743784 ubox
26 42 0.177810495 ubox
26 45 0.004004938 ubox
26 63 0.004416046 ubox
26 66 0.005341542 ubox
27 32 0.029054770 ubox
27 35 0.068566940 ubox
27 38 0.132421500 ubox
27 41 0.193445610 ubox
28 34 0.069147398 ubox
28 36 0.020001870 ubox
28 37 0.133747930 ubox
28 40 0.196940456 ubox
28 43 0.003373640 ubox
29 39 0.201177903 ubox
29 42 0.010235931 ubox
29 45 0.006885432 ubox
30 35 0.038420066 ubox
30 38 0.188211314 ubox
30 41 0.010907088 ubox
30 46 0.004966640 ubox
31 39 0.024828915 ubox
31 42 0.004430027 ubox
31 44 0.022430088 ubox
31 45 0.004918883 ubox
31 69 0.020765961 ubox
32 36 0.046518590 ubox
32 37 0.044035644 ubox
32 39 0.004529888 ubox
32 40 0.049517270 ubox
32 43 0.022628496 ubox
32 44 0.004514666 ubox
32 68 0.020718935 ubox
32 72 0.004298649 ubox
33 39 0.067272957 ubox
33 42 0.024336955 ubox
33 43 0.004075620 ubox
33 69 0.009626720 ubox
34 38 0.058417622 ubox
34 41 0.024328005 ubox
34 67 0.003283135 ubox
35 40 0.023042036 ubox
35 68 0.019440738 ubox
35 69 0.015367936 ubox
36 67 0.015037698 ubox
37 67 0.148202208 ubox
38 66 0.160949620 ubox
39 65 0.964222666 ubox
40 64 0.976314055 ubox
41 63 0.977735959 ubox
42 61 0.005676084 ubox
42 62 0.983473622 ubox
43 49 0.006352331 ubox
43 55 0.003640179 ubox
43 60 0.007732660 ubox
43 61 0.984813018 ubox
43 62 0.168857303 ubox
44 49 0.006979440 ubox
44 54 0.003612512 ubox
44 55 0.003333091 ubox
44 59 0.007690460 ubox
44 60 0.984747286 ubox
44 61 0.169080416 ubox
44 62 0.007581062 ubox
44 74 0.012049564 ubox
45 53 0.003869830 ubox
45 54 0.004735695 ubox
45 55 0.006092296 ubox
45 59 0.975037414 ubox
45 60 0.168763493 ubox
45 61 0.007563381 ubox
45 73 0.012106714 ubox
46 52 0.010499552 ubox
46 56 0.006186050 ubox
46 57 0.659383875 ubox
46 58 0.729837808 ubox
46 72 0.012015266 ubox
47 51 0.015878252 ubox
47 52 0.044596771 ubox
47 56 0.921148887 ubox
48 53 0.020888972 ubox
48 54 0.074679413 ubox
48 59 0.003178814 ubox
48 64 0.021513867 ubox
49 56 0.213458171 ubox
49 63 0.023008969 ubox
50 54 0.034725062 ubox
50 59 0.007631748 ubox
51 55 0.073664623 ubox
51 59 0.003165025 ubox
51 60 0.005548454 ubox
51 61 0.024371127 ubox
51 62 0.017937767 ubox
51 71 0.016894685 ubox
52 59 0.007803189 ubox
52 60 0.024386844 ubox
52 61 0.017914519 ubox
52 70 0.016908270 ubox
53 57 0.005542917 ubox
53 58 0.008275596 ubox
53 69 0.016884220 ubox
54 58 0.004100264 ubox
54 68 0.016082004 ubox
55 63 0.005631868 ubox
55 66 0.016895954 ubox
56 62 0.005896026 ubox
56 65 0.017030782 ubox
57 64 0.016044862 ubox
66 73 0.004696335 ubox
67 72 0.004426747 ubox
69 74 0.006468786 ubox
1 70 0.9500000 lbox
2 69 0.9500000 lbox
3 68 0.9500000 lbox
4 67 0.9500000 lbox
5 66 0.9500000 lbox
6 26 0.9500000 lbox
7 25 0.9500000 lbox
9 24 0.9500000 lbox
10 23 0.9500000 lbox
11 22 0.9500000 lbox
12 21 0.9500000 lbox
39 65 0.9500000 lbox
40 64 0.9500000 lbox
41 63 0.9500000 lbox
42 62 0.9500000 lbox
43 61 0.9500000 lbox
44 60 0.9500000 lbox
45 59 0.9500000 lbox
46 58 0.9500000 lbox
47 56 0.9500000 lbox
showpage
end
%%EOF
