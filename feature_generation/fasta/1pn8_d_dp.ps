%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:26 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (1pn8_d)
} def

/sequence { (\
UCCGUGAAACAAAGCGGAUGUACCGGAUUUUUAUUCCGGCUAUGGGGCAAUUCCCCGUCGCGGAGCCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 18 0.353750793 ubox
1 20 0.003372651 ubox
1 27 0.023283310 ubox
1 64 0.861468972 ubox
1 65 0.014994019 ubox
2 17 0.387267946 ubox
2 26 0.025484939 ubox
2 63 0.920999467 ubox
3 16 0.387425269 ubox
3 25 0.025489231 ubox
3 62 0.921257265 ubox
4 10 0.004251963 ubox
4 15 0.387446403 ubox
4 23 0.008835681 ubox
4 24 0.024069573 ubox
4 34 0.014441094 ubox
4 61 0.921173831 ubox
5 9 0.003878058 ubox
5 11 0.008270455 ubox
5 12 0.006674724 ubox
5 13 0.015206897 ubox
5 14 0.386130685 ubox
5 16 0.003873795 ubox
5 22 0.011884697 ubox
5 33 0.015982448 ubox
5 60 0.920559316 ubox
6 10 0.013869964 ubox
6 15 0.010654351 ubox
6 21 0.010993278 ubox
6 23 0.017622388 ubox
6 32 0.016353290 ubox
6 59 0.918249988 ubox
7 19 0.037559685 ubox
7 21 0.010241133 ubox
7 31 0.016359109 ubox
7 32 0.003742769 ubox
7 58 0.731712588 ubox
8 19 0.034966382 ubox
8 21 0.024512687 ubox
8 30 0.015915782 ubox
8 31 0.004050819 ubox
8 32 0.003926936 ubox
8 41 0.003681906 ubox
8 58 0.036929996 ubox
9 19 0.024913991 ubox
9 21 0.486055949 ubox
9 29 0.013810013 ubox
9 30 0.003945543 ubox
9 31 0.004057976 ubox
9 43 0.003311113 ubox
9 58 0.076645370 ubox
10 14 0.038451248 ubox
10 16 0.155233918 ubox
10 17 0.123206213 ubox
10 20 0.505648035 ubox
10 44 0.017603863 ubox
10 57 0.120689664 ubox
11 19 0.476334908 ubox
11 21 0.011502950 ubox
11 29 0.008942685 ubox
11 30 0.004175286 ubox
11 43 0.019773373 ubox
11 51 0.004919979 ubox
11 52 0.008673214 ubox
11 58 0.003180090 ubox
12 19 0.047921507 ubox
12 21 0.022022467 ubox
12 28 0.010973061 ubox
12 29 0.004754165 ubox
12 30 0.003360319 ubox
12 41 0.009751300 ubox
12 43 0.006038301 ubox
12 51 0.008753496 ubox
12 52 0.011971201 ubox
13 19 0.054959235 ubox
13 21 0.030460570 ubox
13 28 0.004830108 ubox
13 29 0.003281956 ubox
13 41 0.087103749 ubox
13 43 0.006009103 ubox
13 51 0.011331376 ubox
13 52 0.005389505 ubox
14 19 0.015646760 ubox
14 21 0.392808647 ubox
14 23 0.006204056 ubox
14 40 0.090208552 ubox
14 41 0.003173703 ubox
14 43 0.005331945 ubox
14 48 0.033348580 ubox
14 55 0.007713803 ubox
14 56 0.003490749 ubox
14 58 0.048410523 ubox
14 61 0.009439329 ubox
15 20 0.402244000 ubox
15 25 0.022505580 ubox
15 38 0.051629388 ubox
15 39 0.068839979 ubox
15 44 0.008147722 ubox
15 47 0.033382827 ubox
15 57 0.066039119 ubox
15 60 0.009738824 ubox
16 21 0.032105511 ubox
16 23 0.032522708 ubox
16 24 0.032824042 ubox
16 36 0.007808024 ubox
16 37 0.068919510 ubox
16 40 0.016608971 ubox
16 41 0.051559568 ubox
16 43 0.010237702 ubox
16 48 0.005513755 ubox
16 53 0.004346772 ubox
16 54 0.009425290 ubox
16 56 0.060509359 ubox
16 59 0.009682599 ubox
17 21 0.013548637 ubox
17 23 0.033614317 ubox
17 24 0.003522472 ubox
17 35 0.008190549 ubox
17 36 0.069008356 ubox
17 37 0.008602786 ubox
17 40 0.054229000 ubox
17 41 0.005556188 ubox
17 43 0.007987642 ubox
17 48 0.005540693 ubox
17 52 0.004369618 ubox
17 53 0.009446841 ubox
17 55 0.052378431 ubox
17 58 0.005716514 ubox
17 59 0.006607605 ubox
18 28 0.005422211 ubox
18 34 0.019168019 ubox
18 35 0.065577191 ubox
18 41 0.012357418 ubox
18 43 0.107739318 ubox
18 51 0.004802097 ubox
18 52 0.009167349 ubox
18 58 0.007203365 ubox
19 25 0.006879553 ubox
19 26 0.004210572 ubox
19 27 0.007422876 ubox
19 33 0.025931496 ubox
19 42 0.112996422 ubox
19 44 0.050111545 ubox
19 49 0.006315587 ubox
19 50 0.004316763 ubox
19 57 0.007872471 ubox
19 60 0.003719928 ubox
19 62 0.020419609 ubox
19 64 0.005084319 ubox
19 68 0.018928649 ubox
20 24 0.011334742 ubox
20 28 0.007126806 ubox
20 29 0.004216198 ubox
20 31 0.004281627 ubox
20 32 0.025953501 ubox
20 34 0.030533019 ubox
20 40 0.063041195 ubox
20 41 0.108175745 ubox
20 43 0.378047974 ubox
20 48 0.006941231 ubox
20 56 0.003938327 ubox
20 59 0.005417561 ubox
20 61 0.028819289 ubox
20 66 0.046792034 ubox
20 67 0.022310033 ubox
21 25 0.004032243 ubox
21 26 0.003589162 ubox
21 27 0.007478700 ubox
21 33 0.032402507 ubox
21 39 0.021125397 ubox
21 42 0.405685620 ubox
21 44 0.004340806 ubox
21 47 0.006520906 ubox
21 60 0.027386207 ubox
21 62 0.004468232 ubox
21 64 0.005186256 ubox
21 65 0.046382254 ubox
22 29 0.005959113 ubox
22 30 0.008053420 ubox
22 31 0.014545173 ubox
22 32 0.030782641 ubox
22 41 0.419692540 ubox
22 43 0.013039074 ubox
23 38 0.014561795 ubox
23 39 0.936983698 ubox
23 62 0.013498318 ubox
23 63 0.039766329 ubox
23 65 0.006805502 ubox
24 38 0.971480582 ubox
24 62 0.038035531 ubox
25 29 0.005325313 ubox
25 30 0.005252550 ubox
25 31 0.005788822 ubox
25 32 0.006310316 ubox
25 34 0.003498376 ubox
25 36 0.034309705 ubox
25 37 0.981725245 ubox
25 61 0.004120621 ubox
25 66 0.003803281 ubox
25 67 0.082967499 ubox
26 30 0.004531732 ubox
26 31 0.006296874 ubox
26 32 0.007198303 ubox
26 35 0.036978667 ubox
26 36 0.981687874 ubox
26 66 0.083006113 ubox
27 31 0.006756904 ubox
27 32 0.012566665 ubox
27 34 0.124464523 ubox
27 35 0.965853637 ubox
28 33 0.167242532 ubox
28 64 0.003287191 ubox
28 65 0.014359751 ubox
29 33 0.150013680 ubox
29 64 0.005746112 ubox
29 65 0.004140859 ubox
30 65 0.004311244 ubox
30 68 0.003592639 ubox
31 65 0.004644894 ubox
31 68 0.007143247 ubox
32 65 0.005103024 ubox
32 68 0.004412690 ubox
34 64 0.005434043 ubox
34 65 0.135254244 ubox
35 63 0.004014741 ubox
35 64 0.167635004 ubox
36 62 0.004148041 ubox
36 63 0.170919292 ubox
36 65 0.004854371 ubox
37 60 0.005396766 ubox
37 62 0.170668485 ubox
37 63 0.023804410 ubox
38 59 0.006118909 ubox
38 61 0.127376109 ubox
38 67 0.132850494 ubox
39 48 0.005673073 ubox
39 58 0.007516833 ubox
39 59 0.021030484 ubox
39 61 0.266535461 ubox
39 66 0.139340087 ubox
40 44 0.005016657 ubox
40 47 0.006407156 ubox
40 57 0.029527777 ubox
40 60 0.307874263 ubox
40 62 0.032016461 ubox
40 63 0.059400978 ubox
40 65 0.142574519 ubox
41 46 0.006159188 ubox
41 57 0.012766869 ubox
41 60 0.017836767 ubox
41 62 0.059047492 ubox
41 63 0.008889640 ubox
41 64 0.140690755 ubox
42 58 0.598742725 ubox
43 57 0.767292542 ubox
43 60 0.003693288 ubox
43 62 0.065468673 ubox
43 63 0.005242885 ubox
44 53 0.004897992 ubox
44 54 0.034880898 ubox
44 55 0.103008666 ubox
44 56 0.985034570 ubox
44 61 0.072579142 ubox
44 67 0.003940350 ubox
45 52 0.004802423 ubox
45 53 0.034993788 ubox
45 54 0.110823651 ubox
45 55 0.985505772 ubox
45 56 0.076720278 ubox
45 61 0.005139028 ubox
45 66 0.003875408 ubox
45 67 0.004932241 ubox
46 51 0.004708958 ubox
46 52 0.032431392 ubox
46 53 0.111450651 ubox
46 54 0.985449190 ubox
46 55 0.076903361 ubox
46 56 0.003537872 ubox
46 59 0.072945104 ubox
46 66 0.004413682 ubox
46 67 0.048537740 ubox
47 51 0.021367124 ubox
47 52 0.079294364 ubox
47 53 0.978241416 ubox
47 54 0.076455813 ubox
47 55 0.003519930 ubox
47 58 0.072958208 ubox
47 66 0.048650583 ubox
48 57 0.072983964 ubox
48 65 0.048426190 ubox
51 64 0.008988432 ubox
51 65 0.007122366 ubox
52 63 0.009089982 ubox
52 64 0.046662118 ubox
53 62 0.009113659 ubox
53 63 0.047055043 ubox
54 60 0.004122348 ubox
54 62 0.046941665 ubox
54 63 0.005294185 ubox
55 60 0.030527683 ubox
55 62 0.005837799 ubox
55 63 0.010368564 ubox
56 60 0.014664118 ubox
56 62 0.011070062 ubox
56 63 0.003388093 ubox
57 61 0.011037295 ubox
57 66 0.020471303 ubox
57 67 0.010938912 ubox
58 64 0.009857603 ubox
58 65 0.018219454 ubox
58 68 0.004612747 ubox
59 63 0.011968449 ubox
59 65 0.017673950 ubox
60 66 0.066882129 ubox
60 67 0.011634572 ubox
61 65 0.066735332 ubox
62 66 0.009692788 ubox
62 67 0.035068449 ubox
63 67 0.011404803 ubox
1 64 0.9500000 lbox
2 63 0.9500000 lbox
3 62 0.9500000 lbox
4 61 0.9500000 lbox
5 60 0.9500000 lbox
6 59 0.9500000 lbox
7 58 0.9500000 lbox
20 43 0.9500000 lbox
21 42 0.9500000 lbox
22 41 0.9500000 lbox
23 39 0.9500000 lbox
24 38 0.9500000 lbox
25 37 0.9500000 lbox
26 36 0.9500000 lbox
27 35 0.9500000 lbox
44 56 0.9500000 lbox
45 55 0.9500000 lbox
46 54 0.9500000 lbox
47 53 0.9500000 lbox
showpage
end
%%EOF
