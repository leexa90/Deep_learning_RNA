%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:05:06 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (5o60_b)
} def

/sequence { (\
GUUACGGCGGUCCAUAGCGGCAGGGAAACGCCCGGUCCCAUCCCGAACCCGGAAGCUAAGCCUGCCAGCGCCGAUGAUACUACCCAUCCGGGUGGAAAAGUAGGACACCGCCGAACAC\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 116 0.985798881 ubox
1 118 0.030293542 ubox
2 114 0.007783798 ubox
2 115 0.985593072 ubox
2 117 0.029667964 ubox
3 113 0.003615123 ubox
3 114 0.978066560 ubox
3 115 0.039681397 ubox
3 117 0.006539327 ubox
5 113 0.995121560 ubox
6 112 0.999967426 ubox
7 111 0.999990433 ubox
8 110 0.999968767 ubox
9 108 0.075084319 ubox
9 109 0.995654888 ubox
10 18 0.004474428 ubox
10 75 0.008654866 ubox
10 78 0.005877546 ubox
10 106 0.269399998 ubox
10 108 0.961865419 ubox
11 16 0.007703741 ubox
11 17 0.004561862 ubox
11 70 0.003588476 ubox
11 74 0.023949891 ubox
11 77 0.013489528 ubox
11 96 0.025794550 ubox
11 104 0.009516985 ubox
11 105 0.493232919 ubox
11 107 0.812829318 ubox
12 17 0.012486282 ubox
12 70 0.015210838 ubox
12 73 0.038436785 ubox
12 76 0.019405392 ubox
12 95 0.034212291 ubox
12 100 0.005170450 ubox
12 103 0.019246573 ubox
12 104 0.618967844 ubox
13 17 0.007677905 ubox
13 60 0.003573799 ubox
13 70 0.025094633 ubox
13 73 0.055097687 ubox
13 76 0.098883565 ubox
13 94 0.034216832 ubox
13 100 0.004205170 ubox
13 103 0.618505423 ubox
13 104 0.032649642 ubox
14 75 0.103736650 ubox
14 78 0.006355961 ubox
14 93 0.033626423 ubox
14 101 0.180699185 ubox
15 58 0.010540234 ubox
15 67 0.004212645 ubox
15 68 0.006882477 ubox
15 70 0.040037242 ubox
15 73 0.023018894 ubox
15 74 0.096832636 ubox
15 76 0.010071624 ubox
15 77 0.005419692 ubox
15 79 0.007538877 ubox
15 92 0.032798385 ubox
15 97 0.004004667 ubox
15 98 0.006428828 ubox
15 99 0.020695531 ubox
15 100 0.176895109 ubox
15 102 0.154630307 ubox
15 103 0.025660516 ubox
15 104 0.007246739 ubox
15 105 0.041650605 ubox
15 107 0.005135415 ubox
16 57 0.011127971 ubox
16 75 0.011932747 ubox
16 78 0.008107161 ubox
16 101 0.144219907 ubox
17 38 0.003915078 ubox
17 39 0.005092385 ubox
17 56 0.011188276 ubox
17 69 0.961163068 ubox
17 71 0.142377745 ubox
17 72 0.012550531 ubox
17 101 0.077570971 ubox
17 106 0.007184749 ubox
18 45 0.004796244 ubox
18 55 0.011173837 ubox
18 68 0.962005487 ubox
18 70 0.143061459 ubox
18 73 0.018558999 ubox
18 95 0.003477112 ubox
18 100 0.080960314 ubox
19 32 0.003668289 ubox
19 37 0.012893294 ubox
19 38 0.005883987 ubox
19 44 0.004839347 ubox
19 62 0.003166828 ubox
19 66 0.994072303 ubox
19 69 0.062241251 ubox
19 72 0.018585770 ubox
20 31 0.003745417 ubox
20 36 0.013016174 ubox
20 37 0.005874014 ubox
20 43 0.004795166 ubox
20 61 0.003205576 ubox
20 65 0.999633096 ubox
20 66 0.007564019 ubox
20 71 0.018517168 ubox
21 30 0.003784992 ubox
21 35 0.013950413 ubox
21 60 0.003236824 ubox
21 64 0.999663743 ubox
21 70 0.018437118 ubox
22 41 0.003267768 ubox
22 63 0.998860007 ubox
23 33 0.020335547 ubox
23 39 0.020813052 ubox
23 62 0.997306116 ubox
23 63 0.032897254 ubox
24 29 0.006200372 ubox
24 31 0.003450733 ubox
24 32 0.020562779 ubox
24 33 0.006184496 ubox
24 38 0.021639461 ubox
24 39 0.004100599 ubox
24 57 0.004921765 ubox
24 61 0.995223140 ubox
24 62 0.066579764 ubox
25 29 0.010862806 ubox
25 31 0.022089232 ubox
25 32 0.006765776 ubox
25 37 0.022000441 ubox
25 38 0.004539328 ubox
25 39 0.008198904 ubox
25 42 0.003250499 ubox
25 56 0.019872977 ubox
25 57 0.012237046 ubox
25 61 0.087964104 ubox
26 36 0.019976079 ubox
26 57 0.031344236 ubox
27 57 0.082642534 ubox
28 36 0.015103740 ubox
28 57 0.284278132 ubox
29 34 0.014127724 ubox
29 35 0.017860952 ubox
29 51 0.006655458 ubox
29 55 0.313716321 ubox
29 60 0.017388439 ubox
30 50 0.006609902 ubox
30 56 0.859753820 ubox
30 57 0.009196127 ubox
30 61 0.004329926 ubox
31 52 0.229987960 ubox
31 55 0.856840454 ubox
31 60 0.005152993 ubox
32 45 0.003353839 ubox
32 51 0.230400568 ubox
32 52 0.967200825 ubox
32 55 0.003350855 ubox
33 45 0.019958997 ubox
33 51 0.971654721 ubox
33 52 0.009531016 ubox
34 39 0.006566681 ubox
34 42 0.012327625 ubox
34 43 0.012657007 ubox
34 44 0.020345481 ubox
34 48 0.004934927 ubox
34 49 0.342387447 ubox
34 50 0.938128134 ubox
34 57 0.006622228 ubox
34 62 0.012101648 ubox
35 41 0.012116500 ubox
35 42 0.014587544 ubox
35 43 0.020235928 ubox
35 44 0.004050878 ubox
35 48 0.426056099 ubox
35 49 0.900391320 ubox
35 56 0.006832899 ubox
35 61 0.012146760 ubox
36 40 0.013312180 ubox
36 45 0.035944383 ubox
36 46 0.547474315 ubox
36 47 0.449241240 ubox
36 53 0.010577013 ubox
36 55 0.006140219 ubox
36 60 0.011794972 ubox
37 45 0.599591780 ubox
37 52 0.010855830 ubox
38 45 0.420352148 ubox
38 51 0.010804571 ubox
39 45 0.387000068 ubox
39 51 0.003192501 ubox
39 55 0.005017180 ubox
39 76 0.005189653 ubox
40 75 0.005209892 ubox
41 45 0.016383057 ubox
41 46 0.019562592 ubox
41 47 0.010708566 ubox
41 53 0.013025561 ubox
41 54 0.010480660 ubox
41 74 0.005210074 ubox
42 52 0.012445884 ubox
42 73 0.005183395 ubox
43 51 0.011141961 ubox
43 52 0.038148534 ubox
44 51 0.039095447 ubox
45 49 0.004169601 ubox
45 50 0.039030585 ubox
50 73 0.006051522 ubox
51 72 0.006243853 ubox
52 71 0.006225283 ubox
55 61 0.012509202 ubox
55 65 0.009567304 ubox
55 69 0.014109924 ubox
56 60 0.013373153 ubox
56 64 0.009610725 ubox
56 68 0.014123621 ubox
57 67 0.013603712 ubox
60 65 0.004245446 ubox
60 69 0.009494795 ubox
60 71 0.003744707 ubox
60 106 0.007161341 ubox
61 68 0.009455783 ubox
61 70 0.003765973 ubox
61 104 0.011634808 ubox
62 103 0.011667391 ubox
63 102 0.011666236 ubox
64 71 0.003393773 ubox
64 101 0.011660604 ubox
65 70 0.003412877 ubox
65 100 0.011546677 ubox
66 76 0.006355725 ubox
67 75 0.009736724 ubox
67 78 0.008684699 ubox
68 72 0.011736591 ubox
68 75 0.003997029 ubox
68 78 0.008229333 ubox
68 93 0.016280245 ubox
68 101 0.009886938 ubox
68 106 0.023450676 ubox
68 108 0.003959480 ubox
69 73 0.011314467 ubox
69 76 0.046630707 ubox
69 92 0.017279552 ubox
69 94 0.042992910 ubox
69 100 0.010131717 ubox
69 104 0.006109557 ubox
70 75 0.034621643 ubox
70 78 0.016782800 ubox
70 80 0.005726271 ubox
70 93 0.048347988 ubox
70 101 0.042825241 ubox
70 106 0.491913856 ubox
71 76 0.067818082 ubox
71 90 0.012510641 ubox
71 91 0.047828445 ubox
71 92 0.047836126 ubox
71 95 0.011829360 ubox
71 100 0.043638975 ubox
71 103 0.023320270 ubox
71 104 0.761114301 ubox
72 76 0.049769628 ubox
72 90 0.048830054 ubox
72 91 0.046701385 ubox
72 94 0.011758145 ubox
72 100 0.036407193 ubox
72 103 0.761328455 ubox
72 104 0.033337325 ubox
73 78 0.012996137 ubox
73 80 0.013087421 ubox
73 88 0.058939342 ubox
73 89 0.035387713 ubox
73 93 0.005322385 ubox
73 101 0.038080638 ubox
73 106 0.006189947 ubox
74 78 0.015419570 ubox
74 87 0.068715825 ubox
74 101 0.614664207 ubox
75 79 0.010300937 ubox
75 86 0.068863454 ubox
75 96 0.013396491 ubox
75 97 0.012147742 ubox
75 98 0.041690840 ubox
75 99 0.152915974 ubox
75 100 0.635175977 ubox
75 102 0.047186386 ubox
75 105 0.003768014 ubox
75 107 0.003319666 ubox
76 80 0.004589249 ubox
76 85 0.068836062 ubox
76 88 0.005942736 ubox
76 101 0.050464714 ubox
76 106 0.005794577 ubox
77 87 0.005956947 ubox
77 101 0.029781078 ubox
78 86 0.005779845 ubox
78 96 0.159879253 ubox
78 97 0.373069443 ubox
78 98 0.043985493 ubox
78 99 0.044269836 ubox
78 100 0.028736081 ubox
78 102 0.047887545 ubox
79 101 0.050544720 ubox
80 94 0.028114707 ubox
80 95 0.990878857 ubox
80 100 0.046154427 ubox
80 103 0.017317595 ubox
81 94 0.994974113 ubox
81 95 0.004106871 ubox
81 99 0.039475548 ubox
81 102 0.017871376 ubox
82 93 0.996838579 ubox
82 101 0.017891918 ubox
83 92 0.997327930 ubox
83 100 0.017834449 ubox
84 90 0.003286762 ubox
84 91 0.997322671 ubox
84 95 0.014507043 ubox
85 90 0.995881930 ubox
85 91 0.003951931 ubox
85 94 0.014547060 ubox
86 93 0.014349242 ubox
87 92 0.013502432 ubox
87 96 0.016444458 ubox
88 95 0.016809338 ubox
89 94 0.016809805 ubox
92 106 0.003180937 ubox
93 102 0.005282082 ubox
93 105 0.003164279 ubox
94 101 0.006219890 ubox
95 101 0.003404744 ubox
96 101 0.023463661 ubox
97 101 0.013488458 ubox
100 106 0.056554649 ubox
100 108 0.003718114 ubox
101 105 0.051023301 ubox
101 107 0.003969309 ubox
103 108 0.004015034 ubox
1 116 0.9500000 lbox
2 115 0.9500000 lbox
3 114 0.9500000 lbox
5 113 0.9500000 lbox
6 112 0.9500000 lbox
7 111 0.9500000 lbox
8 110 0.9500000 lbox
9 109 0.9500000 lbox
10 108 0.9500000 lbox
11 107 0.9500000 lbox
17 69 0.9500000 lbox
18 68 0.9500000 lbox
19 66 0.9500000 lbox
20 65 0.9500000 lbox
21 64 0.9500000 lbox
22 63 0.9500000 lbox
23 62 0.9500000 lbox
24 61 0.9500000 lbox
30 56 0.9500000 lbox
31 55 0.9500000 lbox
32 52 0.9500000 lbox
33 51 0.9500000 lbox
34 50 0.9500000 lbox
35 49 0.9500000 lbox
71 104 0.9500000 lbox
72 103 0.9500000 lbox
74 101 0.9500000 lbox
75 100 0.9500000 lbox
80 95 0.9500000 lbox
81 94 0.9500000 lbox
82 93 0.9500000 lbox
83 92 0.9500000 lbox
84 91 0.9500000 lbox
85 90 0.9500000 lbox
showpage
end
%%EOF
