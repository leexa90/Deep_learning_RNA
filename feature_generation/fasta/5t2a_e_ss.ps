%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:05:06 2017
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GUGGUAAUGCGAAACACUUGCCAGGUAACAAAUCAAUCCUCCCACGGUGAGCUUUCUUUUCACCAUAAUCCACAUCUCCGGCUUUGCUGGGGCUUGGGCCUUUUUACUUCUCGCGUUGUUCGGAGCGGGGGCUCAAGAUUGAAAAAUGCAGCUCUCCCUACGUACUGUCAUUGUUGUGAGUUCUGCGCAUUAAAGCAAAAACCUGGGGUGU\
) def
/coor [
[89.63680267 303.73162842]
[92.68206787 318.62442017]
[89.79138947 333.54797363]
[81.40559387 346.22656250]
[68.80343628 354.72680664]
[53.90666580 357.75247192]
[38.98692703 354.84216309]
[26.31937408 346.43969727]
[17.83571434 333.82638550]
[14.82964706 318.92562866]
[17.75957298 304.00973511]
[26.17870140 291.35327148]
[38.80317307 282.88619995]
[53.70785522 279.89971924]
[56.57968521 265.17721558]
[59.45151901 250.45469666]
[62.32334900 235.73217773]
[65.19518280 221.00965881]
[63.31794739 216.61894226]
[64.17846680 211.00239563]
[68.37642670 205.89628601]
[71.68328094 191.26533508]
[74.99012756 176.63438416]
[78.29697418 162.00343323]
[81.60382080 147.37248230]
[84.91066742 132.74153137]
[80.40396118 126.74656677]
[70.48748016 138.00105286]
[60.57099533 149.25552368]
[50.65451050 160.51000977]
[40.73802567 171.76449585]
[36.44937897 186.13833618]
[25.89588928 196.79779053]
[11.56559944 201.22981262]
[-3.16303992 198.38952637]
[-14.81766987 188.94656372]
[-20.65064621 175.12715149]
[-19.28680801 160.18927002]
[-11.04769230 147.65464783]
[2.12428474 140.47836304]
[17.12398529 140.35234070]
[30.69062805 133.95341492]
[44.25726700 127.55448914]
[57.82390976 121.15556335]
[71.39054871 114.75663757]
[66.88384247 108.76167297]
[51.91019058 107.87306213]
[36.93653488 106.98445129]
[21.96287727 106.09584808]
[6.98922157 105.20723724]
[-7.98443460 104.31862640]
[-18.59588623 115.80474854]
[-34.11432648 117.73143005]
[-47.21241760 109.18894958]
[-51.70564270 94.21080017]
[-45.47243881 79.86920929]
[-31.45593643 72.93583679]
[-16.27429581 76.68441010]
[-7.09582520 89.34497070]
[7.87783098 90.23358154]
[22.85148621 91.12219238]
[37.82514191 92.01079559]
[52.79879761 92.89940643]
[67.77245331 93.78801727]
[71.29566956 87.16706848]
[58.05377960 80.12063599]
[44.81188202 73.07420349]
[31.56999016 66.02776337]
[16.79873657 63.41815567]
[14.71607971 48.56344223]
[28.20018768 41.99237823]
[38.61642456 52.78587341]
[51.85831833 59.83230591]
[65.10021210 66.87873840]
[78.34210968 73.92517853]
[81.86532593 67.30422974]
[72.76332092 55.38141251]
[63.66131973 43.45859528]
[54.55931854 31.53577805]
[45.45731354 19.61296272]
[36.35531235 7.69014549]
[27.25331116 -4.23267126]
[12.83616257 -13.15355587]
[17.41735268 -29.47682381]
[34.37089920 -29.59339714]
[39.17612839 -13.33467293]
[48.27812958 -1.41185677]
[57.38013077 10.51095963]
[66.48213196 22.43377686]
[75.58413696 34.35659409]
[84.68614197 46.27941132]
[93.78813934 58.20222473]
[108.51065826 55.33039474]
[112.46446991 40.86085892]
[116.41827393 26.39132690]
[120.37208557 11.92179298]
[124.32588959 -2.54774070]
[128.27969360 -17.01727486]
[132.23350525 -31.48680878]
[136.18731689 -45.95634079]
[140.14111328 -60.42587662]
[126.02015686 -55.36639023]
[113.18080902 -63.12211609]
[111.08837891 -77.97545624]
[121.28540802 -88.97638702]
[136.25456238 -88.01492310]
[144.96052551 -75.79931641]
[149.97462463 -89.93646240]
[147.29541016 -105.52916718]
[158.84201050 -114.93795776]
[163.85609436 -129.07510376]
[168.87019348 -143.21224976]
[168.78932190 -152.34553528]
[174.06472778 -157.52079773]
[179.28776550 -171.58209229]
[173.93760681 -186.70675659]
[182.54870605 -200.24295044]
[198.51535034 -201.80686951]
[209.58929443 -190.19880676]
[207.27557373 -174.32347107]
[193.34906006 -166.35906982]
[188.12602234 -152.29777527]
[183.00733948 -138.19816589]
[177.99324036 -124.06101990]
[172.97915649 -109.92386627]
[176.01701355 -95.34234619]
[164.11177063 -84.92237854]
[159.09768677 -70.78523254]
[154.61065674 -56.47206879]
[150.65684509 -42.00253296]
[146.70303345 -27.53300095]
[142.74923706 -13.06346703]
[138.79542542 1.40606689]
[134.84161377 15.87560081]
[130.88780212 30.34513474]
[126.93399811 44.81466675]
[122.98019409 59.28420258]
[127.85091400 64.98736572]
[138.25776672 54.18471146]
[146.61540222 41.72879791]
[160.68745422 36.53479004]
[175.13340759 40.57386017]
[184.47091675 52.31315231]
[185.15629578 67.29748535]
[176.92944336 79.84016418]
[162.91104126 85.18120575]
[148.42643738 89.07941437]
[153.29714966 94.78257751]
[167.87748718 98.30587006]
[182.45783997 101.82916260]
[197.03817749 105.35244751]
[210.41880798 97.37770844]
[225.15516663 101.15853119]
[232.67539978 113.96406555]
[247.25573730 117.48735809]
[261.83609009 121.01064301]
[277.06756592 116.73127747]
[287.62136841 127.24156952]
[302.85284424 122.96220398]
[313.40664673 133.47250366]
[327.98699951 136.99578857]
[342.56735229 140.51907349]
[353.65179443 129.78883362]
[368.78234863 126.77710724]
[383.13082886 132.44491577]
[392.11874390 144.98370361]
[392.87808228 160.39236450]
[385.16650391 173.75407410]
[371.44476318 180.80514526]
[356.09143066 179.29560852]
[344.00567627 169.70715332]
[339.04403687 155.09942627]
[324.46371460 151.57612610]
[309.88336182 148.05284119]
[295.69476318 152.58421326]
[284.09808350 141.82191467]
[269.90948486 146.35328674]
[258.31280518 135.59098816]
[243.73245239 132.06770325]
[229.15209961 128.54440308]
[216.61430359 136.50297546]
[201.77755737 133.13757324]
[193.51489258 119.93279266]
[178.93453979 116.40950775]
[164.35420227 112.88621521]
[149.77386475 109.36292267]
[141.30220032 121.74157715]
[149.86534119 134.05712891]
[165.46278381 136.60571289]
[174.62176514 149.48550415]
[171.90840149 165.05513000]
[158.93251038 174.07740784]
[143.39244080 171.19960022]
[134.50784302 158.12902832]
[137.54980469 142.62025452]
[128.98666382 130.30471802]
[121.62540436 131.74063110]
[124.49698639 146.46319580]
[109.77437592 149.33454895]
[106.90287781 134.61245728]
[99.54161835 136.04838562]
[96.23477173 150.67933655]
[92.92792511 165.31028748]
[89.62107849 179.94123840]
[86.31423187 194.57218933]
[83.00737762 209.20314026]
[79.91770172 223.88148499]
[77.04586792 238.60400391]
[74.17403412 253.32652283]
[71.30220795 268.04904175]
[68.43037415 282.77157593]
] def
/pairs [
[14 211]
[15 210]
[16 209]
[17 208]
[18 207]
[21 206]
[22 205]
[23 204]
[24 203]
[25 202]
[26 201]
[46 64]
[47 63]
[48 62]
[49 61]
[50 60]
[51 59]
[76 92]
[77 91]
[78 90]
[79 89]
[80 88]
[81 87]
[82 86]
[93 137]
[94 136]
[95 135]
[96 134]
[97 133]
[98 132]
[99 131]
[100 130]
[101 129]
[107 128]
[108 127]
[110 125]
[111 124]
[112 123]
[114 122]
[115 121]
[148 186]
[149 185]
[150 184]
[151 183]
[154 180]
[155 179]
[156 178]
[158 176]
[160 174]
[161 173]
[162 172]
[187 196]
[188 195]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
