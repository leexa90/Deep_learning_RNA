%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:39 2017
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
UUAAAGCCUUAUGGUCGCUACCAUUGCACUCCGGUAGCGUUAAAAGGGAAGACGGGUGAGAAUCCCGCGCAGCCCCCGCUACUGUGAGGGAGGACGAAGCCCUAGUAAGCCACUGCCGAAAGGUGGGAAGGCAGGGUGGAGGAUGAGUCCCGAGCCAGGAGACCUGCCAUAAGGUUUUAGAAGUUCGCCUUCGGGGGGAAGGUGAACA\
) def
/coor [
[218.88587952 355.86248779]
[212.75738525 342.17153931]
[206.62887573 328.48062134]
[200.50038147 314.78970337]
[194.37187195 301.09875488]
[188.24337769 287.40783691]
[182.11486816 273.71691895]
[175.98637390 260.02600098]
[169.85786438 246.33506775]
[163.72937012 232.64413452]
[157.60086060 218.95320129]
[151.47236633 205.26228333]
[145.34385681 191.57135010]
[139.21536255 177.88043213]
[133.08685303 164.18949890]
[118.39464569 161.16645813]
[107.35878754 171.32568359]
[96.32292938 181.48490906]
[85.28707123 191.64413452]
[74.25120544 201.80335999]
[63.21535110 211.96258545]
[52.17949295 222.12181091]
[55.61643982 237.09120178]
[51.09288788 251.76884460]
[39.82564545 262.20651245]
[24.84554482 265.59652710]
[10.18215847 261.02697754]
[-0.22013636 249.72706604]
[-3.56317472 234.73641968]
[1.05230391 220.08743286]
[12.38475895 209.72061157]
[27.38581657 206.42457581]
[42.02026749 211.08595276]
[53.05612564 200.92672729]
[64.09198761 190.76750183]
[75.12784576 180.60827637]
[86.16370392 170.44905090]
[97.19956207 160.28982544]
[108.23542023 150.13059998]
[90.13156128 147.89886475]
[74.66539001 139.59590149]
[63.69953918 126.77960205]
[58.34890747 111.50878143]
[58.87770462 96.02261353]
[64.72334290 82.41535950]
[52.81732559 73.29138947]
[40.91130829 64.16742706]
[29.00529099 55.04345703]
[16.96277618 62.27362823]
[2.46690607 63.70851517]
[-11.74068451 58.63204575]
[-22.78358841 47.60195541]
[-28.23065758 32.42085648]
[-42.82536697 28.95755577]
[-57.42007446 25.49425507]
[-72.01478577 22.03095436]
[-84.45180511 31.51011276]
[-100.06970215 30.72557259]
[-111.49416351 20.04776573]
[-113.33092499 4.51842785]
[-104.71271515 -8.52996254]
[-89.70879364 -12.93635464]
[-75.40354919 -6.62018538]
[-68.55148315 7.43624401]
[-53.95677567 10.89954472]
[-39.36206436 14.36284542]
[-24.76735497 17.82614708]
[-16.75281143 5.14675045]
[-26.14288521 -6.55053663]
[-35.62060547 -18.17691994]
[-51.11201477 -19.80603409]
[-60.64751434 -31.66052246]
[-58.99893570 -46.41917419]
[-68.56376648 -57.97399902]
[-78.12860107 -69.52882385]
[-92.88857269 -75.22566223]
[-95.04397583 -89.96348572]
[-104.60881042 -101.51831055]
[-114.17364502 -113.07312775]
[-129.72607422 -118.27447510]
[-132.73220825 -134.39575195]
[-120.09958649 -144.85275269]
[-104.82357788 -138.88822937]
[-102.61882019 -122.63796234]
[-93.05398560 -111.08314514]
[-83.48915100 -99.52832031]
[-69.41333008 -94.65795898]
[-66.57377625 -79.09365845]
[-57.00894547 -67.53883362]
[-47.44411087 -55.98400879]
[-32.63727570 -54.84679413]
[-22.77257347 -43.26481247]
[-24.06578255 -27.74175453]
[-17.37804222 -24.59322166]
[-14.44559765 -15.94060993]
[-5.05552483 -4.24332285]
[16.51095772 -4.83970499]
[33.94829178 6.31444788]
[41.75492859 24.53744698]
[38.12925720 43.13744354]
[50.03527451 52.26140976]
[61.94129181 61.38537598]
[73.84730530 70.50933838]
[79.18596649 66.52704620]
[85.11891174 63.50047302]
[91.47673798 61.51602554]
[98.07791901 60.63036728]
[104.73397827 60.86878586]
[111.25487518 62.22447586]
[118.19498444 48.92655182]
[125.13510132 35.62862396]
[123.36722565 15.54887962]
[140.11831665 5.89209652]
[146.65557861 -7.60842991]
[153.19284058 -21.10895538]
[159.73010254 -34.60948181]
[166.26736450 -48.11000824]
[164.53796387 -64.41770935]
[177.95358276 -73.84919739]
[192.71339417 -66.70216370]
[193.63375854 -50.32886505]
[179.76788330 -41.57274628]
[173.23062134 -28.07221985]
[166.69335938 -14.57169437]
[160.15609741 -1.07116818]
[153.61883545 12.42935848]
[157.82812500 21.74245071]
[156.18096924 32.05144119]
[148.98292542 39.91335678]
[138.43302917 42.56874084]
[131.49290466 55.86666489]
[124.55279541 69.16458893]
[141.04281616 81.28215790]
[150.75650024 102.16283417]
[164.83033752 96.97371674]
[175.10179138 84.94010925]
[189.71987915 87.79679871]
[199.99133301 75.76318359]
[214.60942078 78.61987305]
[221.57994080 72.71403503]
[228.93400574 73.46027374]
[243.08425903 68.48329163]
[257.23449707 63.50630951]
[267.49493408 50.71350479]
[283.66073608 53.46998596]
[289.10195923 68.94012451]
[278.22113037 81.20956421]
[262.21148682 77.65656281]
[248.06123352 82.63354492]
[233.91098022 87.61052704]
[219.79853821 92.69371796]
[210.53373718 104.35617065]
[194.90899658 101.87064362]
[185.64419556 113.53309631]
[170.01945496 111.04756165]
[155.94560242 116.23667908]
[157.63307190 131.14144897]
[172.51080322 133.05276489]
[187.38853455 134.96408081]
[203.86898804 130.98526001]
[212.25456238 145.72019958]
[200.41682434 157.85710144]
[185.47721863 149.84181213]
[170.59948730 147.93049622]
[155.72175598 146.01918030]
[146.77778625 158.06100464]
[152.90629578 171.75192261]
[159.03479004 185.44285583]
[165.16328430 199.13377380]
[171.29179382 212.82470703]
[177.42028809 226.51564026]
[183.54879761 240.20655823]
[189.67729187 253.89749146]
[195.80580139 267.58840942]
[201.93429565 281.27932739]
[208.06280518 294.97027588]
[214.19129944 308.66119385]
[220.31980896 322.35211182]
[226.44830322 336.04306030]
[232.57681274 349.73397827]
[247.06919861 355.44433594]
[253.08934021 369.41619873]
[247.55606079 383.19726562]
[253.68457031 396.88821411]
[259.81307983 410.57913208]
[265.94155884 424.27005005]
[272.07006836 437.96099854]
[278.19857788 451.65191650]
[284.32708740 465.34283447]
[290.45556641 479.03375244]
[296.58407593 492.72470093]
[302.71258545 506.41561890]
[317.12863159 513.45526123]
[320.47225952 529.14605713]
[310.17855835 541.45129395]
[294.14392090 540.93145752]
[284.66879272 527.98535156]
[289.02163696 512.54412842]
[282.89315796 498.85317993]
[276.76464844 485.16226196]
[270.63613892 471.47134399]
[264.50765991 457.78042603]
[258.37915039 444.08947754]
[252.25064087 430.39855957]
[246.12214661 416.70764160]
[239.99363708 403.01672363]
[233.86514282 389.32577515]
[219.90093994 384.27239990]
] def
/pairs [
[1 180]
[2 179]
[3 178]
[4 177]
[5 176]
[6 175]
[7 174]
[8 173]
[9 172]
[10 171]
[11 170]
[12 169]
[13 168]
[14 167]
[15 166]
[16 39]
[17 38]
[18 37]
[19 36]
[20 35]
[21 34]
[22 33]
[45 103]
[46 102]
[47 101]
[48 100]
[53 67]
[54 66]
[55 65]
[56 64]
[68 96]
[69 95]
[70 93]
[73 90]
[74 89]
[75 88]
[77 86]
[78 85]
[79 84]
[109 132]
[110 131]
[111 130]
[113 126]
[114 125]
[115 124]
[116 123]
[117 122]
[134 156]
[135 155]
[137 153]
[139 151]
[141 150]
[142 149]
[143 148]
[157 165]
[158 164]
[159 163]
[183 207]
[184 206]
[185 205]
[186 204]
[187 203]
[188 202]
[189 201]
[190 200]
[191 199]
[192 198]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
