%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:39 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (4frg_b)
} def

/sequence { (\
GGCCUAAAAGCAUAGUGGGAAAGUGACGUGAAAUUCGUCCAGAUGCGAAAGCAUACGGUUAUACUCCGAAUGCCACCUAGGCCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 83 0.999233578 ubox
2 82 0.999987662 ubox
3 81 0.999995112 ubox
4 80 0.999978035 ubox
5 79 0.997007990 ubox
6 78 0.960799758 ubox
7 78 0.030858250 ubox
8 78 0.007975793 ubox
9 78 0.027151942 ubox
10 27 0.003765314 ubox
10 46 0.239413129 ubox
10 73 0.962402684 ubox
10 74 0.079687506 ubox
10 76 0.014033565 ubox
10 77 0.033553158 ubox
11 17 0.004935103 ubox
11 25 0.006117319 ubox
11 30 0.017670127 ubox
11 45 0.239716281 ubox
11 72 0.966739383 ubox
12 16 0.004030357 ubox
12 24 0.006133074 ubox
12 29 0.017620323 ubox
12 44 0.238795055 ubox
12 71 0.959939454 ubox
13 23 0.005996988 ubox
13 28 0.015909883 ubox
13 42 0.005374606 ubox
13 43 0.232752341 ubox
13 68 0.004079529 ubox
13 69 0.012580129 ubox
13 70 0.889548806 ubox
13 72 0.021024824 ubox
13 79 0.007280645 ubox
14 24 0.006977107 ubox
14 65 0.018670772 ubox
14 71 0.031398931 ubox
14 78 0.011787378 ubox
15 27 0.020308031 ubox
15 40 0.010788878 ubox
15 46 0.003177038 ubox
15 64 0.018818939 ubox
15 67 0.084349239 ubox
15 71 0.018473774 ubox
15 76 0.064538397 ubox
15 77 0.010051579 ubox
16 21 0.006364742 ubox
16 22 0.008955989 ubox
16 26 0.020279490 ubox
16 41 0.232928269 ubox
16 42 0.007103770 ubox
16 47 0.003342048 ubox
16 48 0.003841433 ubox
16 63 0.018736361 ubox
16 68 0.161937807 ubox
16 69 0.794754573 ubox
16 70 0.021329568 ubox
16 75 0.065465625 ubox
17 24 0.004026089 ubox
17 38 0.009162818 ubox
17 39 0.007690051 ubox
17 40 0.236006407 ubox
17 46 0.004504355 ubox
17 62 0.017851437 ubox
17 65 0.009826264 ubox
17 66 0.106124412 ubox
17 67 0.172695272 ubox
17 74 0.065476017 ubox
17 77 0.005053966 ubox
17 78 0.003874689 ubox
18 24 0.018751305 ubox
18 27 0.004706817 ubox
18 38 0.007115655 ubox
18 39 0.234502432 ubox
18 40 0.053092189 ubox
18 46 0.005912846 ubox
18 64 0.010303723 ubox
18 65 0.106460680 ubox
18 66 0.167440949 ubox
18 67 0.943290597 ubox
18 73 0.065069284 ubox
18 74 0.003664359 ubox
18 76 0.005039064 ubox
18 77 0.004728047 ubox
19 36 0.030978604 ubox
19 38 0.224765715 ubox
19 39 0.053640708 ubox
19 40 0.006137007 ubox
19 44 0.003454953 ubox
19 60 0.012085020 ubox
19 64 0.118562849 ubox
19 65 0.133787176 ubox
19 66 0.944383054 ubox
19 73 0.004034462 ubox
19 76 0.004695760 ubox
20 35 0.031311801 ubox
20 38 0.052677002 ubox
20 44 0.004470015 ubox
20 59 0.012794825 ubox
20 60 0.004819098 ubox
20 62 0.009419567 ubox
20 65 0.938195829 ubox
20 71 0.050286735 ubox
21 34 0.028093215 ubox
21 35 0.012242523 ubox
21 38 0.004110717 ubox
21 59 0.004810516 ubox
21 60 0.013487193 ubox
21 62 0.014877116 ubox
21 65 0.017444118 ubox
21 71 0.003483992 ubox
22 29 0.004158995 ubox
22 34 0.012497246 ubox
22 35 0.202817005 ubox
22 38 0.004884749 ubox
22 59 0.013395228 ubox
22 60 0.005773326 ubox
22 62 0.027345618 ubox
22 65 0.045510236 ubox
23 34 0.221994882 ubox
23 35 0.006989519 ubox
23 36 0.015975974 ubox
23 38 0.007980246 ubox
23 40 0.118871678 ubox
23 56 0.016574053 ubox
23 59 0.004866204 ubox
23 60 0.007509533 ubox
23 62 0.937947071 ubox
23 64 0.069633450 ubox
23 67 0.018152121 ubox
24 30 0.003999610 ubox
24 31 0.028372094 ubox
24 32 0.019678784 ubox
24 33 0.223234955 ubox
24 37 0.054974804 ubox
24 41 0.024461349 ubox
24 42 0.004337097 ubox
24 55 0.015814572 ubox
24 57 0.012071869 ubox
24 61 0.946430019 ubox
24 63 0.066842076 ubox
24 68 0.007420278 ubox
25 34 0.006999327 ubox
25 35 0.006538921 ubox
25 36 0.057148956 ubox
25 39 0.173600144 ubox
25 40 0.019500598 ubox
25 54 0.003400426 ubox
25 56 0.010457396 ubox
25 59 0.022470933 ubox
25 60 0.945161886 ubox
25 62 0.041330912 ubox
25 64 0.003193344 ubox
25 66 0.023269613 ubox
25 67 0.007649823 ubox
26 34 0.006657399 ubox
26 35 0.056229358 ubox
26 38 0.183591853 ubox
26 59 0.931021399 ubox
26 60 0.010815821 ubox
26 65 0.023271008 ubox
27 37 0.186546444 ubox
27 57 0.633329816 ubox
27 58 0.707737565 ubox
28 34 0.014061305 ubox
28 35 0.011411843 ubox
28 36 0.186566483 ubox
28 38 0.016307034 ubox
28 39 0.035122638 ubox
28 40 0.044095431 ubox
28 52 0.021074358 ubox
28 54 0.254616770 ubox
28 56 0.873844303 ubox
28 62 0.015445310 ubox
28 64 0.034721312 ubox
28 67 0.003197956 ubox
28 76 0.008077496 ubox
29 33 0.014086557 ubox
29 37 0.059673476 ubox
29 41 0.024116143 ubox
29 51 0.020837300 ubox
29 53 0.263465589 ubox
29 55 0.870963767 ubox
29 57 0.069180916 ubox
29 61 0.018842353 ubox
29 63 0.034681699 ubox
29 75 0.008118091 ubox
30 34 0.030972698 ubox
30 35 0.017255099 ubox
30 36 0.082236711 ubox
30 38 0.003163207 ubox
30 39 0.068012033 ubox
30 40 0.027340087 ubox
30 52 0.271192284 ubox
30 54 0.814266961 ubox
30 56 0.076475623 ubox
30 60 0.018789761 ubox
30 62 0.033358690 ubox
30 66 0.003204481 ubox
30 74 0.008112549 ubox
31 35 0.071757375 ubox
31 38 0.064758283 ubox
31 54 0.059477323 ubox
31 59 0.018463675 ubox
31 60 0.006017213 ubox
32 38 0.007880039 ubox
32 54 0.022154740 ubox
32 59 0.005756876 ubox
32 60 0.027715371 ubox
33 38 0.003833094 ubox
33 44 0.009593462 ubox
33 54 0.017988231 ubox
33 59 0.027831784 ubox
33 60 0.007180968 ubox
33 62 0.003309277 ubox
33 71 0.005802418 ubox
34 41 0.004100342 ubox
34 42 0.003689309 ubox
34 43 0.010006192 ubox
34 48 0.017878389 ubox
34 49 0.823693130 ubox
34 50 0.207056323 ubox
34 51 0.024992752 ubox
34 53 0.016517511 ubox
34 58 0.019607119 ubox
34 61 0.004207006 ubox
34 70 0.005860469 ubox
35 41 0.004991524 ubox
35 42 0.009940960 ubox
35 43 0.050568127 ubox
35 47 0.005836232 ubox
35 48 0.907834805 ubox
35 49 0.148134958 ubox
35 50 0.009464167 ubox
35 51 0.003390636 ubox
35 57 0.004528753 ubox
35 58 0.042010528 ubox
35 69 0.005892803 ubox
36 42 0.069420917 ubox
36 45 0.010126652 ubox
36 47 0.923425663 ubox
36 51 0.004839932 ubox
36 57 0.115685457 ubox
36 68 0.005895341 ubox
37 44 0.010739407 ubox
37 46 0.923179705 ubox
37 56 0.116466870 ubox
37 59 0.005686735 ubox
37 60 0.003574470 ubox
37 64 0.004554697 ubox
37 67 0.005649313 ubox
38 42 0.004681864 ubox
38 43 0.013027355 ubox
38 45 0.876390306 ubox
38 48 0.018395689 ubox
38 55 0.115705038 ubox
38 57 0.003356257 ubox
38 63 0.004593591 ubox
39 45 0.125141325 ubox
39 47 0.018571937 ubox
39 57 0.014461687 ubox
39 58 0.070362911 ubox
40 45 0.038047253 ubox
40 47 0.003762984 ubox
40 57 0.098077343 ubox
40 58 0.024605818 ubox
41 54 0.005701945 ubox
41 60 0.003204521 ubox
42 54 0.014607768 ubox
42 56 0.092308506 ubox
42 59 0.003338208 ubox
42 60 0.003409140 ubox
43 54 0.274049279 ubox
43 59 0.003163520 ubox
44 53 0.294852369 ubox
45 52 0.297860467 ubox
46 51 0.297755767 ubox
46 57 0.004729180 ubox
47 56 0.004815717 ubox
47 74 0.025461857 ubox
47 76 0.030017077 ubox
47 77 0.062160441 ubox
51 56 0.006879204 ubox
51 59 0.003476629 ubox
51 73 0.240047972 ubox
51 74 0.015903943 ubox
52 57 0.009630859 ubox
52 58 0.003517371 ubox
52 72 0.241165288 ubox
53 62 0.003760720 ubox
53 71 0.240920978 ubox
54 61 0.004535595 ubox
54 69 0.010408235 ubox
54 70 0.234607454 ubox
55 60 0.005283447 ubox
55 62 0.004230881 ubox
56 68 0.258188364 ubox
57 62 0.007071015 ubox
57 64 0.063390343 ubox
57 65 0.027070348 ubox
57 66 0.004052427 ubox
57 67 0.259384837 ubox
57 74 0.004555836 ubox
58 62 0.003504340 ubox
58 64 0.039506848 ubox
58 65 0.003674817 ubox
58 66 0.259091600 ubox
58 73 0.004561938 ubox
59 63 0.036088635 ubox
59 72 0.004298192 ubox
61 65 0.005351772 ubox
1 83 0.9500000 lbox
2 82 0.9500000 lbox
3 81 0.9500000 lbox
4 80 0.9500000 lbox
5 79 0.9500000 lbox
6 78 0.9500000 lbox
10 73 0.9500000 lbox
11 72 0.9500000 lbox
12 71 0.9500000 lbox
13 70 0.9500000 lbox
16 69 0.9500000 lbox
18 67 0.9500000 lbox
19 66 0.9500000 lbox
20 65 0.9500000 lbox
23 62 0.9500000 lbox
24 61 0.9500000 lbox
25 60 0.9500000 lbox
26 59 0.9500000 lbox
27 58 0.9500000 lbox
28 56 0.9500000 lbox
29 55 0.9500000 lbox
30 54 0.9500000 lbox
34 49 0.9500000 lbox
35 48 0.9500000 lbox
36 47 0.9500000 lbox
37 46 0.9500000 lbox
38 45 0.9500000 lbox
showpage
end
%%EOF
