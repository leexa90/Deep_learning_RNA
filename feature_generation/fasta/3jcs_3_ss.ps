%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:34 2017
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GUGGUAAUGCGAAACACUUGCCAGGUAACAAAUCAAUCCUCCCACGGUGAGCUUUCUUUUCACCAUAAUCCACAUCUCCGGCUUUGCUGGGGCUUGGGCCUUUUUACUUCUCGCGUUGUUCGGAGCGGGGGCUCAAGAUUGAAAAAUGCAGCUCUCCCUACGUACUGUCAUUGUUGUGAGUUCUGCGCAUUAAAGCAAAAACCUGGGG\
) def
/coor [
[65.35925293 252.95086670]
[61.35007095 267.40515137]
[57.34089279 281.85943604]
[68.54265594 292.28915405]
[73.60345459 306.73376465]
[71.36034393 321.87402344]
[62.32878113 334.23077393]
[48.58415222 340.96456909]
[33.28487015 340.52798462]
[19.94660187 333.02136230]
[11.63438034 320.16970825]
[10.25829411 304.92617798]
[16.13455772 290.79367065]
[27.91284943 281.01968384]
[42.88660431 277.85025024]
[46.89578247 263.39596558]
[50.90496063 248.94168091]
[41.50420761 237.41935730]
[40.68113327 222.39317322]
[48.96065521 209.61416626]
[63.34351730 204.09696960]
[67.35269928 189.64268494]
[71.36187744 175.18840027]
[75.37105560 160.73410034]
[79.38023376 146.27981567]
[83.38941193 131.82553101]
[79.10042572 125.67292023]
[68.65228271 136.43565369]
[58.20414352 147.19837952]
[47.75600052 157.96110535]
[37.30786133 168.72383118]
[32.80387878 183.03167725]
[22.04297638 193.48168945]
[7.60929108 197.56442261]
[-7.03105879 194.29943848]
[-18.36232376 184.47077942]
[-23.66340446 170.43873596]
[-21.66128922 155.57295227]
[-12.83677292 143.44331360]
[0.69101894 136.96266174]
[15.67190075 137.68676758]
[29.38453865 131.60700989]
[43.09717560 125.52723694]
[56.80981064 119.44747162]
[70.52245331 113.36769867]
[66.23345947 107.21509552]
[51.28469467 105.97640228]
[36.33592606 104.73770905]
[21.38715935 103.49902344]
[6.43839264 102.26033020]
[-8.51037502 101.02164459]
[-19.38765335 112.25635529]
[-34.94691849 113.81944275]
[-47.84156418 104.97285461]
[-51.98313141 89.89368439]
[-45.41609955 75.70185089]
[-31.24122047 69.09830475]
[-16.15143776 73.20104218]
[-7.27168465 86.07287598]
[7.67708254 87.31156158]
[22.62585068 88.55025482]
[37.57461929 89.78894806]
[52.52338409 91.02763367]
[67.47215271 92.26632690]
[71.18955994 85.75242615]
[58.16176605 78.31761169]
[45.13396835 70.88278961]
[32.10617065 63.44797516]
[17.41855240 60.40267181]
[15.77627182 45.49284363]
[29.44894409 39.32372284]
[39.54098892 50.42017746]
[52.56878662 57.85499573]
[65.59658051 65.28981018]
[78.62438202 72.72463226]
[82.34178925 66.21073151]
[73.67156982 53.97033310]
[65.00135803 41.72993469]
[56.33114243 29.48953629]
[47.66092682 17.24913788]
[38.99071121 5.00873852]
[30.32049370 -7.23166037]
[16.23127365 -16.66194153]
[21.39273262 -32.81111145]
[38.33962250 -32.32189941]
[42.56089401 -15.90187550]
[51.23110962 -3.66147709]
[59.90132523 8.57892132]
[68.57154083 20.81932068]
[77.24175262 33.05971909]
[85.91197205 45.30011749]
[94.58218384 57.54051590]
[109.41304779 55.29426575]
[114.06974030 41.03540421]
[118.72643280 26.77653885]
[123.38312531 12.51767445]
[128.03982544 -1.74118996]
[132.69651794 -16.00005341]
[137.35321045 -30.25891876]
[142.00990295 -44.51778412]
[146.66659546 -58.77664566]
[132.31115723 -54.42675018]
[119.87288666 -62.81062698]
[118.51876068 -77.74938202]
[129.24674988 -88.23317719]
[144.15037537 -86.53548431]
[152.24562073 -73.90799713]
[157.95982361 -87.77695465]
[156.06306458 -103.48405457]
[168.06536865 -112.30414581]
[173.77957153 -126.17310333]
[179.49377441 -140.04205322]
[179.86970520 -149.17034912]
[185.39950562 -154.07548523]
[191.32151794 -167.85699463]
[186.73704529 -183.23106384]
[196.01652527 -196.31811523]
[212.04151917 -197.07887268]
[222.51904297 -184.92976379]
[219.41163635 -169.19052124]
[205.10301208 -161.93496704]
[199.18099976 -148.15347290]
[193.36271667 -134.32785034]
[187.64851379 -120.45890045]
[181.93431091 -106.58994293]
[184.23979187 -91.87484741]
[171.82876587 -82.06275177]
[166.11456299 -68.19380188]
[160.92546082 -54.11995316]
[156.26876831 -39.86108780]
[151.61207581 -25.60222435]
[146.95538330 -11.34336090]
[142.29867554 2.91550350]
[137.64198303 17.17436790]
[132.98529053 31.43323135]
[128.32859802 45.69209671]
[123.67190552 59.95095825]
[128.35786438 65.80688477]
[139.28056335 55.52609253]
[148.74096680 43.88561249]
[163.15457153 39.73253250]
[177.35839844 44.55449677]
[186.26460266 56.62426376]
[186.68299866 71.61842346]
[178.46368408 84.16605377]
[164.54902649 89.77271271]
[149.82423401 92.63288879]
[154.51019287 98.48881531]
[168.80364990 103.03820801]
[183.09710693 107.58760834]
[197.39056396 112.13700104]
[211.30352783 105.13220978]
[225.73432922 109.94956207]
[232.32658386 123.25662231]
[246.62004089 127.80601501]
[260.91351318 132.35540771]
[276.41030884 129.16806030]
[286.19143677 140.40100098]
[301.68826294 137.21365356]
[311.46936035 148.44659424]
[325.76281738 152.99598694]
[340.05627441 157.54539490]
[351.87448120 147.62904358]
[367.18063354 145.69895935]
[381.09060669 152.37101746]
[389.16577148 165.51617432]
[388.82937622 180.93988037]
[380.18875122 193.72045898]
[366.00112915 199.77969360]
[350.79367065 197.18411255]
[339.41906738 186.76193237]
[335.50689697 171.83885193]
[321.21343994 167.28944397]
[306.91995239 162.74005127]
[292.44552612 166.25280762]
[281.64202881 154.69445801]
[267.16757202 158.20722961]
[256.36410522 146.64888000]
[242.07064819 142.09947205]
[227.77719116 137.55007935]
[214.70605469 144.59857178]
[200.14564514 140.18844604]
[192.84117126 126.43046570]
[178.54771423 121.88106537]
[164.25424194 117.33167267]
[149.96078491 112.78227234]
[140.57070923 124.47956085]
[148.10324097 137.45111084]
[163.44154358 141.26054382]
[171.52200317 154.84294128]
[167.55062866 170.14012146]
[153.88354492 178.07653809]
[138.62921143 173.94363403]
[130.83775330 160.19342041]
[135.13168335 144.98362732]
[127.59916687 132.01208496]
[120.16030121 132.96774292]
[122.07136536 147.84550476]
[107.19357300 149.75631714]
[105.28256989 134.87904358]
[97.84370422 135.83470154]
[93.83452606 150.28898621]
[89.82534790 164.74328613]
[85.81616211 179.19757080]
[81.80698395 193.65185547]
[77.79780579 208.10615540]
[87.28375244 220.24382019]
[87.79773712 235.46188354]
] def
/pairs [
[1 17]
[2 16]
[3 15]
[21 206]
[22 205]
[23 204]
[24 203]
[25 202]
[26 201]
[46 64]
[47 63]
[48 62]
[49 61]
[50 60]
[51 59]
[76 92]
[77 91]
[78 90]
[79 89]
[80 88]
[81 87]
[82 86]
[93 137]
[94 136]
[95 135]
[96 134]
[97 133]
[98 132]
[99 131]
[100 130]
[101 129]
[107 128]
[108 127]
[110 125]
[111 124]
[112 123]
[114 122]
[115 121]
[148 186]
[149 185]
[150 184]
[151 183]
[154 180]
[155 179]
[156 178]
[158 176]
[160 174]
[161 173]
[162 172]
[187 196]
[188 195]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
