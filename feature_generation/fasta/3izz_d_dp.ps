%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:30 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (3izz_d)
} def

/sequence { (\
GUGCCAGCAGCCGCGGUAAUACGGAGGGCGCGAGCGUUACCCGGAUUCACUGGGCGUAAA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 5 0.015444769 ubox
1 8 0.132684225 ubox
1 20 0.004778226 ubox
1 22 0.006452033 ubox
1 31 0.781180646 ubox
1 35 0.040358154 ubox
1 37 0.061753586 ubox
1 38 0.014980064 ubox
1 40 0.005632543 ubox
1 55 0.187584480 ubox
1 57 0.072573557 ubox
2 6 0.003722867 ubox
2 7 0.130617338 ubox
2 9 0.035686597 ubox
2 18 0.047592961 ubox
2 19 0.003941645 ubox
2 21 0.005724540 ubox
2 30 0.781377820 ubox
2 32 0.011887713 ubox
2 34 0.040070264 ubox
2 36 0.269530089 ubox
2 39 0.007333220 ubox
2 54 0.176744787 ubox
2 56 0.193333393 ubox
2 58 0.056186394 ubox
2 59 0.007502479 ubox
2 60 0.007966284 ubox
3 8 0.039410562 ubox
3 11 0.006717591 ubox
3 17 0.052437210 ubox
3 29 0.782209113 ubox
3 31 0.015748191 ubox
3 35 0.378604769 ubox
3 37 0.013915122 ubox
3 38 0.004157278 ubox
3 55 0.265546016 ubox
3 57 0.061025443 ubox
4 10 0.006857508 ubox
4 16 0.052779532 ubox
4 27 0.006942314 ubox
4 28 0.782183395 ubox
4 30 0.015518952 ubox
4 32 0.010265552 ubox
4 34 0.378576528 ubox
4 36 0.014818990 ubox
4 52 0.014342917 ubox
4 53 0.257575793 ubox
4 54 0.229001173 ubox
4 56 0.060875059 ubox
5 15 0.052584470 ubox
5 26 0.009709600 ubox
5 27 0.780374762 ubox
5 28 0.005992203 ubox
5 30 0.004255393 ubox
5 32 0.095333451 ubox
5 34 0.015496276 ubox
5 52 0.291294093 ubox
5 53 0.184887638 ubox
5 54 0.005454765 ubox
5 56 0.008815514 ubox
6 38 0.044544893 ubox
6 47 0.003294026 ubox
6 51 0.320905184 ubox
6 57 0.009792299 ubox
7 12 0.003981805 ubox
7 14 0.055998398 ubox
7 29 0.016074203 ubox
7 31 0.383850908 ubox
7 35 0.008339938 ubox
7 37 0.051511568 ubox
7 38 0.003193754 ubox
7 48 0.021288799 ubox
7 50 0.321988316 ubox
7 51 0.013673512 ubox
7 55 0.004567728 ubox
7 57 0.226422365 ubox
8 13 0.056166759 ubox
8 15 0.004070412 ubox
8 23 0.008215875 ubox
8 24 0.096939672 ubox
8 26 0.094590591 ubox
8 27 0.045862610 ubox
8 28 0.015495670 ubox
8 30 0.382925873 ubox
8 32 0.005821031 ubox
8 34 0.008339934 ubox
8 36 0.051888779 ubox
8 52 0.091190675 ubox
8 54 0.004152493 ubox
8 56 0.230786557 ubox
9 20 0.003827798 ubox
9 46 0.083119009 ubox
9 47 0.127788714 ubox
9 51 0.092196225 ubox
9 57 0.024196372 ubox
10 17 0.013581503 ubox
10 22 0.026030818 ubox
10 29 0.337364736 ubox
10 35 0.063382982 ubox
10 46 0.140264725 ubox
10 47 0.036810036 ubox
10 48 0.033186509 ubox
10 50 0.092131699 ubox
10 55 0.335447009 ubox
10 57 0.022128355 ubox
11 16 0.014962783 ubox
11 23 0.009301344 ubox
11 24 0.770244713 ubox
11 26 0.062253887 ubox
11 27 0.187949962 ubox
11 28 0.335824204 ubox
11 34 0.063428090 ubox
11 44 0.344939731 ubox
11 53 0.005749663 ubox
11 54 0.335598841 ubox
11 56 0.022620816 ubox
12 23 0.771621422 ubox
12 24 0.038632545 ubox
12 26 0.191281171 ubox
12 27 0.333606640 ubox
12 32 0.064841631 ubox
12 43 0.345204570 ubox
12 44 0.005232540 ubox
12 52 0.005894699 ubox
12 53 0.335309206 ubox
12 54 0.025740617 ubox
12 56 0.003722550 ubox
13 20 0.006656909 ubox
13 22 0.767896397 ubox
13 29 0.003169158 ubox
13 31 0.064907470 ubox
13 42 0.345024456 ubox
13 51 0.005230195 ubox
13 55 0.003905992 ubox
14 23 0.300456317 ubox
14 24 0.240292092 ubox
14 26 0.049906384 ubox
14 30 0.064905135 ubox
14 43 0.006934095 ubox
14 52 0.333252356 ubox
14 54 0.003731436 ubox
15 20 0.234745440 ubox
15 22 0.307977907 ubox
15 29 0.064563851 ubox
15 41 0.345207171 ubox
15 42 0.006077066 ubox
15 50 0.033173974 ubox
15 51 0.334755504 ubox
16 20 0.046627656 ubox
16 22 0.244574093 ubox
16 29 0.005795391 ubox
16 40 0.345264803 ubox
16 41 0.004963618 ubox
16 48 0.011840762 ubox
16 50 0.335044261 ubox
17 21 0.220938936 ubox
17 23 0.011421156 ubox
17 24 0.010762675 ubox
17 26 0.006491551 ubox
17 27 0.048465205 ubox
17 28 0.008057196 ubox
17 39 0.345060549 ubox
17 49 0.332030599 ubox
18 38 0.341810183 ubox
18 46 0.007475492 ubox
18 47 0.315376147 ubox
19 37 0.322608627 ubox
19 38 0.010110440 ubox
19 46 0.319503180 ubox
19 47 0.041958800 ubox
20 24 0.003631373 ubox
20 25 0.013743223 ubox
20 26 0.006661515 ubox
20 32 0.008679791 ubox
20 33 0.011365238 ubox
20 34 0.012270060 ubox
20 36 0.312703019 ubox
20 44 0.006355654 ubox
20 45 0.209549159 ubox
20 58 0.044343729 ubox
21 37 0.104066548 ubox
21 46 0.003493902 ubox
21 57 0.047067505 ubox
22 26 0.009248320 ubox
22 27 0.049610763 ubox
22 28 0.005567438 ubox
22 30 0.049986091 ubox
22 32 0.223119989 ubox
22 34 0.158691582 ubox
22 36 0.119911250 ubox
22 43 0.334386461 ubox
22 44 0.020395650 ubox
22 56 0.047343198 ubox
23 29 0.051086622 ubox
23 31 0.223500658 ubox
23 35 0.120977584 ubox
23 40 0.003908564 ubox
23 41 0.046322427 ubox
23 42 0.333133629 ubox
23 55 0.046753144 ubox
24 29 0.091751874 ubox
24 31 0.056390597 ubox
24 35 0.007004600 ubox
24 38 0.008398325 ubox
24 40 0.060866093 ubox
24 41 0.329922668 ubox
24 42 0.017089981 ubox
25 37 0.011720622 ubox
25 38 0.189334508 ubox
26 31 0.163044119 ubox
26 35 0.013261188 ubox
26 37 0.234775249 ubox
26 38 0.020455086 ubox
26 40 0.139343930 ubox
26 41 0.019204542 ubox
26 42 0.007581948 ubox
27 31 0.036325122 ubox
27 35 0.012681664 ubox
27 37 0.020852169 ubox
27 38 0.204311774 ubox
27 40 0.021312193 ubox
27 41 0.007672916 ubox
28 35 0.282737388 ubox
28 37 0.236092797 ubox
28 38 0.008532764 ubox
28 40 0.007612655 ubox
29 34 0.282937063 ubox
29 36 0.237565545 ubox
30 35 0.231453320 ubox
30 37 0.024125779 ubox
30 57 0.007103477 ubox
31 36 0.024490749 ubox
31 56 0.007512977 ubox
32 37 0.004165450 ubox
32 38 0.009837251 ubox
32 55 0.011721411 ubox
32 57 0.011471139 ubox
33 37 0.008828749 ubox
33 38 0.007136779 ubox
33 57 0.028436662 ubox
34 38 0.003437858 ubox
34 55 0.022768586 ubox
34 57 0.708828743 ubox
35 54 0.017047031 ubox
35 56 0.725433539 ubox
36 55 0.724120764 ubox
36 57 0.014559040 ubox
37 54 0.245401324 ubox
37 56 0.018255157 ubox
37 58 0.023474240 ubox
37 59 0.137527912 ubox
37 60 0.010105477 ubox
38 53 0.029103765 ubox
38 54 0.016204259 ubox
38 56 0.075945870 ubox
38 58 0.158000770 ubox
38 59 0.011608636 ubox
39 57 0.152224586 ubox
40 52 0.005320864 ubox
40 53 0.059077665 ubox
40 54 0.831912646 ubox
40 56 0.104781819 ubox
41 52 0.057320205 ubox
41 53 0.869594944 ubox
41 54 0.079907022 ubox
42 52 0.870393651 ubox
42 53 0.077341993 ubox
43 48 0.010878062 ubox
43 50 0.085594854 ubox
43 51 0.866810141 ubox
44 48 0.010914547 ubox
44 50 0.864203810 ubox
44 51 0.062560298 ubox
45 51 0.003528894 ubox
1 31 0.9500000 lbox
2 30 0.9500000 lbox
3 29 0.9500000 lbox
4 28 0.9500000 lbox
5 27 0.9500000 lbox
11 24 0.9500000 lbox
12 23 0.9500000 lbox
13 22 0.9500000 lbox
34 57 0.9500000 lbox
35 56 0.9500000 lbox
36 55 0.9500000 lbox
40 54 0.9500000 lbox
41 53 0.9500000 lbox
42 52 0.9500000 lbox
43 51 0.9500000 lbox
44 50 0.9500000 lbox
showpage
end
%%EOF
