%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:42 2017
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GGAAAUGCGAAACACUUGCCAGGUGACCCAUCCAUCCUCCCACGGUGAGCUUUCUUUUCACCAUAAUCCACAUCUCCGGCCUUGCUGGGGCUUGGGCCUCUCGACUUCUCGCGUUACUCGGAGCGGGGGCUCAAGAUUGAAAAAUGCAGCUCACCCUACGUACUGUCCUUUGUUGUGAGUUCGGCGCAUUAAAGCAAAAACCUGGGGUG\
) def
/coor [
[81.03004456 351.46853638]
[83.10321808 366.55569458]
[78.85443115 381.17990112]
[69.01980591 392.80746460]
[55.30325317 399.42379761]
[40.08124924 399.88262939]
[25.99110031 394.10443115]
[15.47400570 383.09033203]
[10.35211849 368.74856567]
[11.51283455 353.56393433]
[18.75505447 340.16729736]
[30.82401848 330.87966919]
[45.62870789 327.31021118]
[48.30706024 312.55126953]
[50.98541260 297.79232788]
[53.66376877 283.03338623]
[51.72814941 278.66656494]
[52.51573563 273.03735352]
[56.64933777 267.87582397]
[59.76801300 253.20361328]
[62.88668823 238.53140259]
[66.00536346 223.85919189]
[69.12403870 209.18698120]
[72.24271393 194.51475525]
[60.15624237 190.08874512]
[48.75003815 184.12460327]
[38.21885300 176.72416687]
[28.74248314 168.01377869]
[20.48272705 158.14215088]
[13.58060455 147.27784729]
[8.15396023 135.60635376]
[4.29544592 123.32691956]
[2.07093930 110.64922333]
[1.51842046 97.78971100]
[2.64732289 84.96792603]
[5.43837214 72.40280151]
[9.84391594 60.30884933]
[15.78873539 48.89256668]
[23.17133331 38.34886169]
[31.86566162 28.85775757]
[41.72327805 20.58129501]
[52.57588196 13.66078663]
[64.23817444 8.21438599]
[76.51105499 4.33508396]
[74.05377960 -10.46227551]
[71.59651184 -25.25963402]
[69.13924408 -40.05699158]
[66.68197632 -54.85435104]
[64.22470856 -69.65171051]
[61.76744080 -84.44906616]
[59.31016922 -99.24642944]
[44.08106613 -106.60563660]
[36.31605148 -121.44455719]
[38.89965820 -137.82365417]
[50.61806870 -149.31907654]
[47.93971634 -164.07801819]
[45.26136017 -178.83695984]
[42.58300781 -193.59591675]
[39.90465546 -208.35485840]
[37.22630310 -223.11380005]
[36.10039902 -208.15611267]
[29.17179298 -194.85218811]
[17.56156921 -185.35467529]
[3.14833045 -181.20033264]
[-11.73577499 -183.06135559]
[-24.68241119 -190.63662720]
[-33.59673691 -202.70039368]
[-37.03636169 -217.30070496]
[-34.44473267 -232.07513428]
[-26.24119377 -244.63307190]
[-13.75312233 -252.94258118]
[0.99883664 -255.65914917]
[15.62772942 -252.34320068]
[27.76826477 -243.52937317]
[18.24152756 -255.11561584]
[8.71479034 -266.70187378]
[-0.81194580 -278.28811646]
[-10.33868217 -289.87438965]
[-19.86541939 -301.46063232]
[-29.39215469 -313.04690552]
[-44.12213516 -321.44119263]
[-40.13356018 -337.91928101]
[-23.19528770 -338.64816284]
[-17.80590057 -322.57363892]
[-8.27916431 -310.98736572]
[1.24757206 -299.40112305]
[10.77430820 -287.81488037]
[20.30104446 -276.22860718]
[29.82778168 -264.64236450]
[39.35451889 -253.05610657]
[53.97843552 -256.39392090]
[57.53464127 -270.96627808]
[61.09084702 -285.53863525]
[64.64705658 -300.11096191]
[68.20326233 -314.68331909]
[71.75946808 -329.25567627]
[75.31567383 -343.82803345]
[78.87187958 -358.40036011]
[82.42808533 -372.97271729]
[85.98429108 -387.54507446]
[84.97863007 -396.62478638]
[89.70422363 -402.30801392]
[93.47802734 -416.82553101]
[92.60830688 -425.91925049]
[97.41838837 -431.53115845]
[101.40894318 -445.99060059]
[105.39949799 -460.45007324]
[109.39004517 -474.90951538]
[98.17485046 -485.32476807]
[93.09545135 -499.76287842]
[95.31905365 -514.90600586]
[104.33468628 -527.27435303]
[118.07062531 -534.02587891]
[133.37045288 -533.60900879]
[146.71838379 -526.11956787]
[155.04716492 -513.27862549]
[156.44288635 -498.03689575]
[150.58483887 -483.89678955]
[138.81915283 -474.10766602]
[123.84948730 -470.91894531]
[119.85894012 -456.45950317]
[115.86838531 -442.00006104]
[111.87783051 -427.54061890]
[107.99554443 -413.05172729]
[104.22174835 -398.53421021]
[100.55664062 -383.98886108]
[97.00043488 -369.41650391]
[93.44422913 -354.84417725]
[89.88802338 -340.27182007]
[86.33181763 -325.69946289]
[82.77561188 -311.12710571]
[79.21940613 -296.55477905]
[75.66320038 -281.98242188]
[72.10699463 -267.41006470]
[68.55078888 -252.83770752]
[67.21915436 -240.16064453]
[60.89704514 -230.62869263]
[51.98524475 -225.79214478]
[54.66359711 -211.03320312]
[57.34195328 -196.27426147]
[60.02030563 -181.51531982]
[62.69865799 -166.75637817]
[65.37701416 -151.99743652]
[77.89158630 -147.34565735]
[86.54266357 -137.03475952]
[88.98849487 -123.68938446]
[84.48498535 -110.77626038]
[74.10752869 -101.70369720]
[76.56479645 -86.90634155]
[79.02206421 -72.10897827]
[81.47933197 -57.31161880]
[83.93660736 -42.51426315]
[86.39387512 -27.71690369]
[88.85114288 -12.91954422]
[91.30841064 1.87781513]
[108.60845947 1.87048733]
[125.64299774 4.88983488]
[141.88661194 10.84273052]
[156.83828735 19.54556465]
[170.03684998 30.72990990]
[181.07524109 44.05080032]
[189.61296082 59.09736633]
[195.38667297 75.40552521]
[198.21832275 92.47226715]
[198.02056885 109.77118683]
[194.79948425 126.76873016]
[188.65443420 142.94062805]
[179.77496338 157.78808594]
[191.21740723 167.48707581]
[202.65985107 177.18606567]
[214.10229492 186.88507080]
[225.54473877 196.58406067]
[241.07484436 199.60499573]
[245.78065491 213.73669434]
[257.22308350 223.43568420]
[268.66552734 233.13467407]
[280.10797119 242.83367920]
[295.48977661 240.01690674]
[309.05789185 247.79125977]
[314.40585327 262.48593140]
[309.00851440 277.16253662]
[295.41436768 284.89123535]
[280.04211426 282.02279663]
[270.15008545 269.91156006]
[270.40899658 254.27612305]
[258.96655273 244.57711792]
[247.52410889 234.87812805]
[236.08166504 225.17913818]
[221.36997986 222.85192871]
[215.84574890 208.02650452]
[204.40330505 198.32751465]
[192.96086121 188.62850952]
[181.51841736 178.92951965]
[170.07597351 169.23052979]
[158.61805725 179.16709900]
[145.77062988 187.22703552]
[131.83821106 193.21928406]
[117.15108490 197.00178528]
[102.05738831 198.48489380]
[86.91492462 197.63343811]
[83.79624939 212.30564880]
[80.67757416 226.97785950]
[77.55889893 241.65007019]
[74.44022369 256.32229614]
[71.32154846 270.99450684]
[68.42271423 285.71173096]
[65.74435425 300.47067261]
[63.06600571 315.22961426]
[60.38764954 329.98855591]
] def
/pairs [
[13 209]
[14 208]
[15 207]
[16 206]
[19 205]
[20 204]
[21 203]
[22 202]
[23 201]
[24 200]
[44 155]
[45 154]
[46 153]
[47 152]
[48 151]
[49 150]
[50 149]
[51 148]
[55 143]
[56 142]
[57 141]
[58 140]
[59 139]
[60 138]
[74 90]
[75 89]
[76 88]
[77 87]
[78 86]
[79 85]
[80 84]
[91 135]
[92 134]
[93 133]
[94 132]
[95 131]
[96 130]
[97 129]
[98 128]
[99 127]
[100 126]
[102 125]
[103 124]
[105 123]
[106 122]
[107 121]
[108 120]
[168 194]
[169 193]
[170 192]
[171 191]
[172 190]
[174 188]
[175 187]
[176 186]
[177 185]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
