%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:42 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (4w29_ax)
} def

/sequence { (\
GGUGAUUAGCUCAGCUGGGAGAGCACCUCCCUUACAAGGAGGGGGUCGGCGGUUCGAUCCCGUCAUCACCCACCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 11 0.003191938 ubox
1 15 0.019923987 ubox
1 16 0.005791154 ubox
1 27 0.008641008 ubox
1 31 0.003255770 ubox
1 67 0.053946164 ubox
1 70 0.928317880 ubox
1 71 0.125548975 ubox
1 73 0.004905823 ubox
1 74 0.335983695 ubox
2 10 0.004258953 ubox
2 15 0.006143883 ubox
2 26 0.008677602 ubox
2 30 0.003260570 ubox
2 35 0.006068758 ubox
2 66 0.054118879 ubox
2 69 0.935554648 ubox
2 70 0.089295362 ubox
2 73 0.336156319 ubox
3 9 0.004235201 ubox
3 13 0.021154243 ubox
3 14 0.004196354 ubox
3 25 0.008690433 ubox
3 34 0.006084205 ubox
3 65 0.054275654 ubox
3 68 0.939620988 ubox
3 72 0.335638268 ubox
4 12 0.022284572 ubox
4 24 0.008569827 ubox
4 29 0.003339709 ubox
4 33 0.006034185 ubox
4 64 0.054279202 ubox
4 67 0.939867368 ubox
4 69 0.005846791 ubox
4 70 0.015271199 ubox
4 71 0.332920242 ubox
5 11 0.021642041 ubox
5 16 0.005034827 ubox
5 28 0.003352252 ubox
5 32 0.005787270 ubox
5 63 0.053758957 ubox
5 66 0.926292632 ubox
6 13 0.005529754 ubox
6 14 0.007597819 ubox
6 18 0.010941872 ubox
6 23 0.006898088 ubox
6 37 0.004253097 ubox
6 38 0.003583932 ubox
6 62 0.051156212 ubox
6 65 0.856306737 ubox
6 68 0.009545093 ubox
7 13 0.013642587 ubox
7 14 0.013525496 ubox
7 17 0.151722399 ubox
7 22 0.007731681 ubox
7 25 0.017016999 ubox
7 34 0.010907642 ubox
7 36 0.005866040 ubox
7 37 0.006338115 ubox
7 38 0.005756493 ubox
7 41 0.005995099 ubox
7 62 0.009767432 ubox
7 65 0.047121258 ubox
7 68 0.033736230 ubox
8 16 0.850266757 ubox
8 33 0.011116311 ubox
8 63 0.040737472 ubox
8 66 0.005008312 ubox
9 15 0.891781508 ubox
9 16 0.009218260 ubox
9 24 0.218352092 ubox
9 32 0.010405829 ubox
9 35 0.013598761 ubox
9 61 0.003516005 ubox
9 63 0.027756186 ubox
9 64 0.008606609 ubox
9 66 0.004369906 ubox
9 67 0.007663902 ubox
9 69 0.004306729 ubox
9 70 0.003709349 ubox
10 14 0.885497441 ubox
10 17 0.008818772 ubox
10 19 0.011484984 ubox
10 21 0.013536793 ubox
10 23 0.218582413 ubox
10 38 0.234950607 ubox
10 39 0.010858112 ubox
10 41 0.070616799 ubox
10 62 0.028581766 ubox
11 18 0.011532547 ubox
11 20 0.013930860 ubox
11 22 0.218530127 ubox
11 34 0.007610568 ubox
11 36 0.015735903 ubox
11 37 0.227453412 ubox
11 38 0.016127345 ubox
11 39 0.004849450 ubox
11 40 0.071115027 ubox
11 57 0.003167352 ubox
12 17 0.012572562 ubox
12 19 0.014111190 ubox
12 21 0.218483285 ubox
12 38 0.031845433 ubox
12 39 0.071080219 ubox
12 41 0.005581052 ubox
12 56 0.003210249 ubox
12 62 0.003592082 ubox
13 32 0.007682304 ubox
13 33 0.024784861 ubox
13 54 0.003184501 ubox
14 24 0.033925753 ubox
14 31 0.004283879 ubox
14 32 0.021730352 ubox
14 33 0.030730967 ubox
14 35 0.067412539 ubox
14 53 0.003267676 ubox
14 63 0.004037081 ubox
14 64 0.004737184 ubox
15 19 0.012775426 ubox
15 23 0.033961257 ubox
15 38 0.050615039 ubox
15 39 0.003374463 ubox
15 52 0.003274794 ubox
15 62 0.004258343 ubox
16 22 0.033794224 ubox
16 34 0.018207288 ubox
16 36 0.011009742 ubox
16 37 0.050513845 ubox
16 38 0.005401889 ubox
16 51 0.003266297 ubox
16 62 0.006136725 ubox
16 72 0.004015928 ubox
17 27 0.004569975 ubox
17 28 0.004640349 ubox
17 30 0.004725075 ubox
17 31 0.959980248 ubox
17 32 0.038876331 ubox
17 33 0.009609509 ubox
17 35 0.007873071 ubox
17 50 0.003235779 ubox
17 61 0.010616626 ubox
17 71 0.004762075 ubox
18 24 0.004097874 ubox
18 26 0.005063692 ubox
18 27 0.006777423 ubox
18 29 0.004171919 ubox
18 30 0.973067231 ubox
18 31 0.053628870 ubox
18 32 0.011952106 ubox
18 60 0.010654715 ubox
18 70 0.005326200 ubox
19 26 0.006863760 ubox
19 29 0.973208290 ubox
19 30 0.052924606 ubox
19 31 0.012404359 ubox
19 59 0.010651760 ubox
19 69 0.005312668 ubox
20 28 0.972997766 ubox
20 32 0.003458329 ubox
20 58 0.010192690 ubox
21 26 0.035080814 ubox
21 27 0.970560658 ubox
21 29 0.053860361 ubox
21 31 0.003370021 ubox
21 47 0.011262440 ubox
21 55 0.010085083 ubox
21 67 0.004980011 ubox
22 28 0.053928135 ubox
22 46 0.011200547 ubox
22 54 0.010121379 ubox
22 66 0.004859145 ubox
23 27 0.052964226 ubox
23 47 0.007338223 ubox
23 53 0.010033528 ubox
23 63 0.003484669 ubox
24 44 0.010668054 ubox
24 45 0.003242413 ubox
24 52 0.009970662 ubox
24 62 0.003765717 ubox
25 46 0.092335793 ubox
25 63 0.005801882 ubox
26 39 0.014430031 ubox
26 41 0.007318589 ubox
26 42 0.120993330 ubox
26 43 0.007257935 ubox
26 44 0.018735317 ubox
26 45 0.098405401 ubox
26 49 0.006771097 ubox
26 62 0.006094388 ubox
27 38 0.022430350 ubox
27 41 0.183574067 ubox
27 42 0.007338673 ubox
27 43 0.018934361 ubox
27 44 0.098155249 ubox
27 45 0.054590480 ubox
27 48 0.006427538 ubox
28 37 0.022217006 ubox
28 40 0.184052574 ubox
28 41 0.007313298 ubox
28 42 0.018967327 ubox
28 43 0.046394691 ubox
28 44 0.055672699 ubox
28 45 0.005873273 ubox
29 38 0.006156722 ubox
29 39 0.181009931 ubox
29 41 0.021456331 ubox
29 42 0.045775620 ubox
29 43 0.103349084 ubox
29 44 0.007567657 ubox
30 38 0.177658610 ubox
30 39 0.046579143 ubox
30 41 0.044872581 ubox
30 42 0.103693090 ubox
30 43 0.007607971 ubox
31 38 0.094339134 ubox
31 39 0.043503259 ubox
31 41 0.105013523 ubox
31 42 0.007626365 ubox
32 36 0.039665437 ubox
32 37 0.099511865 ubox
32 38 0.066839777 ubox
32 39 0.009899858 ubox
32 40 0.105386777 ubox
32 41 0.009591222 ubox
32 65 0.003617360 ubox
32 68 0.004356715 ubox
33 37 0.056739019 ubox
33 38 0.047130018 ubox
33 39 0.103367177 ubox
33 40 0.009650142 ubox
33 41 0.003311712 ubox
33 65 0.004991196 ubox
33 68 0.007624767 ubox
35 39 0.005682714 ubox
35 41 0.013924370 ubox
36 66 0.025178187 ubox
37 66 0.048524672 ubox
38 64 0.060289862 ubox
38 66 0.032040016 ubox
38 67 0.035373707 ubox
38 69 0.011967379 ubox
38 70 0.015285459 ubox
38 74 0.016780106 ubox
39 63 0.037594646 ubox
39 64 0.967212472 ubox
39 66 0.009399126 ubox
39 67 0.005342789 ubox
39 69 0.012760703 ubox
39 73 0.016763308 ubox
40 63 0.967795609 ubox
40 66 0.004507210 ubox
41 61 0.019677096 ubox
41 63 0.005593807 ubox
41 64 0.007409358 ubox
41 71 0.016700286 ubox
41 74 0.008555537 ubox
42 60 0.017111240 ubox
42 61 0.985270471 ubox
42 70 0.017809450 ubox
42 71 0.006476290 ubox
42 73 0.008564347 ubox
43 59 0.014064365 ubox
43 60 0.989774398 ubox
43 61 0.058136211 ubox
43 69 0.018598553 ubox
43 70 0.029987424 ubox
43 71 0.033524883 ubox
44 58 0.009976112 ubox
44 59 0.989843709 ubox
44 60 0.057801552 ubox
44 67 0.020623950 ubox
44 69 0.030016654 ubox
44 70 0.040949147 ubox
45 58 0.989287305 ubox
45 59 0.057390746 ubox
45 64 0.005394534 ubox
45 66 0.020932640 ubox
45 67 0.029550387 ubox
45 69 0.041044047 ubox
46 57 0.991452042 ubox
46 65 0.021146494 ubox
46 68 0.040633035 ubox
47 56 0.991629196 ubox
47 62 0.011101122 ubox
48 53 0.004232632 ubox
48 54 0.006506900 ubox
48 55 0.987238126 ubox
48 61 0.011414321 ubox
48 64 0.126921635 ubox
48 70 0.005937570 ubox
49 53 0.021801583 ubox
49 54 0.698009212 ubox
49 55 0.011219024 ubox
49 60 0.011383395 ubox
49 63 0.127518620 ubox
49 64 0.003506990 ubox
49 69 0.005946540 ubox
50 62 0.127656200 ubox
51 55 0.003263789 ubox
51 59 0.011066748 ubox
51 60 0.015420790 ubox
51 61 0.126734376 ubox
51 67 0.005931128 ubox
52 58 0.010721200 ubox
52 59 0.021677342 ubox
52 60 0.125465784 ubox
52 66 0.005900612 ubox
53 57 0.010822096 ubox
53 65 0.005777787 ubox
55 62 0.005628463 ubox
56 61 0.005565057 ubox
62 67 0.016486231 ubox
62 69 0.022830908 ubox
62 70 0.005332178 ubox
63 68 0.020944407 ubox
1 70 0.9500000 lbox
2 69 0.9500000 lbox
3 68 0.9500000 lbox
4 67 0.9500000 lbox
5 66 0.9500000 lbox
6 65 0.9500000 lbox
8 16 0.9500000 lbox
9 15 0.9500000 lbox
10 14 0.9500000 lbox
17 31 0.9500000 lbox
18 30 0.9500000 lbox
19 29 0.9500000 lbox
20 28 0.9500000 lbox
21 27 0.9500000 lbox
39 64 0.9500000 lbox
40 63 0.9500000 lbox
42 61 0.9500000 lbox
43 60 0.9500000 lbox
44 59 0.9500000 lbox
45 58 0.9500000 lbox
46 57 0.9500000 lbox
47 56 0.9500000 lbox
48 55 0.9500000 lbox
showpage
end
%%EOF
