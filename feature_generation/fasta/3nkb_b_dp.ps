%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:37 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (3nkb_b)
} def

/sequence { (\
GGUCCGCAGCCUCCUCGCGGCGCAAGCUGGGCAACAUUCCGAAAGGUAAUGGCGAAUGCGGACC\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 63 0.006093221 ubox
1 64 0.988122618 ubox
2 63 0.999875150 ubox
2 64 0.003166820 ubox
3 62 0.999855925 ubox
4 61 0.999992579 ubox
5 60 0.999978065 ubox
6 23 0.005240696 ubox
6 59 0.999911841 ubox
7 22 0.005236147 ubox
7 58 0.999727480 ubox
8 15 0.023973716 ubox
8 28 0.005197467 ubox
8 57 0.960607146 ubox
9 13 0.017287921 ubox
9 14 0.034904047 ubox
9 15 0.006568794 ubox
9 16 0.013704266 ubox
9 18 0.066665477 ubox
9 21 0.067905068 ubox
9 23 0.012626491 ubox
9 27 0.006117401 ubox
9 32 0.500517607 ubox
9 47 0.031108108 ubox
9 53 0.626623834 ubox
9 57 0.010784004 ubox
9 59 0.003188161 ubox
10 17 0.068647432 ubox
10 19 0.003594152 ubox
10 20 0.068101465 ubox
10 22 0.012321316 ubox
10 26 0.006072505 ubox
10 30 0.031380452 ubox
10 31 0.500864325 ubox
10 46 0.031247839 ubox
10 51 0.003825446 ubox
10 52 0.626635938 ubox
10 54 0.097243122 ubox
10 58 0.003471618 ubox
11 17 0.015677722 ubox
11 19 0.068226023 ubox
11 20 0.006879621 ubox
11 22 0.006178546 ubox
11 29 0.033221613 ubox
11 30 0.499366090 ubox
11 31 0.020108045 ubox
11 45 0.031252729 ubox
11 51 0.579351825 ubox
11 52 0.058925069 ubox
11 54 0.436770990 ubox
12 17 0.011350263 ubox
12 19 0.006691031 ubox
12 20 0.004104569 ubox
12 29 0.328611626 ubox
12 30 0.019809349 ubox
12 31 0.049805377 ubox
12 33 0.062502976 ubox
12 34 0.030183417 ubox
12 36 0.013254186 ubox
12 42 0.008160290 ubox
12 44 0.030067440 ubox
12 45 0.003831283 ubox
12 46 0.014218543 ubox
12 48 0.183052951 ubox
12 49 0.146006453 ubox
12 51 0.027990315 ubox
12 52 0.032971569 ubox
12 54 0.020578925 ubox
12 55 0.146868812 ubox
12 56 0.054478625 ubox
13 17 0.033778313 ubox
13 19 0.009647194 ubox
13 20 0.030880577 ubox
13 22 0.003382709 ubox
13 26 0.011587944 ubox
13 29 0.094413979 ubox
13 30 0.081508012 ubox
13 31 0.148630349 ubox
13 41 0.008603422 ubox
13 45 0.014180247 ubox
13 46 0.445897187 ubox
13 51 0.015327283 ubox
13 52 0.335449396 ubox
13 54 0.151114234 ubox
14 19 0.033301317 ubox
14 20 0.003464853 ubox
14 26 0.148306029 ubox
14 29 0.082909784 ubox
14 30 0.152311377 ubox
14 31 0.081142880 ubox
14 41 0.004033935 ubox
14 45 0.447757700 ubox
14 46 0.038334423 ubox
14 51 0.282195132 ubox
14 52 0.086073289 ubox
14 54 0.028100586 ubox
15 19 0.003498633 ubox
15 24 0.010058818 ubox
15 25 0.147214842 ubox
15 26 0.006054126 ubox
15 29 0.122440958 ubox
15 30 0.068550215 ubox
15 31 0.160387436 ubox
15 33 0.168051466 ubox
15 34 0.030807113 ubox
15 36 0.009736836 ubox
15 41 0.005152827 ubox
15 42 0.062045419 ubox
15 43 0.015662511 ubox
15 44 0.440397799 ubox
15 45 0.036678020 ubox
15 46 0.017111646 ubox
15 48 0.009483403 ubox
15 49 0.024094674 ubox
15 51 0.018269543 ubox
15 52 0.022699643 ubox
15 55 0.186010474 ubox
15 56 0.019579533 ubox
16 22 0.016536127 ubox
16 26 0.014006777 ubox
16 29 0.065261664 ubox
16 30 0.245571938 ubox
16 31 0.608200874 ubox
16 41 0.077471897 ubox
16 45 0.017722216 ubox
16 46 0.020662874 ubox
16 51 0.010527348 ubox
16 52 0.014120897 ubox
16 54 0.203285108 ubox
17 21 0.015660642 ubox
17 23 0.153328130 ubox
17 27 0.158880479 ubox
17 28 0.029343598 ubox
17 32 0.079405099 ubox
17 35 0.072359543 ubox
17 39 0.004726167 ubox
17 40 0.074104183 ubox
17 47 0.018107775 ubox
17 50 0.006120500 ubox
17 53 0.204838731 ubox
18 22 0.152431780 ubox
18 26 0.159122287 ubox
18 29 0.803486715 ubox
18 30 0.016268363 ubox
18 31 0.076157040 ubox
18 41 0.367223981 ubox
18 45 0.008403024 ubox
18 46 0.018289104 ubox
18 52 0.202929237 ubox
18 54 0.006710963 ubox
19 23 0.005891854 ubox
19 27 0.008449334 ubox
19 28 0.872614606 ubox
19 32 0.024825203 ubox
19 35 0.008702817 ubox
19 37 0.007632171 ubox
19 38 0.009799405 ubox
19 39 0.021399295 ubox
19 40 0.361492182 ubox
19 53 0.006730673 ubox
20 27 0.876877270 ubox
20 32 0.251224751 ubox
20 35 0.004300412 ubox
20 37 0.003317934 ubox
20 38 0.008357808 ubox
20 39 0.331965373 ubox
20 47 0.008591827 ubox
20 50 0.013121671 ubox
20 53 0.003212331 ubox
21 26 0.876829653 ubox
21 29 0.015405066 ubox
21 30 0.038575897 ubox
21 31 0.281759238 ubox
21 41 0.005721754 ubox
21 46 0.008695461 ubox
21 52 0.003263540 ubox
21 54 0.007585779 ubox
22 27 0.010512270 ubox
22 28 0.012433140 ubox
22 32 0.106233465 ubox
22 35 0.064233558 ubox
22 37 0.090273782 ubox
22 38 0.023687823 ubox
22 39 0.003296861 ubox
22 40 0.005685500 ubox
22 47 0.017272968 ubox
22 53 0.013506097 ubox
23 29 0.280821872 ubox
23 30 0.030163793 ubox
23 31 0.106151490 ubox
23 45 0.005181023 ubox
23 46 0.017566960 ubox
23 52 0.013467661 ubox
24 28 0.227656551 ubox
24 37 0.027290655 ubox
24 38 0.046694084 ubox
25 37 0.044677912 ubox
25 38 0.055853676 ubox
26 32 0.252123723 ubox
26 35 0.037842238 ubox
26 37 0.056563442 ubox
26 38 0.035925485 ubox
26 47 0.006433847 ubox
26 53 0.007714077 ubox
26 59 0.004393721 ubox
27 31 0.250653857 ubox
27 41 0.006287200 ubox
27 45 0.004259960 ubox
27 46 0.006548139 ubox
27 52 0.007719639 ubox
27 58 0.004401149 ubox
28 33 0.008986352 ubox
28 34 0.019312051 ubox
28 36 0.103126745 ubox
28 41 0.029845868 ubox
28 42 0.006276207 ubox
28 44 0.003735109 ubox
28 45 0.005796010 ubox
28 51 0.004892299 ubox
28 55 0.007541664 ubox
28 56 0.006852020 ubox
29 35 0.106132196 ubox
29 37 0.003638222 ubox
29 38 0.010967955 ubox
29 39 0.006939509 ubox
29 40 0.081332463 ubox
29 50 0.003262726 ubox
29 57 0.004046126 ubox
30 35 0.079487017 ubox
30 37 0.012716001 ubox
30 38 0.009208732 ubox
30 39 0.083517635 ubox
30 40 0.063091489 ubox
30 47 0.003601401 ubox
30 53 0.028303623 ubox
31 35 0.014817580 ubox
31 37 0.008485266 ubox
31 38 0.065964605 ubox
31 39 0.062927276 ubox
31 40 0.008432262 ubox
31 47 0.009624703 ubox
31 53 0.214347170 ubox
32 41 0.028957445 ubox
32 45 0.007695016 ubox
32 46 0.010675623 ubox
32 51 0.030917715 ubox
32 52 0.214851284 ubox
32 54 0.131456784 ubox
33 37 0.017317215 ubox
33 38 0.027862026 ubox
33 47 0.005340560 ubox
33 50 0.031548850 ubox
34 38 0.007733073 ubox
34 47 0.031253822 ubox
34 50 0.028635999 ubox
35 41 0.021966584 ubox
35 45 0.012695654 ubox
35 46 0.031136578 ubox
35 51 0.754496842 ubox
35 52 0.021581849 ubox
35 54 0.004957419 ubox
35 58 0.005751847 ubox
36 47 0.022349621 ubox
36 50 0.824003906 ubox
36 57 0.013006435 ubox
37 42 0.004843234 ubox
37 43 0.010722691 ubox
37 44 0.018038033 ubox
37 45 0.008345988 ubox
37 46 0.017641453 ubox
37 48 0.078984754 ubox
37 49 0.830410233 ubox
37 55 0.004973045 ubox
37 56 0.015994671 ubox
38 42 0.009729227 ubox
38 43 0.018585563 ubox
38 44 0.008893554 ubox
38 45 0.015169912 ubox
38 46 0.014698800 ubox
38 48 0.809177207 ubox
38 49 0.014581500 ubox
38 54 0.005256637 ubox
38 55 0.017085053 ubox
39 45 0.019564057 ubox
39 46 0.882165689 ubox
39 52 0.015665023 ubox
39 54 0.016125807 ubox
40 45 0.882798726 ubox
40 46 0.074546376 ubox
40 51 0.015965006 ubox
40 52 0.014159525 ubox
40 54 0.014863784 ubox
41 47 0.003230082 ubox
41 50 0.014014043 ubox
41 53 0.015970443 ubox
42 47 0.004289952 ubox
42 50 0.010127674 ubox
43 50 0.005411882 ubox
44 50 0.016610449 ubox
45 50 0.004797539 ubox
45 53 0.003586236 ubox
46 53 0.011637976 ubox
47 52 0.011424509 ubox
49 57 0.004380545 ubox
50 55 0.003686550 ubox
50 56 0.005216758 ubox
52 57 0.007180926 ubox
52 59 0.009800088 ubox
53 58 0.009992076 ubox
1 64 0.9500000 lbox
2 63 0.9500000 lbox
3 62 0.9500000 lbox
4 61 0.9500000 lbox
5 60 0.9500000 lbox
6 59 0.9500000 lbox
7 58 0.9500000 lbox
8 57 0.9500000 lbox
9 32 0.9500000 lbox
10 31 0.9500000 lbox
11 30 0.9500000 lbox
18 29 0.9500000 lbox
19 28 0.9500000 lbox
20 27 0.9500000 lbox
21 26 0.9500000 lbox
35 51 0.9500000 lbox
36 50 0.9500000 lbox
37 49 0.9500000 lbox
38 48 0.9500000 lbox
39 46 0.9500000 lbox
40 45 0.9500000 lbox
showpage
end
%%EOF
