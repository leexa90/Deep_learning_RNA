%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:39 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (4p5j_a)
} def

/sequence { (\
AGCUCGCCAGUUAGCGAGGUCUGUCUCGACACGACAGAUAAUCGGGUGCAACUCCCGCCCCUCUUCCGAGGGUCAUCGGAACC\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 12 0.007733484 ubox
1 20 0.066154247 ubox
1 42 0.004280438 ubox
1 62 0.045462773 ubox
1 64 0.029303515 ubox
1 73 0.006088408 ubox
1 76 0.006613671 ubox
2 11 0.009083966 ubox
2 15 0.023744956 ubox
2 20 0.018024630 ubox
2 42 0.005920086 ubox
2 43 0.019749682 ubox
2 49 0.007875794 ubox
2 52 0.003815689 ubox
2 58 0.026438089 ubox
2 59 0.010116352 ubox
2 60 0.010156167 ubox
2 61 0.051062650 ubox
2 62 0.012286841 ubox
2 63 0.041691438 ubox
2 64 0.007003992 ubox
2 73 0.008523818 ubox
2 74 0.033439327 ubox
2 76 0.008794590 ubox
2 77 0.032210745 ubox
2 82 0.111893144 ubox
2 83 0.042283871 ubox
3 10 0.009183618 ubox
3 14 0.023780063 ubox
3 18 0.994842971 ubox
3 19 0.016198852 ubox
3 48 0.007408117 ubox
3 57 0.013348229 ubox
3 78 0.006173969 ubox
3 79 0.005384528 ubox
4 9 0.008395825 ubox
4 13 0.023189814 ubox
4 17 0.998880326 ubox
4 18 0.007295706 ubox
4 50 0.003221777 ubox
4 78 0.003426387 ubox
5 10 0.009331483 ubox
5 16 0.999459806 ubox
5 48 0.008587264 ubox
6 11 0.004563652 ubox
6 15 0.999510675 ubox
6 47 0.010603241 ubox
7 14 0.996086061 ubox
7 46 0.010758364 ubox
8 14 0.053720395 ubox
8 45 0.010752041 ubox
10 49 0.005448487 ubox
10 82 0.004515109 ubox
11 48 0.005407181 ubox
11 81 0.004490049 ubox
12 80 0.004313151 ubox
15 44 0.013094528 ubox
15 78 0.005654999 ubox
16 43 0.022241423 ubox
16 63 0.018380310 ubox
16 77 0.005830600 ubox
17 42 0.022249765 ubox
17 62 0.018568902 ubox
17 76 0.005553848 ubox
18 39 0.003959309 ubox
18 42 0.003206702 ubox
18 43 0.010560241 ubox
18 61 0.018715316 ubox
18 63 0.003570253 ubox
18 74 0.004601302 ubox
18 77 0.003486125 ubox
18 82 0.007479898 ubox
18 83 0.011444408 ubox
19 30 0.005734304 ubox
19 35 0.015296558 ubox
19 39 0.970449219 ubox
19 42 0.011421392 ubox
19 43 0.023638279 ubox
19 58 0.003581680 ubox
19 60 0.012510578 ubox
19 61 0.003670384 ubox
19 63 0.003942896 ubox
19 74 0.004024686 ubox
19 77 0.004913888 ubox
19 82 0.018906379 ubox
19 83 0.005117461 ubox
20 29 0.005744376 ubox
20 34 0.015320467 ubox
20 38 0.992858510 ubox
20 41 0.006750225 ubox
20 81 0.011445679 ubox
21 28 0.005740590 ubox
21 33 0.015309584 ubox
21 37 0.999730610 ubox
22 31 0.014685403 ubox
22 36 0.999550897 ubox
22 40 0.008714431 ubox
22 50 0.003970574 ubox
23 30 0.014779487 ubox
23 32 0.003835463 ubox
23 35 0.999765130 ubox
23 39 0.009169476 ubox
23 49 0.004215777 ubox
24 29 0.013672054 ubox
24 31 0.003686146 ubox
24 33 0.004397911 ubox
24 34 0.998483790 ubox
24 38 0.009231076 ubox
24 48 0.004088335 ubox
25 33 0.997063139 ubox
25 37 0.009227576 ubox
25 46 0.004290941 ubox
26 31 0.119968644 ubox
26 33 0.010673227 ubox
26 34 0.045362979 ubox
26 36 0.007359290 ubox
26 45 0.004296310 ubox
27 33 0.061020542 ubox
27 44 0.004302843 ubox
28 32 0.078372637 ubox
28 35 0.004852584 ubox
28 43 0.004303409 ubox
29 42 0.004093913 ubox
36 64 0.005559338 ubox
37 43 0.003533235 ubox
37 63 0.007178553 ubox
38 42 0.003301292 ubox
38 62 0.007368002 ubox
40 62 0.024782148 ubox
40 64 0.016915873 ubox
40 65 0.016946029 ubox
41 62 0.030735589 ubox
41 64 0.034263187 ubox
41 65 0.006006875 ubox
41 76 0.005423897 ubox
42 57 0.006386108 ubox
42 75 0.005368767 ubox
42 79 0.009077430 ubox
42 80 0.056091730 ubox
42 81 0.004475745 ubox
43 57 0.413490854 ubox
43 78 0.013840146 ubox
43 79 0.059858925 ubox
44 49 0.011165545 ubox
44 52 0.009331291 ubox
44 53 0.019745857 ubox
44 54 0.081913858 ubox
44 55 0.022250684 ubox
44 56 0.447964218 ubox
44 58 0.004496534 ubox
44 59 0.005395402 ubox
44 60 0.600983527 ubox
44 61 0.641554344 ubox
44 62 0.077942166 ubox
44 63 0.030916756 ubox
44 77 0.008856639 ubox
44 83 0.008032406 ubox
45 52 0.023163566 ubox
45 53 0.082659036 ubox
45 54 0.023202411 ubox
45 55 0.448040038 ubox
45 56 0.013368774 ubox
45 58 0.005044774 ubox
45 59 0.603252934 ubox
45 60 0.641420243 ubox
45 61 0.087504298 ubox
45 62 0.013800325 ubox
45 76 0.004649397 ubox
45 77 0.055089324 ubox
45 82 0.007642474 ubox
45 83 0.039769207 ubox
46 52 0.083853084 ubox
46 53 0.016813360 ubox
46 54 0.447502323 ubox
46 55 0.013426976 ubox
46 58 0.604271449 ubox
46 59 0.640401592 ubox
46 60 0.087382469 ubox
46 61 0.013552310 ubox
46 76 0.055176089 ubox
46 82 0.040293721 ubox
47 51 0.076004594 ubox
47 57 0.604612693 ubox
47 75 0.055219711 ubox
47 81 0.040073521 ubox
48 52 0.194284921 ubox
48 53 0.028396490 ubox
48 54 0.015802976 ubox
48 55 0.045594720 ubox
48 56 0.594699176 ubox
48 58 0.645118446 ubox
48 59 0.005659791 ubox
48 74 0.054406427 ubox
49 57 0.644882268 ubox
49 72 0.003672180 ubox
49 79 0.005073257 ubox
50 73 0.016216670 ubox
51 73 0.007530851 ubox
52 57 0.007114669 ubox
52 72 0.007077588 ubox
52 78 0.004845256 ubox
52 79 0.004454062 ubox
53 71 0.006052886 ubox
53 78 0.004339818 ubox
53 80 0.056395657 ubox
53 81 0.005072664 ubox
54 70 0.005998035 ubox
54 79 0.058187101 ubox
55 78 0.057751715 ubox
55 79 0.090292308 ubox
56 68 0.006460868 ubox
56 78 0.091015130 ubox
57 61 0.003237085 ubox
57 63 0.003798618 ubox
57 67 0.006291387 ubox
57 73 0.052137400 ubox
57 74 0.114934953 ubox
57 76 0.011753621 ubox
57 77 0.089418368 ubox
58 72 0.056781602 ubox
58 78 0.017375635 ubox
58 79 0.016618659 ubox
59 71 0.047328988 ubox
59 72 0.378371835 ubox
59 78 0.011970829 ubox
60 70 0.035296506 ubox
60 71 0.381799740 ubox
61 68 0.014008917 ubox
61 70 0.383264839 ubox
61 72 0.004917345 ubox
62 69 0.384433971 ubox
62 71 0.004975655 ubox
62 80 0.004484338 ubox
62 81 0.017655792 ubox
63 68 0.383727712 ubox
63 70 0.005208628 ubox
64 69 0.004837865 ubox
64 80 0.022057076 ubox
64 81 0.773721315 ubox
65 79 0.003164755 ubox
65 80 0.909133631 ubox
65 81 0.017156308 ubox
66 79 0.922807254 ubox
67 78 0.922863220 ubox
68 77 0.922787619 ubox
69 76 0.910047729 ubox
70 74 0.086507266 ubox
70 76 0.013379147 ubox
70 77 0.005321013 ubox
70 83 0.004044786 ubox
71 76 0.008057816 ubox
71 82 0.004337503 ubox
71 83 0.009489195 ubox
72 77 0.005701956 ubox
72 82 0.012502405 ubox
73 78 0.004934267 ubox
73 79 0.018618561 ubox
73 80 0.099175875 ubox
73 81 0.011067357 ubox
74 78 0.023008779 ubox
74 79 0.106187872 ubox
76 80 0.003760477 ubox
76 81 0.004776366 ubox
78 82 0.010531573 ubox
78 83 0.015739949 ubox
79 83 0.004373836 ubox
3 18 0.9500000 lbox
4 17 0.9500000 lbox
5 16 0.9500000 lbox
6 15 0.9500000 lbox
7 14 0.9500000 lbox
19 39 0.9500000 lbox
20 38 0.9500000 lbox
21 37 0.9500000 lbox
22 36 0.9500000 lbox
23 35 0.9500000 lbox
24 34 0.9500000 lbox
25 33 0.9500000 lbox
44 61 0.9500000 lbox
45 60 0.9500000 lbox
46 59 0.9500000 lbox
48 58 0.9500000 lbox
49 57 0.9500000 lbox
64 81 0.9500000 lbox
65 80 0.9500000 lbox
66 79 0.9500000 lbox
67 78 0.9500000 lbox
68 77 0.9500000 lbox
69 76 0.9500000 lbox
showpage
end
%%EOF
