%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:27 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (2nr0_e)
} def

/sequence { (\
CGAGGUGGUGGAAUUGGUAGACACGCUACCUUGAGGUGGUAGUGCCCAAUAGGGCUUACGGGUUCAAGUCCCGUCCUCGG\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 33 0.033743538 ubox
1 79 0.982046370 ubox
1 80 0.015813862 ubox
2 32 0.074809637 ubox
2 78 0.995870288 ubox
3 31 0.085771226 ubox
3 77 0.995776167 ubox
4 30 0.089280321 ubox
4 75 0.010292905 ubox
4 76 0.995808639 ubox
5 24 0.017886825 ubox
5 29 0.093144238 ubox
5 72 0.003857488 ubox
5 74 0.013648801 ubox
5 75 0.994233043 ubox
5 76 0.006245561 ubox
5 78 0.003618081 ubox
6 12 0.003290797 ubox
6 13 0.003906354 ubox
6 19 0.004599075 ubox
6 23 0.019238561 ubox
6 25 0.003856675 ubox
6 28 0.094337826 ubox
6 73 0.820919793 ubox
7 15 0.004387352 ubox
7 18 0.005016730 ubox
7 22 0.019501944 ubox
7 24 0.011543067 ubox
7 26 0.004076673 ubox
7 27 0.094706341 ubox
7 30 0.019755493 ubox
7 56 0.009538246 ubox
7 69 0.003557281 ubox
7 70 0.006610126 ubox
7 71 0.131076689 ubox
7 72 0.846959122 ubox
7 74 0.104672432 ubox
7 75 0.018889996 ubox
7 76 0.008229184 ubox
8 14 0.005678822 ubox
8 15 0.004470803 ubox
8 22 0.015028643 ubox
8 24 0.160440327 ubox
8 26 0.094964902 ubox
8 29 0.027545524 ubox
8 55 0.010315446 ubox
8 69 0.006351470 ubox
8 70 0.137419831 ubox
8 71 0.826425464 ubox
8 72 0.327416336 ubox
8 74 0.051338352 ubox
8 75 0.009003995 ubox
9 13 0.008997186 ubox
9 16 0.009567675 ubox
9 19 0.006326110 ubox
9 21 0.015208169 ubox
9 23 0.160880313 ubox
9 25 0.094969727 ubox
9 28 0.030710184 ubox
9 54 0.010278474 ubox
9 66 0.056027234 ubox
9 67 0.067282851 ubox
9 68 0.065835728 ubox
9 73 0.170189493 ubox
10 14 0.006739090 ubox
10 15 0.017338026 ubox
10 18 0.006758131 ubox
10 22 0.160951136 ubox
10 24 0.094910811 ubox
10 26 0.003614201 ubox
10 27 0.031511923 ubox
10 29 0.004369072 ubox
10 30 0.011867244 ubox
10 65 0.046616762 ubox
10 69 0.104802478 ubox
10 70 0.637521203 ubox
10 71 0.471513533 ubox
10 72 0.185812319 ubox
11 15 0.012162381 ubox
11 18 0.006441202 ubox
11 22 0.028619396 ubox
11 24 0.006239547 ubox
11 26 0.031600519 ubox
11 29 0.013879101 ubox
11 31 0.004028011 ubox
11 32 0.006214690 ubox
11 64 0.033292459 ubox
11 65 0.349193304 ubox
11 69 0.491003854 ubox
11 70 0.503174953 ubox
11 71 0.184243301 ubox
11 72 0.005598313 ubox
12 18 0.006368083 ubox
12 31 0.009441738 ubox
12 32 0.013768225 ubox
12 63 0.025143411 ubox
12 64 0.351922243 ubox
12 69 0.468670775 ubox
13 18 0.009437961 ubox
13 27 0.005277000 ubox
13 31 0.016471668 ubox
13 32 0.014749973 ubox
13 50 0.011404490 ubox
13 63 0.352689822 ubox
13 69 0.127447216 ubox
14 19 0.048846997 ubox
14 20 0.013154640 ubox
14 21 0.033701974 ubox
14 23 0.012558504 ubox
14 28 0.005264974 ubox
14 49 0.011963417 ubox
14 61 0.008413670 ubox
14 62 0.353128706 ubox
14 66 0.008515927 ubox
14 67 0.067003961 ubox
14 68 0.151363976 ubox
15 19 0.011410171 ubox
15 20 0.034070674 ubox
15 21 0.010690662 ubox
15 23 0.054955056 ubox
15 25 0.016486373 ubox
15 28 0.108164087 ubox
15 48 0.012094969 ubox
15 60 0.009440318 ubox
15 61 0.349962280 ubox
15 66 0.048729936 ubox
15 67 0.110760921 ubox
15 68 0.020435079 ubox
16 22 0.060414938 ubox
16 24 0.022135753 ubox
16 26 0.010787074 ubox
16 27 0.120126084 ubox
16 29 0.014826435 ubox
16 30 0.832999011 ubox
16 31 0.003732785 ubox
16 47 0.012085151 ubox
16 59 0.010068736 ubox
16 65 0.021610699 ubox
16 70 0.006523123 ubox
17 22 0.010017757 ubox
17 24 0.024997863 ubox
17 26 0.121342020 ubox
17 29 0.904273113 ubox
17 30 0.003485365 ubox
17 46 0.011993674 ubox
17 59 0.353567257 ubox
17 64 0.015731118 ubox
18 23 0.023485394 ubox
18 25 0.118143868 ubox
18 28 0.904601703 ubox
18 58 0.353063579 ubox
19 27 0.904522433 ubox
19 56 0.031970273 ubox
19 57 0.347057631 ubox
19 63 0.005024473 ubox
20 24 0.020213494 ubox
20 26 0.902281623 ubox
20 27 0.004319563 ubox
20 29 0.003788616 ubox
20 45 0.010192853 ubox
20 55 0.042261565 ubox
20 56 0.294477406 ubox
20 57 0.015765104 ubox
20 64 0.009935128 ubox
20 70 0.003166732 ubox
21 40 0.005168953 ubox
21 43 0.086825819 ubox
21 56 0.019543093 ubox
21 63 0.012613401 ubox
21 69 0.003166825 ubox
22 38 0.005414211 ubox
22 39 0.005237411 ubox
22 42 0.088873072 ubox
22 44 0.071560968 ubox
22 54 0.008098741 ubox
22 60 0.007583663 ubox
22 61 0.005613756 ubox
22 62 0.012489724 ubox
23 37 0.005460340 ubox
23 40 0.005141440 ubox
23 43 0.129103640 ubox
23 56 0.004303905 ubox
23 74 0.003678528 ubox
24 36 0.005453863 ubox
24 38 0.006162202 ubox
24 39 0.004489291 ubox
24 42 0.133441055 ubox
24 44 0.099830923 ubox
24 60 0.009669954 ubox
24 61 0.005653895 ubox
24 73 0.003863616 ubox
25 29 0.003255074 ubox
25 37 0.006215718 ubox
25 40 0.204552467 ubox
25 43 0.318779160 ubox
25 59 0.007574418 ubox
25 72 0.004070882 ubox
26 35 0.004539041 ubox
26 36 0.006203303 ubox
26 38 0.003498052 ubox
26 39 0.213375240 ubox
26 42 0.327879473 ubox
27 34 0.004430762 ubox
27 35 0.006059640 ubox
27 38 0.213396111 ubox
27 41 0.327932472 ubox
28 37 0.213473528 ubox
28 40 0.327958701 ubox
28 69 0.009689560 ubox
29 36 0.213561480 ubox
29 39 0.328018410 ubox
29 68 0.009734647 ubox
30 35 0.212867228 ubox
30 36 0.003297919 ubox
30 38 0.327921021 ubox
30 39 0.003593272 ubox
30 68 0.376057267 ubox
31 35 0.005500383 ubox
31 36 0.024310637 ubox
31 38 0.004998308 ubox
31 66 0.016944421 ubox
31 67 0.821799284 ubox
31 68 0.031693697 ubox
31 80 0.006583181 ubox
32 36 0.026366336 ubox
32 66 0.901348573 ubox
32 67 0.027502976 ubox
32 68 0.003216668 ubox
32 79 0.028270712 ubox
33 37 0.004456555 ubox
33 65 0.916879535 ubox
33 78 0.067922130 ubox
34 64 0.916402609 ubox
34 77 0.070148698 ubox
35 46 0.004117850 ubox
35 63 0.912642917 ubox
35 76 0.070415554 ubox
35 78 0.006481956 ubox
36 45 0.004130593 ubox
36 75 0.069835922 ubox
36 77 0.006051578 ubox
36 78 0.008574522 ubox
37 44 0.004091949 ubox
37 60 0.005023787 ubox
37 61 0.911994976 ubox
37 73 0.014830557 ubox
38 43 0.004818627 ubox
38 59 0.005419389 ubox
38 72 0.011155098 ubox
38 74 0.005192436 ubox
38 76 0.011885355 ubox
39 59 0.917973977 ubox
39 71 0.004345238 ubox
39 75 0.011747859 ubox
40 58 0.917735586 ubox
41 56 0.009317668 ubox
41 57 0.914620971 ubox
42 55 0.007644812 ubox
42 56 0.847327454 ubox
42 57 0.037024830 ubox
42 59 0.005552893 ubox
43 54 0.005470060 ubox
43 58 0.005337726 ubox
44 55 0.991867494 ubox
45 52 0.004507513 ubox
45 53 0.009751568 ubox
45 54 0.999726198 ubox
46 52 0.009923566 ubox
46 53 0.999811930 ubox
46 54 0.006057929 ubox
47 52 0.998368392 ubox
47 53 0.006661333 ubox
52 65 0.004224265 ubox
52 71 0.003382551 ubox
53 64 0.004238239 ubox
53 70 0.003957288 ubox
54 63 0.004305445 ubox
54 69 0.003988642 ubox
55 62 0.004549964 ubox
55 68 0.004145194 ubox
56 61 0.004249431 ubox
56 67 0.004150718 ubox
57 66 0.004059363 ubox
58 74 0.162301105 ubox
59 73 0.175924095 ubox
60 71 0.011135813 ubox
60 72 0.181886988 ubox
61 70 0.011267135 ubox
61 71 0.181944695 ubox
61 72 0.003195981 ubox
62 69 0.008794276 ubox
62 70 0.181757448 ubox
62 71 0.003247626 ubox
63 67 0.003900209 ubox
63 68 0.027835161 ubox
64 68 0.015709467 ubox
70 80 0.003783746 ubox
71 79 0.003375952 ubox
71 80 0.047423511 ubox
72 79 0.048261109 ubox
73 78 0.047777315 ubox
75 80 0.003376487 ubox
1 79 0.9500000 lbox
2 78 0.9500000 lbox
3 77 0.9500000 lbox
4 76 0.9500000 lbox
5 75 0.9500000 lbox
6 73 0.9500000 lbox
7 72 0.9500000 lbox
8 71 0.9500000 lbox
10 70 0.9500000 lbox
11 69 0.9500000 lbox
16 30 0.9500000 lbox
17 29 0.9500000 lbox
18 28 0.9500000 lbox
19 27 0.9500000 lbox
20 26 0.9500000 lbox
31 67 0.9500000 lbox
32 66 0.9500000 lbox
33 65 0.9500000 lbox
34 64 0.9500000 lbox
35 63 0.9500000 lbox
37 61 0.9500000 lbox
39 59 0.9500000 lbox
40 58 0.9500000 lbox
41 57 0.9500000 lbox
42 56 0.9500000 lbox
44 55 0.9500000 lbox
45 54 0.9500000 lbox
46 53 0.9500000 lbox
47 52 0.9500000 lbox
showpage
end
%%EOF
