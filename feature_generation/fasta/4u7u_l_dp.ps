%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:41 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (4u7u_l)
} def

/sequence { (\
UAAACCGGGCUCCCUGUCGGUUGUAAUUGAUAAUGUUGAGAGUUCCCCGCGCCAGCGGGG\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 7 0.006019132 ubox
1 8 0.005881169 ubox
1 23 0.087782329 ubox
1 25 0.164489882 ubox
1 26 0.023815020 ubox
1 29 0.028039165 ubox
1 32 0.014458867 ubox
1 35 0.007712410 ubox
1 38 0.010952781 ubox
1 39 0.004326301 ubox
1 40 0.003599746 ubox
1 41 0.004003627 ubox
1 42 0.003176392 ubox
2 22 0.080476549 ubox
2 24 0.160236664 ubox
2 27 0.009887671 ubox
2 28 0.030568292 ubox
2 31 0.015141156 ubox
2 34 0.008497908 ubox
2 37 0.011719584 ubox
2 43 0.005375317 ubox
2 44 0.009026690 ubox
3 21 0.058033055 ubox
3 22 0.750395194 ubox
3 24 0.015336923 ubox
3 27 0.022012430 ubox
3 28 0.004710996 ubox
3 36 0.008494858 ubox
3 37 0.013802052 ubox
3 43 0.008819242 ubox
3 44 0.060947231 ubox
4 17 0.010992081 ubox
4 21 0.796875112 ubox
4 22 0.019660067 ubox
4 24 0.011373952 ubox
4 36 0.014552871 ubox
4 43 0.067495052 ubox
4 44 0.005924225 ubox
5 9 0.003252494 ubox
5 16 0.011529007 ubox
5 19 0.005547624 ubox
5 20 0.805086130 ubox
5 23 0.011410201 ubox
5 35 0.014554420 ubox
5 38 0.004237087 ubox
5 40 0.027875776 ubox
5 42 0.068048834 ubox
5 59 0.003213063 ubox
5 60 0.015578527 ubox
6 16 0.043746898 ubox
6 19 0.804495001 ubox
6 20 0.031430874 ubox
6 23 0.003524525 ubox
6 29 0.006604835 ubox
6 38 0.021405210 ubox
6 40 0.055383313 ubox
6 42 0.012026152 ubox
6 59 0.013982996 ubox
6 60 0.009938677 ubox
7 12 0.005153630 ubox
7 13 0.026621973 ubox
7 14 0.063177398 ubox
7 15 0.061470344 ubox
7 17 0.003230780 ubox
7 18 0.724596296 ubox
7 22 0.003552625 ubox
7 28 0.006364043 ubox
7 37 0.018280649 ubox
7 43 0.011714557 ubox
7 44 0.019958500 ubox
7 45 0.441533028 ubox
7 46 0.020776614 ubox
8 12 0.026396150 ubox
8 13 0.064009840 ubox
8 14 0.098370382 ubox
8 15 0.039918016 ubox
8 17 0.622544687 ubox
8 18 0.348226776 ubox
8 21 0.003285683 ubox
8 27 0.005288353 ubox
8 36 0.015088538 ubox
8 37 0.061470372 ubox
8 43 0.018770047 ubox
8 44 0.532297672 ubox
8 45 0.027282030 ubox
9 13 0.097529658 ubox
9 14 0.048543923 ubox
9 15 0.019978263 ubox
9 17 0.490758502 ubox
9 18 0.003516430 ubox
9 24 0.013546677 ubox
9 36 0.067845336 ubox
9 37 0.006574695 ubox
9 43 0.569562654 ubox
9 44 0.021459465 ubox
9 45 0.003414013 ubox
10 16 0.601496507 ubox
10 19 0.003184103 ubox
10 23 0.013823452 ubox
10 35 0.068850514 ubox
10 38 0.014625632 ubox
10 40 0.073783767 ubox
10 42 0.573042021 ubox
11 16 0.010309582 ubox
11 33 0.008821837 ubox
11 39 0.074500106 ubox
11 41 0.572838428 ubox
12 16 0.011926855 ubox
12 20 0.004582977 ubox
12 35 0.030333950 ubox
12 38 0.074500825 ubox
12 40 0.571047688 ubox
12 42 0.003492448 ubox
13 19 0.005006050 ubox
13 20 0.022082310 ubox
13 35 0.106746135 ubox
13 38 0.263286252 ubox
13 40 0.022300202 ubox
13 42 0.003888779 ubox
14 19 0.022275631 ubox
14 35 0.138129659 ubox
14 38 0.448428263 ubox
14 40 0.023856209 ubox
14 42 0.049240878 ubox
15 32 0.522552254 ubox
15 33 0.046329078 ubox
15 35 0.031906456 ubox
15 38 0.021702531 ubox
15 39 0.034884455 ubox
15 41 0.050415060 ubox
16 31 0.543841587 ubox
16 34 0.024987310 ubox
16 36 0.056058793 ubox
16 37 0.025506935 ubox
17 30 0.546951561 ubox
17 32 0.003696899 ubox
17 33 0.022625298 ubox
17 35 0.021225168 ubox
17 38 0.003194914 ubox
17 39 0.090243781 ubox
17 41 0.004053926 ubox
18 29 0.547292169 ubox
18 35 0.084833870 ubox
18 38 0.090966046 ubox
18 40 0.004359139 ubox
19 27 0.006808919 ubox
19 28 0.543529276 ubox
19 31 0.003217999 ubox
19 34 0.063990697 ubox
19 36 0.006477214 ubox
19 37 0.081434563 ubox
19 43 0.007096207 ubox
20 27 0.524684843 ubox
20 28 0.007133772 ubox
20 31 0.075638001 ubox
20 34 0.189471205 ubox
20 36 0.042902760 ubox
21 25 0.015655458 ubox
21 26 0.495633655 ubox
21 29 0.003628610 ubox
21 30 0.076950023 ubox
21 32 0.006268827 ubox
21 33 0.202928843 ubox
21 35 0.014132981 ubox
21 39 0.005529857 ubox
21 40 0.006633282 ubox
21 41 0.020498329 ubox
21 42 0.006718009 ubox
22 26 0.016736742 ubox
22 29 0.076021162 ubox
22 30 0.012665078 ubox
22 32 0.208248814 ubox
22 33 0.008301254 ubox
22 35 0.014370359 ubox
22 38 0.007711198 ubox
22 39 0.014890293 ubox
22 40 0.029673544 ubox
22 41 0.017088125 ubox
22 42 0.007089526 ubox
23 27 0.006568434 ubox
23 28 0.062052332 ubox
23 31 0.211972655 ubox
23 34 0.050378031 ubox
23 36 0.010507774 ubox
23 37 0.013837974 ubox
23 43 0.025434326 ubox
23 44 0.020151367 ubox
23 45 0.019844797 ubox
24 29 0.013463894 ubox
24 30 0.208955068 ubox
24 32 0.037098276 ubox
24 33 0.051614841 ubox
24 35 0.028343922 ubox
24 38 0.207073099 ubox
24 39 0.018973803 ubox
24 40 0.010997176 ubox
24 41 0.021969946 ubox
24 42 0.055195290 ubox
25 31 0.037831167 ubox
25 34 0.030775354 ubox
25 36 0.012092060 ubox
25 37 0.227286907 ubox
25 43 0.012661177 ubox
25 44 0.130472915 ubox
26 31 0.014377132 ubox
26 34 0.060071395 ubox
26 36 0.230641381 ubox
26 37 0.018300973 ubox
26 43 0.150339149 ubox
26 44 0.010996973 ubox
27 32 0.022534479 ubox
27 33 0.061471425 ubox
27 35 0.228684787 ubox
27 38 0.007381257 ubox
27 39 0.176398222 ubox
27 40 0.061785697 ubox
27 41 0.051021313 ubox
27 42 0.150753908 ubox
28 32 0.052265113 ubox
28 33 0.053330158 ubox
28 35 0.019799658 ubox
28 38 0.188227167 ubox
28 39 0.090097851 ubox
28 40 0.054397378 ubox
28 41 0.147768647 ubox
28 42 0.013257882 ubox
29 34 0.012840509 ubox
29 36 0.012525595 ubox
29 37 0.202302284 ubox
29 43 0.005625567 ubox
29 44 0.099721065 ubox
29 45 0.026923110 ubox
30 34 0.012103524 ubox
30 36 0.202520103 ubox
30 37 0.097777544 ubox
30 43 0.107708112 ubox
30 44 0.028308997 ubox
31 35 0.187628672 ubox
31 38 0.087026299 ubox
31 39 0.019317738 ubox
31 40 0.014433127 ubox
31 41 0.009113816 ubox
31 42 0.107288264 ubox
32 36 0.013115845 ubox
32 37 0.083440497 ubox
32 43 0.008422935 ubox
32 44 0.073362420 ubox
33 37 0.018356167 ubox
33 43 0.084276056 ubox
33 44 0.012222026 ubox
34 38 0.006641410 ubox
34 39 0.099527667 ubox
34 40 0.022551644 ubox
34 41 0.043183790 ubox
34 42 0.084176138 ubox
35 43 0.007597485 ubox
35 44 0.019219525 ubox
35 45 0.005937895 ubox
36 40 0.012340142 ubox
36 41 0.013444813 ubox
36 42 0.014482361 ubox
37 41 0.014415961 ubox
37 42 0.018036689 ubox
38 43 0.009793581 ubox
38 44 0.020201609 ubox
38 45 0.034524437 ubox
39 43 0.018740786 ubox
39 44 0.035230542 ubox
40 44 0.007588109 ubox
40 45 0.013122942 ubox
44 60 0.012390587 ubox
45 59 0.018409428 ubox
45 60 0.875244992 ubox
46 58 0.015239640 ubox
46 59 0.998861261 ubox
46 60 0.014781431 ubox
47 57 0.010845619 ubox
47 58 0.999785430 ubox
47 59 0.012480657 ubox
48 57 0.999872319 ubox
48 58 0.009123662 ubox
49 56 0.999956517 ubox
50 55 0.999578566 ubox
50 57 0.003753378 ubox
51 56 0.003683431 ubox
3 22 0.9500000 lbox
4 21 0.9500000 lbox
5 20 0.9500000 lbox
6 19 0.9500000 lbox
7 18 0.9500000 lbox
8 17 0.9500000 lbox
45 60 0.9500000 lbox
46 59 0.9500000 lbox
47 58 0.9500000 lbox
48 57 0.9500000 lbox
49 56 0.9500000 lbox
50 55 0.9500000 lbox
showpage
end
%%EOF
