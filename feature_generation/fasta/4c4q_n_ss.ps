%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:38 2017
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
ACUAGCCGUAGUGGCGAGCUCCCUGGGUGGUCUAAGUCCUGAGUACAGGACAGUCGUCAGUAGUUCGACGUGAGCACUAGCCCACCUCGAGAUGCUACGUGGACGAGGGCAUGCCCAAGACACACCUUAACCCUGGCGGGGGUCGCUAGGGUGAAAUCACAUUAUGUGAUGGGGGUACGACCUGAUAGGGUGCUGCAGAGGCCCACUAGCAGGCUAGUAUAAAAAUCUCUGC\
) def
/coor [
[104.91516876 338.86944580]
[102.10047913 324.13589478]
[99.28578186 309.40234375]
[96.47109222 294.66879272]
[93.65640259 279.93524170]
[90.84170532 265.20169067]
[88.02701569 250.46813965]
[85.11306000 235.75390625]
[82.09996796 221.05964661]
[78.98789215 206.38603210]
[75.77695465 191.73373413]
[72.56602478 177.08143616]
[69.35508728 162.42912292]
[66.14415741 147.77682495]
[87.69198608 94.13097382]
[80.16281128 81.15747833]
[66.54389954 73.10541534]
[66.84749603 58.21390533]
[59.31832504 45.24040985]
[51.78915405 32.26691818]
[44.25997925 19.29342270]
[36.73080826 6.31992817]
[29.20163345 -6.65356588]
[-15.70797062 -7.05948782]
[-23.94358253 -39.80994797]
[-37.25781250 -46.71873093]
[-50.57204437 -53.62751389]
[-63.88627243 -60.53629303]
[-77.20050049 -67.44507599]
[-90.56100464 -74.26393890]
[-103.96717834 -80.99258423]
[-117.37334442 -87.72122192]
[-130.77951050 -94.44986725]
[-144.56439209 -86.41225433]
[-160.30996704 -87.18651581]
[-172.92791748 -96.31233215]
[-186.75689697 -90.50208282]
[-200.58589172 -84.69183350]
[-214.41488647 -78.88159180]
[-228.24388123 -73.07134247]
[-242.07287598 -67.26109314]
[-251.55380249 -53.88035965]
[-267.85501099 -55.66992188]
[-274.20721436 -70.78883362]
[-264.07580566 -83.68405151]
[-247.88311768 -81.09008789]
[-234.05412292 -86.90032959]
[-220.22512817 -92.71057892]
[-206.39614868 -98.52082825]
[-192.56715393 -104.33107758]
[-178.73815918 -110.14132690]
[-181.32942200 -114.47184753]
[-183.17216492 -119.52782440]
[-184.10487366 -125.17269135]
[-196.59794617 -133.47468567]
[-209.09101868 -141.77668762]
[-221.58409119 -150.07867432]
[-234.07716370 -158.38067627]
[-254.24211121 -158.75456238]
[-262.04672241 -176.45530701]
[-274.75909424 -184.41743469]
[-287.47146606 -192.37956238]
[-300.18386841 -200.34167480]
[-312.89624023 -208.30380249]
[-325.76702881 -216.00721741]
[-338.79098511 -223.44874573]
[-351.81494141 -230.89028931]
[-364.83889771 -238.33183289]
[-380.65960693 -238.46011353]
[-387.87173462 -251.49217224]
[-400.89569092 -258.93371582]
[-413.91964722 -266.37524414]
[-429.74032593 -266.50354004]
[-436.95245361 -279.53558350]
[-449.97640991 -286.97714233]
[-466.36404419 -286.36239624]
[-474.85995483 -300.38919067]
[-466.72430420 -314.62799072]
[-450.32632446 -314.43109131]
[-442.53488159 -300.00109863]
[-429.51092529 -292.55953979]
[-414.62179565 -292.96353149]
[-406.47808838 -279.39920044]
[-393.45413208 -271.95767212]
[-380.43017578 -264.51611328]
[-365.54107666 -264.92010498]
[-357.39736938 -251.35578918]
[-344.37341309 -243.91424561]
[-331.34945679 -236.47271729]
[-318.32550049 -229.03117371]
[-314.85916138 -229.59260559]
[-310.94906616 -228.51252747]
[-307.36538696 -225.60073853]
[-304.93411255 -221.01618958]
[-292.22174072 -213.05406189]
[-279.50933838 -205.09193420]
[-266.79696655 -197.12980652]
[-254.08459473 -189.16767883]
[-244.39064026 -192.33898926]
[-234.33786011 -189.60131836]
[-227.30003357 -181.62376404]
[-225.77516174 -170.87374878]
[-213.28208923 -162.57174683]
[-200.78901672 -154.26976013]
[-188.29594421 -145.96775818]
[-175.80287170 -137.66577148]
[-163.09049988 -145.62788391]
[-165.10685730 -160.49174500]
[-167.12322998 -175.35560608]
[-177.57998657 -187.98841858]
[-171.61517334 -203.26431274]
[-155.36486816 -205.46876526]
[-145.54598999 -192.33401489]
[-152.25936890 -177.37196350]
[-150.24301147 -162.50810242]
[-148.22663879 -147.64425659]
[-126.52138519 -131.98350525]
[-124.05088043 -107.85603333]
[-110.64470673 -101.12739563]
[-97.23854065 -94.39875031]
[-83.83236694 -87.67011261]
[-76.45574951 -87.47911072]
[-70.29172516 -80.75930786]
[-56.97749329 -73.85052490]
[-43.66326141 -66.94174194]
[-30.34903145 -60.03295898]
[-17.03479958 -53.12417984]
[-12.29632282 -63.75021362]
[-1.67289126 -72.40212250]
[13.72700214 -76.18714142]
[22.93179131 -88.03078461]
[32.13657761 -99.87442780]
[41.34136581 -111.71806335]
[50.54615402 -123.56170654]
[59.75094223 -135.40534973]
[68.95573425 -147.24899292]
[78.16052246 -159.09263611]
[87.36531067 -170.93627930]
[86.80433655 -186.96952820]
[99.08309937 -197.29481506]
[114.78238678 -193.99145508]
[121.85903931 -179.59352112]
[114.88446045 -165.14587402]
[99.20895386 -161.73149109]
[90.00416565 -149.88784790]
[80.79937744 -138.04420471]
[71.59458923 -126.20056152]
[62.38979721 -114.35691833]
[53.18500900 -102.51327515]
[43.98022079 -90.66963959]
[34.77543259 -78.82599640]
[25.57064438 -66.98235321]
[29.88856125 -60.85000992]
[44.82797623 -62.19682693]
[38.52439117 -48.58532715]
[42.84230804 -42.45298767]
[57.09560394 -47.12669373]
[71.34889984 -51.80040359]
[85.60219574 -56.47410965]
[99.85549164 -61.14781952]
[114.10878754 -65.82152557]
[127.27552032 -76.50204468]
[141.18356323 -66.80653381]
[135.71707153 -50.75804520]
[118.78249359 -51.56822968]
[104.52919769 -46.89452362]
[90.27590179 -42.22081375]
[76.02260590 -37.54710770]
[61.76931000 -32.87339783]
[47.51601410 -28.19968987]
[42.17512894 -14.18273926]
[49.70429993 -1.20924473]
[57.23347473 11.76424980]
[64.76264954 24.73774338]
[72.29182434 37.71123886]
[79.82099152 50.68473053]
[92.90136719 57.80884552]
[93.13630676 73.62831116]
[100.66548157 86.60179901]
[112.44680023 95.88622284]
[126.82093048 100.17391968]
[141.19506836 104.46161652]
[155.56919861 108.74931335]
[171.38851929 104.42716217]
[182.84930420 116.15672302]
[178.16166687 131.87162781]
[162.14785767 135.40571594]
[151.28150940 123.12344360]
[136.90736389 118.83574677]
[122.53324127 114.54804993]
[108.15910339 110.26036072]
[101.70295715 123.79986572]
[114.08296204 132.26954651]
[126.46296692 140.73922729]
[142.43269348 139.20707703]
[153.48352051 150.83715820]
[151.13821411 166.70785522]
[137.19589233 174.64453125]
[122.35189819 168.55885315]
[117.99328613 153.11923218]
[105.61328125 144.64955139]
[93.23327637 136.17987061]
[80.79645538 144.56590271]
[84.00739288 159.21820068]
[87.21832275 173.87049866]
[90.42926025 188.52279663]
[93.64019012 203.17509460]
[98.52700806 210.87379456]
[96.79422760 218.04655457]
[99.80731964 232.74081421]
[104.58988953 240.50471497]
[102.76056671 247.65345764]
[105.57525635 262.38699341]
[108.38994598 277.12054443]
[111.20464325 291.85409546]
[114.01933289 306.58764648]
[116.83403015 321.32119751]
[119.64871979 336.05474854]
[134.58424377 338.75561523]
[147.53349304 346.67276001]
[156.74520874 358.73547363]
[160.97357178 373.31234741]
[159.64672852 388.43200684]
[152.94412231 402.04962158]
[141.77221680 412.32351685]
[127.64195251 417.86425781]
[112.46430206 417.92248535]
[98.29193115 412.49035645]
[87.04152679 402.30245972]
[80.23461914 388.73669434]
[78.79179382 373.62765503]
[82.90817261 359.01876831]
] def
/pairs [
[1 218]
[2 217]
[3 216]
[4 215]
[5 214]
[6 213]
[7 212]
[8 210]
[9 209]
[10 207]
[11 206]
[12 205]
[13 204]
[14 203]
[15 179]
[16 178]
[18 176]
[19 175]
[20 174]
[21 173]
[22 172]
[23 171]
[25 127]
[26 126]
[27 125]
[28 124]
[29 123]
[30 121]
[31 120]
[32 119]
[33 118]
[36 51]
[37 50]
[38 49]
[39 48]
[40 47]
[41 46]
[54 106]
[55 105]
[56 104]
[57 103]
[58 102]
[60 98]
[61 97]
[62 96]
[63 95]
[64 94]
[65 90]
[66 89]
[67 88]
[68 87]
[70 85]
[71 84]
[72 83]
[74 81]
[75 80]
[107 116]
[108 115]
[109 114]
[130 152]
[131 151]
[132 150]
[133 149]
[134 148]
[135 147]
[136 146]
[137 145]
[138 144]
[156 170]
[157 169]
[158 168]
[159 167]
[160 166]
[161 165]
[180 191]
[181 190]
[182 189]
[183 188]
[192 202]
[193 201]
[194 200]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
