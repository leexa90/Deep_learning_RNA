%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:26 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (1f7u_b)
} def

/sequence { (\
UCCUCGUGGCCCAAUGGUCACGGCGUCUGGCUICGAACCAGAAGAUUCCAGGUUCAAGUCCUGGCGGGGAAGCCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 23 0.007067746 ubox
1 25 0.017361286 ubox
1 45 0.013479698 ubox
1 67 0.006111055 ubox
1 68 0.088478338 ubox
1 69 0.169357272 ubox
1 70 0.675573019 ubox
1 71 0.031407401 ubox
1 72 0.005773761 ubox
1 75 0.005163428 ubox
2 22 0.005871860 ubox
2 23 0.041531954 ubox
2 25 0.125055502 ubox
2 30 0.006921803 ubox
2 44 0.014620083 ubox
2 52 0.008924838 ubox
2 66 0.013560566 ubox
2 67 0.119701589 ubox
2 68 0.216300215 ubox
2 69 0.722628701 ubox
2 72 0.003780404 ubox
3 22 0.037773065 ubox
3 23 0.143759873 ubox
3 25 0.099086741 ubox
3 29 0.007124032 ubox
3 44 0.011559227 ubox
3 51 0.008997136 ubox
3 58 0.004750745 ubox
3 66 0.120067877 ubox
3 67 0.216867332 ubox
3 68 0.722341273 ubox
3 69 0.024890145 ubox
3 72 0.008083905 ubox
4 22 0.024191828 ubox
4 23 0.549764981 ubox
4 25 0.005274208 ubox
4 43 0.010296730 ubox
4 50 0.007827837 ubox
4 57 0.004482445 ubox
4 66 0.141419129 ubox
4 67 0.662298800 ubox
4 68 0.024093999 ubox
4 70 0.003859894 ubox
4 71 0.007188334 ubox
4 75 0.003303224 ubox
5 22 0.910082835 ubox
5 23 0.015432306 ubox
5 66 0.392047828 ubox
5 67 0.035056818 ubox
5 69 0.003955326 ubox
6 21 0.992446475 ubox
6 24 0.004867673 ubox
6 65 0.119566224 ubox
7 20 0.997236696 ubox
7 23 0.004089004 ubox
7 64 0.038550919 ubox
8 19 0.999627431 ubox
8 32 0.004520840 ubox
9 18 0.999373955 ubox
9 19 0.003247070 ubox
9 24 0.021493278 ubox
9 31 0.004873412 ubox
10 17 0.999294390 ubox
10 23 0.021510636 ubox
10 30 0.004856486 ubox
11 16 0.994420370 ubox
11 17 0.028560584 ubox
11 22 0.021397471 ubox
11 23 0.003187622 ubox
11 29 0.004830351 ubox
12 16 0.039866900 ubox
12 22 0.003496031 ubox
14 26 0.004778944 ubox
15 25 0.004827508 ubox
15 40 0.004738880 ubox
16 21 0.007222222 ubox
16 24 0.004830247 ubox
16 39 0.005077459 ubox
17 38 0.005077662 ubox
18 37 0.003993213 ubox
19 35 0.004350749 ubox
21 25 0.006296464 ubox
21 44 0.004613591 ubox
21 63 0.004422298 ubox
22 27 0.003583765 ubox
22 31 0.003732997 ubox
22 32 0.031506571 ubox
22 39 0.004836233 ubox
22 46 0.066031228 ubox
22 47 0.051273418 ubox
22 48 0.018016873 ubox
22 49 0.011561264 ubox
22 62 0.004618737 ubox
22 65 0.018552546 ubox
22 74 0.060783324 ubox
23 27 0.004981871 ubox
23 31 0.045002238 ubox
23 38 0.004815135 ubox
23 46 0.067694991 ubox
23 47 0.023727064 ubox
23 48 0.013429231 ubox
23 61 0.005966897 ubox
23 65 0.071932437 ubox
23 73 0.063889929 ubox
23 74 0.003390672 ubox
24 29 0.005140871 ubox
24 30 0.045131072 ubox
24 35 0.004464772 ubox
24 44 0.357927892 ubox
24 63 0.017325680 ubox
24 64 0.071152916 ubox
24 66 0.754000603 ubox
24 67 0.015416910 ubox
24 68 0.003414163 ubox
24 72 0.063453821 ubox
25 31 0.004579009 ubox
25 34 0.004859871 ubox
25 46 0.022531505 ubox
25 47 0.008006038 ubox
25 48 0.004179700 ubox
25 61 0.015538271 ubox
25 62 0.017603206 ubox
25 65 0.774712254 ubox
26 30 0.004290800 ubox
26 36 0.003338904 ubox
26 42 0.534829841 ubox
26 43 0.022830343 ubox
26 44 0.004022190 ubox
26 45 0.020475425 ubox
26 52 0.005167842 ubox
26 63 0.012122148 ubox
26 64 0.772860148 ubox
26 68 0.006019889 ubox
26 69 0.036391095 ubox
26 70 0.019658013 ubox
27 35 0.003524367 ubox
27 41 0.569647022 ubox
27 44 0.019044693 ubox
27 51 0.006837111 ubox
27 63 0.767360783 ubox
27 64 0.029854120 ubox
27 67 0.007130921 ubox
27 68 0.039850540 ubox
27 69 0.019661719 ubox
28 40 0.569788941 ubox
28 43 0.015887746 ubox
28 50 0.006902238 ubox
28 63 0.028318880 ubox
28 66 0.007177205 ubox
28 67 0.040245446 ubox
28 68 0.017962299 ubox
28 75 0.144660151 ubox
29 34 0.004579345 ubox
29 38 0.008579498 ubox
29 39 0.569986773 ubox
29 49 0.006920460 ubox
29 60 0.538387124 ubox
29 61 0.582053216 ubox
29 62 0.015954400 ubox
29 65 0.006562142 ubox
29 74 0.189891475 ubox
30 38 0.568698952 ubox
30 48 0.006897990 ubox
30 59 0.544071724 ubox
30 60 0.580419087 ubox
30 61 0.015631878 ubox
30 65 0.041249926 ubox
30 73 0.189976775 ubox
31 35 0.038081172 ubox
31 41 0.007642191 ubox
31 44 0.007257072 ubox
31 58 0.758106411 ubox
31 63 0.005638676 ubox
31 64 0.040980270 ubox
31 72 0.189926814 ubox
32 36 0.092542018 ubox
32 37 0.100283970 ubox
32 40 0.007401043 ubox
32 43 0.007281757 ubox
32 56 0.028033736 ubox
32 57 0.734780058 ubox
32 58 0.079360450 ubox
32 63 0.038145737 ubox
32 70 0.004733605 ubox
32 71 0.180564626 ubox
34 41 0.013759972 ubox
34 44 0.005933236 ubox
34 58 0.028917339 ubox
34 66 0.007909644 ubox
34 67 0.005210125 ubox
34 68 0.009420355 ubox
34 69 0.057106650 ubox
35 48 0.011410680 ubox
35 54 0.011563593 ubox
35 55 0.814382939 ubox
35 60 0.010442433 ubox
35 65 0.008126605 ubox
36 47 0.011807785 ubox
36 53 0.008489908 ubox
36 54 0.815772143 ubox
36 59 0.009138206 ubox
37 46 0.011407266 ubox
37 53 0.816048941 ubox
37 59 0.005456235 ubox
38 44 0.005270719 ubox
38 51 0.005656559 ubox
38 52 0.816472649 ubox
38 58 0.006820190 ubox
38 64 0.020421982 ubox
38 66 0.006512987 ubox
38 67 0.048036042 ubox
38 68 0.057733045 ubox
38 69 0.017207082 ubox
39 44 0.011623909 ubox
39 51 0.815441858 ubox
39 63 0.020466565 ubox
39 66 0.047986199 ubox
39 67 0.057633141 ubox
39 68 0.017270874 ubox
40 46 0.027475163 ubox
40 47 0.034834415 ubox
40 62 0.020444085 ubox
41 46 0.022587669 ubox
41 47 0.072237673 ubox
41 48 0.542385309 ubox
41 49 0.376888981 ubox
41 55 0.008187425 ubox
41 60 0.003958768 ubox
41 61 0.019866981 ubox
41 65 0.045697607 ubox
42 46 0.064172089 ubox
42 47 0.513317290 ubox
42 54 0.008167755 ubox
42 59 0.005516135 ubox
43 47 0.054214276 ubox
43 53 0.007900622 ubox
43 59 0.003522723 ubox
44 48 0.033167078 ubox
44 49 0.048664649 ubox
44 54 0.003349561 ubox
44 55 0.014193495 ubox
44 60 0.019278290 ubox
44 65 0.065334404 ubox
44 73 0.007464471 ubox
44 74 0.005410010 ubox
45 53 0.003832710 ubox
45 54 0.014130948 ubox
45 59 0.019411048 ubox
46 50 0.005003244 ubox
46 52 0.003990141 ubox
46 58 0.019186360 ubox
46 66 0.091381447 ubox
46 67 0.027001020 ubox
46 68 0.006760057 ubox
46 69 0.003432446 ubox
46 70 0.008005296 ubox
46 71 0.015251431 ubox
47 56 0.003316215 ubox
47 57 0.017059510 ubox
47 64 0.006539861 ubox
47 66 0.057285559 ubox
47 67 0.012194093 ubox
47 68 0.005134291 ubox
47 69 0.008534172 ubox
47 70 0.017667566 ubox
48 63 0.006531204 ubox
48 64 0.563830762 ubox
48 66 0.007007850 ubox
48 67 0.004759508 ubox
48 68 0.006230355 ubox
48 69 0.017451978 ubox
49 63 0.573032867 ubox
49 66 0.004223996 ubox
49 67 0.005848664 ubox
49 68 0.017225816 ubox
50 54 0.003371055 ubox
50 62 0.574034888 ubox
51 60 0.004755419 ubox
51 61 0.574394147 ubox
51 74 0.042812286 ubox
52 59 0.004801755 ubox
52 60 0.573803628 ubox
52 65 0.016735990 ubox
52 73 0.042858412 ubox
53 57 0.011563456 ubox
53 58 0.087435945 ubox
53 64 0.014433562 ubox
53 71 0.004293779 ubox
53 72 0.042490393 ubox
54 58 0.049582467 ubox
54 63 0.011117222 ubox
54 64 0.008997653 ubox
54 70 0.005670353 ubox
54 71 0.040742991 ubox
55 63 0.012470941 ubox
55 69 0.006742117 ubox
56 62 0.012084877 ubox
58 65 0.008878518 ubox
59 64 0.008423438 ubox
59 68 0.027930990 ubox
59 69 0.026474321 ubox
59 70 0.157867977 ubox
60 67 0.034913852 ubox
60 68 0.040528789 ubox
60 69 0.168165009 ubox
61 66 0.034949168 ubox
61 67 0.040686402 ubox
61 68 0.168244928 ubox
61 69 0.003784937 ubox
62 66 0.036735575 ubox
62 67 0.165046376 ubox
62 68 0.003806908 ubox
62 75 0.137833573 ubox
63 74 0.184009183 ubox
64 73 0.185411444 ubox
65 69 0.003403014 ubox
65 72 0.185632104 ubox
66 73 0.010417744 ubox
66 74 0.163102886 ubox
67 73 0.164535844 ubox
67 74 0.516612754 ubox
68 73 0.516849797 ubox
68 74 0.111295160 ubox
69 73 0.109823953 ubox
69 74 0.028088687 ubox
1 70 0.9500000 lbox
2 69 0.9500000 lbox
3 68 0.9500000 lbox
4 67 0.9500000 lbox
5 66 0.9500000 lbox
6 21 0.9500000 lbox
7 20 0.9500000 lbox
8 19 0.9500000 lbox
9 18 0.9500000 lbox
10 17 0.9500000 lbox
11 16 0.9500000 lbox
26 42 0.9500000 lbox
27 41 0.9500000 lbox
28 40 0.9500000 lbox
29 39 0.9500000 lbox
30 38 0.9500000 lbox
48 64 0.9500000 lbox
49 63 0.9500000 lbox
50 62 0.9500000 lbox
51 61 0.9500000 lbox
52 60 0.9500000 lbox
showpage
end
%%EOF
