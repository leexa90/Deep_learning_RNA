%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:42 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (4v8d_ab)
} def

/sequence { (\
GGUGGGGUUCCCGAGCGGCCAAAGGGAGCAGACUGUAAAUCUGCCGUCAUCGACUUCGAAGGUUCGAAUCCUUCCCCCACCACCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 81 0.997760859 ubox
1 83 0.003596669 ubox
1 84 0.053997299 ubox
2 80 0.998527247 ubox
2 83 0.053792817 ubox
3 79 0.998372243 ubox
3 82 0.053113348 ubox
4 77 0.015670987 ubox
4 78 0.998486476 ubox
4 81 0.052235580 ubox
5 76 0.022021415 ubox
5 77 0.998380990 ubox
5 78 0.008181355 ubox
5 80 0.051410755 ubox
6 20 0.005752466 ubox
6 74 0.003229644 ubox
6 75 0.026866797 ubox
6 76 0.998093337 ubox
6 77 0.011294911 ubox
6 78 0.045956560 ubox
7 16 0.004141817 ubox
7 19 0.005851235 ubox
7 29 0.253486374 ubox
7 54 0.004838492 ubox
7 57 0.003959859 ubox
7 74 0.018470632 ubox
7 75 0.960816446 ubox
7 76 0.011479827 ubox
7 77 0.044236903 ubox
8 15 0.004368201 ubox
8 18 0.005349389 ubox
8 21 0.004212410 ubox
8 22 0.004261293 ubox
8 23 0.003311738 ubox
8 27 0.046380090 ubox
8 28 0.286585388 ubox
8 30 0.003843006 ubox
8 53 0.005881327 ubox
9 14 0.003881161 ubox
9 17 0.004665261 ubox
9 18 0.006745219 ubox
9 21 0.004549809 ubox
9 22 0.003806359 ubox
9 26 0.032851870 ubox
9 27 0.942751576 ubox
9 52 0.003934657 ubox
9 53 0.013094564 ubox
10 17 0.008827073 ubox
10 18 0.027368124 ubox
10 24 0.003319630 ubox
10 25 0.034675267 ubox
10 26 0.986585195 ubox
10 52 0.013673089 ubox
11 15 0.003499039 ubox
11 17 0.027600308 ubox
11 18 0.048548698 ubox
11 24 0.034347616 ubox
11 25 0.986975006 ubox
11 26 0.019950622 ubox
11 52 0.007375863 ubox
12 17 0.049039037 ubox
12 18 0.010491296 ubox
12 24 0.986744375 ubox
12 25 0.020249721 ubox
12 46 0.004156772 ubox
12 52 0.132273858 ubox
12 58 0.005616449 ubox
12 66 0.007644847 ubox
13 19 0.048034719 ubox
13 20 0.102917644 ubox
13 45 0.004983255 ubox
13 48 0.017462277 ubox
13 51 0.134049357 ubox
13 56 0.012684063 ubox
13 57 0.011665506 ubox
13 65 0.008009101 ubox
13 70 0.011627688 ubox
13 74 0.007377120 ubox
14 47 0.014904995 ubox
14 50 0.130346203 ubox
14 55 0.014460277 ubox
14 56 0.010442622 ubox
14 64 0.007989301 ubox
14 69 0.011545283 ubox
14 73 0.007260896 ubox
15 19 0.069232730 ubox
15 20 0.175520014 ubox
15 29 0.025117060 ubox
15 44 0.006036614 ubox
15 47 0.118164204 ubox
15 48 0.058787263 ubox
15 54 0.015392593 ubox
15 55 0.006840383 ubox
15 63 0.007827155 ubox
15 72 0.006427187 ubox
16 24 0.007129199 ubox
16 25 0.004777443 ubox
16 28 0.025149164 ubox
16 43 0.006045534 ubox
16 46 0.135896197 ubox
16 52 0.015770832 ubox
16 62 0.007799364 ubox
16 66 0.017228464 ubox
17 42 0.006023039 ubox
17 45 0.136000771 ubox
17 48 0.016259658 ubox
17 51 0.015745321 ubox
17 54 0.005032962 ubox
17 55 0.003954696 ubox
17 64 0.004185639 ubox
17 65 0.017105124 ubox
17 71 0.005984965 ubox
18 29 0.003412881 ubox
18 41 0.006001158 ubox
18 44 0.134638242 ubox
18 47 0.016307450 ubox
18 50 0.013683431 ubox
18 54 0.004278435 ubox
18 63 0.012867556 ubox
18 64 0.012130783 ubox
18 70 0.005902301 ubox
19 24 0.004444097 ubox
19 25 0.033673805 ubox
19 26 0.052658282 ubox
19 28 0.003489745 ubox
19 43 0.132829553 ubox
19 46 0.016205622 ubox
19 52 0.003534576 ubox
19 62 0.017609110 ubox
20 24 0.033573013 ubox
20 25 0.052973288 ubox
20 26 0.005119339 ubox
20 35 0.003877502 ubox
20 43 0.015648027 ubox
20 52 0.004304497 ubox
20 61 0.017588698 ubox
21 40 0.008196483 ubox
21 42 0.018899167 ubox
22 40 0.015913406 ubox
22 42 0.007571451 ubox
22 50 0.003569850 ubox
22 56 0.004864255 ubox
22 73 0.008719534 ubox
23 34 0.017099357 ubox
23 36 0.015427347 ubox
23 40 0.010290738 ubox
23 42 0.094563575 ubox
23 47 0.003472533 ubox
23 55 0.005259678 ubox
23 56 0.009631258 ubox
23 72 0.009672499 ubox
23 73 0.011567323 ubox
24 33 0.017376181 ubox
24 34 0.016400093 ubox
24 40 0.007317872 ubox
24 41 0.096420210 ubox
24 42 0.036170191 ubox
24 45 0.006198297 ubox
24 47 0.010502149 ubox
24 48 0.016829703 ubox
24 51 0.003353004 ubox
24 54 0.005238383 ubox
24 55 0.011140001 ubox
24 57 0.004309087 ubox
24 71 0.009769000 ubox
24 72 0.013617238 ubox
24 76 0.003732550 ubox
24 78 0.003881024 ubox
25 33 0.016602141 ubox
25 34 0.020212694 ubox
25 36 0.050659515 ubox
25 40 0.094151269 ubox
25 41 0.036637361 ubox
25 42 0.044208575 ubox
25 44 0.004901974 ubox
25 45 0.006448382 ubox
25 47 0.016636450 ubox
25 48 0.003352998 ubox
25 54 0.011356099 ubox
25 56 0.003798317 ubox
25 57 0.017934441 ubox
25 70 0.009719070 ubox
25 71 0.013894142 ubox
25 75 0.003766007 ubox
25 77 0.003880957 ubox
26 33 0.020283236 ubox
26 36 0.006476918 ubox
26 40 0.035038910 ubox
26 41 0.044779287 ubox
26 44 0.004413106 ubox
26 45 0.037520383 ubox
26 48 0.008083089 ubox
26 51 0.005086063 ubox
26 56 0.018088116 ubox
26 57 0.003487848 ubox
26 69 0.005018421 ubox
26 70 0.013910884 ubox
26 74 0.003773041 ubox
26 76 0.003859258 ubox
27 34 0.057682516 ubox
27 36 0.007579658 ubox
27 40 0.044490777 ubox
27 42 0.003866498 ubox
27 47 0.008259686 ubox
27 50 0.005254989 ubox
27 55 0.019399605 ubox
27 56 0.003506000 ubox
27 69 0.013031478 ubox
27 73 0.003592422 ubox
28 33 0.057402565 ubox
28 34 0.003776376 ubox
28 36 0.107751657 ubox
28 41 0.003813664 ubox
28 44 0.937946912 ubox
28 45 0.052393740 ubox
28 51 0.038321359 ubox
28 54 0.020629419 ubox
29 35 0.109618661 ubox
29 43 0.944483338 ubox
29 52 0.026678139 ubox
30 34 0.088853049 ubox
30 36 0.007574637 ubox
30 42 0.944514513 ubox
30 50 0.026328147 ubox
31 36 0.004995299 ubox
31 41 0.944573736 ubox
31 45 0.004068219 ubox
31 48 0.296979597 ubox
31 51 0.005431722 ubox
31 57 0.003247037 ubox
32 36 0.005298071 ubox
32 40 0.907213455 ubox
32 47 0.297318767 ubox
32 50 0.004810136 ubox
33 43 0.005312491 ubox
33 46 0.296899581 ubox
34 38 0.174207867 ubox
34 39 0.389115698 ubox
34 49 0.003193317 ubox
35 40 0.007919657 ubox
35 41 0.007117799 ubox
35 44 0.297249508 ubox
35 45 0.009487378 ubox
35 48 0.003248524 ubox
35 54 0.003257638 ubox
36 43 0.296075636 ubox
36 53 0.003229663 ubox
37 42 0.270589754 ubox
38 42 0.007116310 ubox
43 54 0.006977803 ubox
43 57 0.009365679 ubox
44 52 0.003375199 ubox
45 52 0.445104266 ubox
45 58 0.017540869 ubox
45 66 0.017159263 ubox
46 50 0.005103358 ubox
46 51 0.445075943 ubox
46 54 0.785326735 ubox
46 55 0.009898550 ubox
46 56 0.006698222 ubox
46 57 0.035062677 ubox
46 63 0.003491266 ubox
46 65 0.017313541 ubox
46 69 0.006670860 ubox
46 70 0.008993495 ubox
46 71 0.014303864 ubox
46 74 0.007855030 ubox
47 52 0.009279261 ubox
47 53 0.786117876 ubox
47 59 0.003511770 ubox
47 62 0.014597555 ubox
47 67 0.004057215 ubox
47 68 0.006745184 ubox
48 52 0.779764938 ubox
48 58 0.004365672 ubox
48 61 0.018628562 ubox
48 62 0.008106874 ubox
48 66 0.004339246 ubox
49 55 0.010339282 ubox
49 56 0.025713265 ubox
49 63 0.005356874 ubox
49 69 0.010481740 ubox
49 72 0.004626131 ubox
49 73 0.018740727 ubox
50 59 0.063405206 ubox
50 62 0.005424198 ubox
50 67 0.077237760 ubox
50 68 0.008031689 ubox
51 58 0.079320581 ubox
51 61 0.005472734 ubox
51 66 0.082766966 ubox
52 56 0.006555662 ubox
52 57 0.117396391 ubox
52 64 0.015553396 ubox
52 65 0.082307051 ubox
52 70 0.104459316 ubox
52 71 0.045543176 ubox
52 73 0.008394039 ubox
52 74 0.015048984 ubox
52 75 0.008593501 ubox
53 63 0.057795850 ubox
53 64 0.060537364 ubox
53 69 0.104562232 ubox
53 72 0.009953779 ubox
53 73 0.014603552 ubox
54 58 0.003573814 ubox
54 61 0.011433838 ubox
54 62 0.080048492 ubox
55 60 0.010961362 ubox
55 61 0.078721878 ubox
55 62 0.010500294 ubox
55 67 0.006624714 ubox
55 68 0.215362157 ubox
56 60 0.060034788 ubox
56 61 0.008962237 ubox
56 62 0.007919595 ubox
56 67 0.240424941 ubox
56 68 0.004255053 ubox
57 61 0.007993235 ubox
57 62 0.013704435 ubox
57 66 0.242982168 ubox
58 65 0.242804687 ubox
58 73 0.005860101 ubox
58 74 0.959723660 ubox
58 75 0.011543772 ubox
59 63 0.005574144 ubox
59 64 0.227032125 ubox
59 72 0.004927753 ubox
59 73 0.962776038 ubox
60 64 0.005450921 ubox
60 72 0.964812367 ubox
60 73 0.007740907 ubox
61 70 0.017612403 ubox
61 71 0.965499130 ubox
61 72 0.008447616 ubox
61 75 0.008567721 ubox
62 69 0.022538973 ubox
62 70 0.964357910 ubox
62 71 0.009035416 ubox
62 74 0.008633943 ubox
63 67 0.019353651 ubox
63 68 0.116762423 ubox
64 68 0.146815523 ubox
66 71 0.005335101 ubox
66 74 0.016278457 ubox
67 73 0.016290367 ubox
68 72 0.012727665 ubox
68 73 0.009523734 ubox
1 81 0.9500000 lbox
2 80 0.9500000 lbox
3 79 0.9500000 lbox
4 78 0.9500000 lbox
5 77 0.9500000 lbox
6 76 0.9500000 lbox
7 75 0.9500000 lbox
9 27 0.9500000 lbox
10 26 0.9500000 lbox
11 25 0.9500000 lbox
12 24 0.9500000 lbox
28 44 0.9500000 lbox
29 43 0.9500000 lbox
30 42 0.9500000 lbox
31 41 0.9500000 lbox
32 40 0.9500000 lbox
46 54 0.9500000 lbox
47 53 0.9500000 lbox
48 52 0.9500000 lbox
58 74 0.9500000 lbox
59 73 0.9500000 lbox
60 72 0.9500000 lbox
61 71 0.9500000 lbox
62 70 0.9500000 lbox
showpage
end
%%EOF
