%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:37 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (3kfu_k)
} def

/sequence { (\
UCCGCGGUAGCUCAGCAGGUAGAGCAGCCGGCUGUUAACCGGUAGGUCGCAGGUUCGAGUCCUGCCCGCGGAGCCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 72 0.935054482 ubox
1 73 0.016200920 ubox
2 71 0.999672151 ubox
3 70 0.999953925 ubox
4 69 0.999963909 ubox
5 68 0.999909307 ubox
6 29 0.012414095 ubox
6 40 0.050137300 ubox
6 66 0.314125376 ubox
6 67 0.947576130 ubox
7 16 0.005927818 ubox
7 28 0.012985970 ubox
7 39 0.052613531 ubox
7 40 0.008089498 ubox
7 65 0.444221884 ubox
7 66 0.889458780 ubox
8 15 0.006017884 ubox
8 17 0.005043328 ubox
8 18 0.003264044 ubox
8 19 0.003500475 ubox
8 21 0.059167292 ubox
8 26 0.073816467 ubox
8 27 0.015456828 ubox
8 34 0.023226265 ubox
8 37 0.098308066 ubox
8 38 0.050048609 ubox
8 44 0.003715660 ubox
8 45 0.003567206 ubox
8 64 0.543644656 ubox
9 20 0.062237808 ubox
9 33 0.026253641 ubox
9 35 0.006177040 ubox
9 36 0.104068002 ubox
9 47 0.007265757 ubox
9 60 0.003920731 ubox
9 63 0.529118328 ubox
10 16 0.051382168 ubox
10 20 0.059252908 ubox
10 25 0.780198916 ubox
10 32 0.026555896 ubox
10 35 0.097132149 ubox
10 36 0.034486099 ubox
10 39 0.004334394 ubox
10 40 0.003239931 ubox
10 43 0.009670154 ubox
10 47 0.025279941 ubox
10 48 0.009054919 ubox
10 60 0.308743561 ubox
10 61 0.142176638 ubox
10 62 0.433434122 ubox
10 63 0.011335215 ubox
10 65 0.006667376 ubox
10 74 0.003447067 ubox
11 15 0.051062906 ubox
11 18 0.064016274 ubox
11 19 0.060765112 ubox
11 22 0.004423770 ubox
11 24 0.781179349 ubox
11 31 0.026498606 ubox
11 34 0.080695543 ubox
11 42 0.009923678 ubox
11 45 0.009779328 ubox
11 46 0.026956778 ubox
11 59 0.550943770 ubox
11 64 0.006028275 ubox
11 73 0.003480362 ubox
12 17 0.058592914 ubox
12 18 0.055045785 ubox
12 19 0.011862086 ubox
12 21 0.004698306 ubox
12 23 0.781075382 ubox
12 30 0.021256467 ubox
12 37 0.012598496 ubox
12 41 0.009818157 ubox
12 44 0.009452699 ubox
12 45 0.025064435 ubox
12 46 0.007615464 ubox
12 57 0.003996778 ubox
12 58 0.554837220 ubox
12 72 0.003486843 ubox
13 18 0.025817964 ubox
13 19 0.006628867 ubox
13 22 0.780942933 ubox
13 27 0.003538948 ubox
13 30 0.015211451 ubox
13 34 0.231120304 ubox
13 45 0.011904609 ubox
13 57 0.554712188 ubox
13 59 0.018847223 ubox
13 71 0.003457128 ubox
14 20 0.119366884 ubox
14 33 0.244609642 ubox
14 36 0.005394631 ubox
14 43 0.016277113 ubox
14 54 0.009791788 ubox
14 55 0.541550740 ubox
15 20 0.038875660 ubox
15 25 0.014851010 ubox
15 28 0.022151867 ubox
15 32 0.246736429 ubox
15 35 0.006177952 ubox
15 43 0.023831543 ubox
15 54 0.553612675 ubox
15 55 0.021977673 ubox
15 56 0.009593371 ubox
15 65 0.079270412 ubox
15 69 0.003468058 ubox
16 22 0.005055310 ubox
16 24 0.014862145 ubox
16 27 0.022161597 ubox
16 30 0.006223596 ubox
16 31 0.245751590 ubox
16 34 0.006237987 ubox
16 41 0.016510020 ubox
16 42 0.024525238 ubox
16 52 0.013209329 ubox
16 53 0.554596773 ubox
16 64 0.079318958 ubox
16 68 0.003476167 ubox
17 33 0.006214437 ubox
17 54 0.003507779 ubox
17 55 0.005237826 ubox
17 63 0.079318139 ubox
18 25 0.016983885 ubox
18 28 0.003724995 ubox
18 29 0.246301420 ubox
18 32 0.005862449 ubox
18 40 0.034139957 ubox
18 50 0.018098444 ubox
18 54 0.005307311 ubox
18 62 0.079334032 ubox
19 25 0.013387573 ubox
19 28 0.247227856 ubox
19 39 0.034218084 ubox
19 50 0.545556960 ubox
19 61 0.079281405 ubox
19 65 0.003205247 ubox
20 24 0.012565593 ubox
20 26 0.006491493 ubox
20 27 0.242482890 ubox
20 30 0.004468069 ubox
20 38 0.033677651 ubox
20 49 0.511208491 ubox
20 51 0.005705939 ubox
20 52 0.004208524 ubox
20 58 0.006876160 ubox
20 59 0.019606851 ubox
20 64 0.003195431 ubox
21 35 0.006575772 ubox
21 36 0.003785070 ubox
21 47 0.004483242 ubox
21 60 0.007502929 ubox
21 63 0.003191276 ubox
22 28 0.003620291 ubox
22 36 0.004583512 ubox
22 47 0.015401122 ubox
22 48 0.558922784 ubox
22 56 0.074120566 ubox
22 62 0.003172023 ubox
23 33 0.008896968 ubox
23 35 0.003878019 ubox
23 36 0.033594100 ubox
23 47 0.557049758 ubox
23 55 0.074047918 ubox
24 32 0.008989159 ubox
24 35 0.034607655 ubox
24 47 0.082319341 ubox
24 48 0.008954954 ubox
24 50 0.020293046 ubox
24 54 0.071385955 ubox
24 56 0.021130044 ubox
24 60 0.005155855 ubox
25 31 0.008972548 ubox
25 34 0.034990553 ubox
25 45 0.537689866 ubox
25 46 0.101821148 ubox
25 49 0.020410391 ubox
25 52 0.003757786 ubox
25 53 0.071251209 ubox
25 57 0.005668872 ubox
25 59 0.005222751 ubox
26 33 0.035378043 ubox
26 36 0.008901353 ubox
26 43 0.035067119 ubox
26 47 0.019950886 ubox
26 55 0.023339720 ubox
27 32 0.035129371 ubox
27 35 0.010230810 ubox
27 43 0.884642670 ubox
27 47 0.290959974 ubox
27 48 0.073601420 ubox
27 50 0.047886089 ubox
27 54 0.024496770 ubox
27 60 0.005622097 ubox
27 65 0.004057736 ubox
28 34 0.010276340 ubox
28 42 0.913382089 ubox
28 45 0.005820154 ubox
28 46 0.310545915 ubox
28 49 0.035358962 ubox
28 53 0.024591489 ubox
28 59 0.005754460 ubox
28 64 0.004057520 ubox
29 41 0.913587757 ubox
29 45 0.310541501 ubox
29 46 0.005378261 ubox
29 49 0.051613363 ubox
29 52 0.023914418 ubox
29 57 0.006882175 ubox
30 39 0.011980993 ubox
30 40 0.913534158 ubox
30 43 0.007130899 ubox
30 47 0.009390916 ubox
30 48 0.061945044 ubox
30 54 0.004757239 ubox
30 56 0.006867586 ubox
30 62 0.003660173 ubox
30 75 0.003841894 ubox
31 39 0.911811894 ubox
31 40 0.003443955 ubox
31 43 0.295986024 ubox
31 47 0.061705786 ubox
31 50 0.021737049 ubox
31 55 0.005505763 ubox
31 61 0.003643369 ubox
31 74 0.004009738 ubox
32 41 0.007664692 ubox
32 42 0.310871782 ubox
32 45 0.014037115 ubox
32 46 0.061074166 ubox
32 49 0.021559943 ubox
32 52 0.022333309 ubox
32 59 0.004088777 ubox
32 73 0.004010528 ubox
33 37 0.134297324 ubox
33 38 0.417811230 ubox
33 41 0.310502391 ubox
33 44 0.016419410 ubox
33 45 0.059254503 ubox
33 49 0.003962804 ubox
33 51 0.024471484 ubox
33 58 0.004002214 ubox
33 72 0.003983751 ubox
34 39 0.018507435 ubox
34 40 0.307224823 ubox
34 43 0.016231593 ubox
34 48 0.016304044 ubox
34 50 0.024636529 ubox
35 42 0.018462609 ubox
35 44 0.010542071 ubox
35 45 0.004723163 ubox
35 49 0.023825007 ubox
36 41 0.016717028 ubox
36 42 0.020978900 ubox
36 44 0.010596154 ubox
36 49 0.005504836 ubox
37 43 0.010758425 ubox
37 47 0.009438431 ubox
37 55 0.005896976 ubox
38 47 0.229860692 ubox
38 54 0.006713339 ubox
39 46 0.243499012 ubox
39 53 0.006793186 ubox
40 45 0.243530801 ubox
40 46 0.005168547 ubox
40 52 0.006771678 ubox
41 48 0.007424400 ubox
41 66 0.057603653 ubox
41 67 0.005122338 ubox
42 47 0.005075494 ubox
42 48 0.006408047 ubox
42 50 0.005828834 ubox
42 65 0.060447596 ubox
42 66 0.003993555 ubox
43 49 0.005741640 ubox
43 64 0.060988811 ubox
44 63 0.064054939 ubox
45 50 0.010878191 ubox
45 60 0.004896028 ubox
45 62 0.064603579 ubox
45 66 0.007618163 ubox
45 67 0.022531839 ubox
46 61 0.064493665 ubox
46 65 0.006767065 ubox
46 66 0.023512940 ubox
47 58 0.035809592 ubox
47 59 0.004145550 ubox
47 64 0.003604597 ubox
48 57 0.037806253 ubox
48 59 0.049181011 ubox
49 56 0.036344623 ubox
49 60 0.011351142 ubox
49 65 0.823445323 ubox
49 66 0.003938401 ubox
50 57 0.041749109 ubox
50 59 0.011837526 ubox
50 64 0.825144388 ubox
51 55 0.005680273 ubox
51 63 0.824981481 ubox
52 56 0.009100344 ubox
52 61 0.005728349 ubox
52 62 0.825151142 ubox
53 60 0.006253235 ubox
53 61 0.824299921 ubox
54 58 0.016602548 ubox
54 59 0.125602247 ubox
55 59 0.071226772 ubox
1 72 0.9500000 lbox
2 71 0.9500000 lbox
3 70 0.9500000 lbox
4 69 0.9500000 lbox
5 68 0.9500000 lbox
6 67 0.9500000 lbox
7 66 0.9500000 lbox
10 25 0.9500000 lbox
11 24 0.9500000 lbox
12 23 0.9500000 lbox
13 22 0.9500000 lbox
27 43 0.9500000 lbox
28 42 0.9500000 lbox
29 41 0.9500000 lbox
30 40 0.9500000 lbox
31 39 0.9500000 lbox
49 65 0.9500000 lbox
50 64 0.9500000 lbox
51 63 0.9500000 lbox
52 62 0.9500000 lbox
53 61 0.9500000 lbox
showpage
end
%%EOF
