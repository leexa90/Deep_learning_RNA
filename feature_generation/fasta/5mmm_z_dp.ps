%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:05:06 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (5mmm_z)
} def

/sequence { (\
GCCCGGAUAGCUCAGUCGGUAGAGCAGGGGAUUGAAAAUCCCCGUGUCCUUGGUUCGAUUCCGAGUCCGGGCACCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 72 0.999199338 ubox
1 74 0.003165555 ubox
1 75 0.004745882 ubox
2 71 0.999969452 ubox
3 70 0.999975562 ubox
4 69 0.999958186 ubox
5 49 0.017728225 ubox
5 68 0.999786593 ubox
6 48 0.018571560 ubox
6 67 0.999506590 ubox
7 45 0.003633532 ubox
7 47 0.019428889 ubox
7 66 0.857415688 ubox
8 21 0.018328613 ubox
8 26 0.051345265 ubox
8 44 0.003895611 ubox
8 46 0.019751289 ubox
8 63 0.003620316 ubox
8 64 0.017344723 ubox
8 65 0.545514622 ubox
9 20 0.019760452 ubox
9 45 0.018188281 ubox
9 55 0.008903798 ubox
9 60 0.004135581 ubox
9 66 0.023738109 ubox
10 16 0.007891930 ubox
10 17 0.004072098 ubox
10 20 0.038000234 ubox
10 25 0.633133089 ubox
10 54 0.014976080 ubox
10 59 0.003479227 ubox
10 61 0.036724916 ubox
10 62 0.157814402 ubox
10 66 0.458313602 ubox
10 67 0.003266759 ubox
11 15 0.008595733 ubox
11 18 0.020446061 ubox
11 19 0.038945252 ubox
11 22 0.008860534 ubox
11 24 0.634650305 ubox
11 53 0.015365183 ubox
11 63 0.277912014 ubox
11 65 0.626120445 ubox
12 18 0.034767704 ubox
12 19 0.008245404 ubox
12 21 0.008757704 ubox
12 23 0.634668384 ubox
12 52 0.006440396 ubox
12 53 0.008199129 ubox
12 58 0.013782833 ubox
12 63 0.021889065 ubox
12 64 0.646375180 ubox
13 18 0.017886956 ubox
13 19 0.007145803 ubox
13 22 0.634559410 ubox
13 52 0.017308312 ubox
13 57 0.013911542 ubox
13 63 0.644438743 ubox
13 65 0.004232018 ubox
14 20 0.096985641 ubox
14 50 0.004524563 ubox
14 51 0.017335728 ubox
14 55 0.008619603 ubox
14 59 0.012105685 ubox
14 60 0.629800339 ubox
14 66 0.007326334 ubox
15 20 0.031581169 ubox
15 25 0.005044902 ubox
15 49 0.004372262 ubox
15 50 0.013290515 ubox
15 54 0.008671278 ubox
15 55 0.003365771 ubox
15 56 0.007670097 ubox
15 59 0.759008781 ubox
15 60 0.018959346 ubox
15 61 0.069850050 ubox
15 62 0.023581765 ubox
16 21 0.011848425 ubox
16 23 0.023843995 ubox
16 53 0.010575632 ubox
16 58 0.766509266 ubox
16 64 0.061459474 ubox
17 22 0.026116110 ubox
17 52 0.012322232 ubox
17 53 0.013036812 ubox
17 57 0.767062725 ubox
17 63 0.061930323 ubox
18 49 0.026488918 ubox
18 50 0.004724489 ubox
18 51 0.011219061 ubox
18 54 0.025745175 ubox
18 55 0.016670720 ubox
18 56 0.765097378 ubox
18 60 0.003420944 ubox
18 62 0.062203320 ubox
19 25 0.003910270 ubox
19 48 0.026888653 ubox
19 49 0.008218193 ubox
19 50 0.008937766 ubox
19 51 0.039417884 ubox
19 54 0.075827112 ubox
19 55 0.673618583 ubox
19 56 0.011176971 ubox
19 59 0.004326026 ubox
19 61 0.062127818 ubox
20 24 0.003676126 ubox
20 52 0.251028805 ubox
20 53 0.052020477 ubox
20 58 0.007194989 ubox
21 47 0.006823629 ubox
21 50 0.484080502 ubox
21 51 0.226678399 ubox
21 54 0.048671404 ubox
21 55 0.005299437 ubox
21 59 0.007573001 ubox
21 60 0.005256852 ubox
22 47 0.005954453 ubox
22 48 0.138629665 ubox
22 49 0.535812977 ubox
22 50 0.154225985 ubox
22 51 0.448735450 ubox
22 54 0.005407752 ubox
22 55 0.015861479 ubox
22 56 0.058044498 ubox
23 45 0.004249992 ubox
23 47 0.134009674 ubox
23 50 0.448502077 ubox
23 51 0.099279737 ubox
23 54 0.020234227 ubox
23 55 0.058011103 ubox
24 45 0.065067735 ubox
24 47 0.614004547 ubox
24 48 0.176359106 ubox
24 49 0.386142591 ubox
24 50 0.032164138 ubox
24 51 0.008521121 ubox
24 54 0.053149186 ubox
25 44 0.076618657 ubox
25 46 0.727606075 ubox
25 52 0.023855001 ubox
25 53 0.051289298 ubox
26 45 0.702678072 ubox
26 47 0.041926209 ubox
26 50 0.006115655 ubox
26 51 0.025894245 ubox
27 42 0.005097276 ubox
27 43 0.994673850 ubox
27 49 0.005655665 ubox
27 50 0.011859958 ubox
27 51 0.030337283 ubox
28 41 0.004848585 ubox
28 42 0.996074811 ubox
28 43 0.065347078 ubox
28 48 0.005162692 ubox
28 49 0.011316463 ubox
28 50 0.038498286 ubox
28 62 0.042793409 ubox
29 40 0.004546932 ubox
29 41 0.996465128 ubox
29 42 0.059346296 ubox
29 47 0.004562234 ubox
29 48 0.010940316 ubox
29 49 0.038791428 ubox
29 61 0.042862590 ubox
30 39 0.003784314 ubox
30 40 0.996836606 ubox
30 41 0.052616148 ubox
30 47 0.009436553 ubox
30 48 0.038869580 ubox
30 60 0.042862048 ubox
31 39 0.995487822 ubox
31 45 0.006091518 ubox
31 47 0.038888292 ubox
31 59 0.042931610 ubox
32 36 0.007645155 ubox
32 37 0.027218129 ubox
32 38 0.978615305 ubox
32 44 0.005619667 ubox
32 46 0.037477737 ubox
32 58 0.042971941 ubox
33 37 0.815046648 ubox
33 38 0.086010311 ubox
33 44 0.025690531 ubox
33 57 0.042955494 ubox
34 40 0.009274980 ubox
34 41 0.003885584 ubox
34 42 0.007675056 ubox
34 43 0.031724083 ubox
34 56 0.042990862 ubox
35 39 0.008136971 ubox
35 55 0.042805080 ubox
36 54 0.041891988 ubox
37 54 0.003776981 ubox
38 54 0.003796609 ubox
39 53 0.003555763 ubox
40 52 0.003613631 ubox
40 53 0.010617544 ubox
41 52 0.010581157 ubox
41 53 0.008091911 ubox
42 52 0.007676890 ubox
42 53 0.040409434 ubox
43 52 0.040830224 ubox
43 63 0.006119277 ubox
44 48 0.039660332 ubox
44 49 0.050535962 ubox
44 50 0.006154575 ubox
44 51 0.039382429 ubox
44 56 0.004626519 ubox
44 61 0.042105122 ubox
44 62 0.018163857 ubox
44 66 0.003781078 ubox
44 74 0.006122651 ubox
45 52 0.009880477 ubox
45 53 0.006344732 ubox
45 57 0.004679457 ubox
45 63 0.004042034 ubox
45 73 0.006171907 ubox
46 50 0.003496356 ubox
46 51 0.013042127 ubox
46 54 0.006019592 ubox
46 56 0.006288550 ubox
46 59 0.053277432 ubox
46 61 0.003463436 ubox
46 62 0.004981227 ubox
46 66 0.006922076 ubox
46 67 0.003996119 ubox
46 72 0.006185578 ubox
47 52 0.004353115 ubox
47 53 0.015143569 ubox
47 58 0.055579332 ubox
47 64 0.015899097 ubox
47 71 0.005899189 ubox
48 52 0.020364465 ubox
48 53 0.013715955 ubox
48 57 0.055740592 ubox
48 63 0.016722326 ubox
48 65 0.019650314 ubox
48 70 0.005890670 ubox
49 53 0.009830192 ubox
49 57 0.004855065 ubox
49 63 0.007934566 ubox
49 65 0.540668914 ubox
49 69 0.005806421 ubox
50 58 0.008979263 ubox
50 63 0.005228578 ubox
50 64 0.603850041 ubox
50 65 0.003706512 ubox
51 57 0.009691433 ubox
51 58 0.003638973 ubox
51 63 0.610727131 ubox
51 64 0.010344634 ubox
52 56 0.009841972 ubox
52 60 0.003301540 ubox
52 61 0.014823372 ubox
52 62 0.615383748 ubox
52 67 0.004275157 ubox
52 68 0.018477773 ubox
53 59 0.004890942 ubox
53 60 0.015338612 ubox
53 61 0.614727381 ubox
53 62 0.008223386 ubox
53 66 0.007590060 ubox
53 67 0.018520600 ubox
54 58 0.013383974 ubox
54 64 0.005673176 ubox
54 65 0.043779197 ubox
55 64 0.142758595 ubox
56 63 0.149494561 ubox
57 62 0.147569982 ubox
1 72 0.9500000 lbox
2 71 0.9500000 lbox
3 70 0.9500000 lbox
4 69 0.9500000 lbox
5 68 0.9500000 lbox
6 67 0.9500000 lbox
7 66 0.9500000 lbox
10 25 0.9500000 lbox
11 24 0.9500000 lbox
12 23 0.9500000 lbox
13 22 0.9500000 lbox
27 43 0.9500000 lbox
28 42 0.9500000 lbox
29 41 0.9500000 lbox
30 40 0.9500000 lbox
31 39 0.9500000 lbox
32 38 0.9500000 lbox
33 37 0.9500000 lbox
49 65 0.9500000 lbox
50 64 0.9500000 lbox
51 63 0.9500000 lbox
52 62 0.9500000 lbox
53 61 0.9500000 lbox
showpage
end
%%EOF
