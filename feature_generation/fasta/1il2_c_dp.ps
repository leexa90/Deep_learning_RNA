%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:26 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (1il2_c)
} def

/sequence { (\
UCCGUGAUAGUUUAAUGGUCAGAAUGGGCGCUUGUCGCGUGCCAGAUCGGGGUUCAAUUCCCCGUCGCGGAGCCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 71 0.934905691 ubox
1 72 0.016198679 ubox
2 18 0.005820463 ubox
2 27 0.004488024 ubox
2 41 0.004961683 ubox
2 70 0.999513061 ubox
3 17 0.005889944 ubox
3 26 0.004524118 ubox
3 39 0.014344676 ubox
3 69 0.999794551 ubox
4 16 0.005872747 ubox
4 25 0.004467402 ubox
4 38 0.016411626 ubox
4 68 0.999767843 ubox
5 14 0.005496299 ubox
5 15 0.005450793 ubox
5 21 0.033048239 ubox
5 24 0.003512149 ubox
5 37 0.016410279 ubox
5 67 0.998675990 ubox
6 13 0.010577823 ubox
6 20 0.071734649 ubox
6 36 0.016448221 ubox
6 66 0.996043544 ubox
7 11 0.003674734 ubox
7 12 0.014585967 ubox
7 13 0.013174883 ubox
7 16 0.025258796 ubox
7 19 0.072030070 ubox
7 25 0.004323594 ubox
7 35 0.016441924 ubox
7 65 0.983268206 ubox
8 14 0.025420848 ubox
8 15 0.028562717 ubox
8 17 0.045246414 ubox
8 18 0.065840549 ubox
8 21 0.006288116 ubox
8 23 0.004438955 ubox
8 24 0.005165776 ubox
8 26 0.012897969 ubox
8 34 0.016161697 ubox
8 64 0.919978081 ubox
9 13 0.031160909 ubox
9 16 0.097359454 ubox
9 19 0.032074877 ubox
9 25 0.015753833 ubox
9 32 0.009043741 ubox
9 33 0.013320742 ubox
9 47 0.003478571 ubox
9 59 0.008243233 ubox
9 65 0.004076837 ubox
10 16 0.068604900 ubox
10 19 0.017940202 ubox
10 20 0.068890920 ubox
10 25 0.123408879 ubox
10 29 0.005566307 ubox
10 31 0.012548041 ubox
10 32 0.008030279 ubox
10 38 0.003765917 ubox
10 47 0.032546614 ubox
10 48 0.025217252 ubox
10 58 0.008457871 ubox
10 60 0.005275753 ubox
10 62 0.017942546 ubox
10 63 0.048414183 ubox
11 15 0.066303644 ubox
11 17 0.037941461 ubox
11 18 0.049314046 ubox
11 21 0.006863499 ubox
11 22 0.014624516 ubox
11 23 0.035079714 ubox
11 24 0.136427542 ubox
11 26 0.003893903 ubox
11 28 0.005620503 ubox
11 30 0.012095094 ubox
11 37 0.003729985 ubox
11 46 0.034157373 ubox
11 57 0.008523870 ubox
11 64 0.008285608 ubox
12 17 0.054900088 ubox
12 18 0.020674883 ubox
12 21 0.021012060 ubox
12 22 0.037695057 ubox
12 23 0.141663939 ubox
12 24 0.012382676 ubox
12 26 0.004750765 ubox
12 27 0.005983537 ubox
12 45 0.034064494 ubox
12 46 0.019515176 ubox
12 56 0.007844500 ubox
12 64 0.005966505 ubox
13 17 0.020179603 ubox
13 18 0.017762808 ubox
13 21 0.037144906 ubox
13 22 0.141312231 ubox
13 23 0.013452785 ubox
13 24 0.005932378 ubox
13 26 0.014730259 ubox
13 34 0.004898180 ubox
13 44 0.016617146 ubox
13 45 0.019519745 ubox
13 46 0.012136243 ubox
13 64 0.005089867 ubox
14 19 0.015109448 ubox
14 25 0.014905260 ubox
14 33 0.006382345 ubox
14 47 0.009193896 ubox
14 54 0.007037216 ubox
14 58 0.004943348 ubox
14 59 0.004723926 ubox
15 19 0.011421048 ubox
15 25 0.039960875 ubox
15 32 0.006930121 ubox
15 47 0.006851307 ubox
15 53 0.007324713 ubox
15 58 0.005066163 ubox
15 65 0.012882428 ubox
16 21 0.015664485 ubox
16 22 0.009554653 ubox
16 23 0.030525043 ubox
16 24 0.042389648 ubox
16 26 0.005532464 ubox
16 27 0.003512742 ubox
16 30 0.007343339 ubox
16 44 0.104345950 ubox
16 46 0.005366778 ubox
16 49 0.072224654 ubox
16 52 0.006936181 ubox
16 56 0.011070349 ubox
16 57 0.004377281 ubox
16 64 0.023148808 ubox
16 75 0.003490086 ubox
17 25 0.009878677 ubox
17 29 0.011720518 ubox
17 31 0.004892945 ubox
17 43 0.115182299 ubox
17 47 0.005984597 ubox
17 48 0.873287739 ubox
17 53 0.007191918 ubox
17 55 0.011669247 ubox
17 61 0.003373411 ubox
17 62 0.008391746 ubox
17 63 0.036791042 ubox
17 74 0.004318085 ubox
18 25 0.020827922 ubox
18 29 0.015864642 ubox
18 42 0.115056191 ubox
18 47 0.882389001 ubox
18 48 0.035367750 ubox
18 54 0.010517769 ubox
18 60 0.003323911 ubox
18 61 0.008458460 ubox
18 62 0.036631622 ubox
18 73 0.004317092 ubox
19 23 0.005833908 ubox
19 24 0.020947044 ubox
19 26 0.005320316 ubox
19 27 0.014755494 ubox
19 28 0.015898902 ubox
19 41 0.107947572 ubox
19 45 0.003165063 ubox
19 46 0.883846960 ubox
19 50 0.004708854 ubox
19 51 0.011132834 ubox
19 52 0.003561237 ubox
19 72 0.003535959 ubox
20 26 0.066534868 ubox
20 27 0.018145143 ubox
20 39 0.004828257 ubox
20 41 0.037847765 ubox
20 45 0.883155958 ubox
20 49 0.011584966 ubox
20 50 0.011649496 ubox
20 51 0.005317161 ubox
20 52 0.003620343 ubox
21 25 0.054388159 ubox
21 40 0.033742046 ubox
21 47 0.035906385 ubox
22 36 0.004992623 ubox
22 38 0.006015739 ubox
22 40 0.004917973 ubox
22 42 0.027515973 ubox
22 43 0.200127344 ubox
22 47 0.027863622 ubox
22 48 0.310033806 ubox
22 59 0.005387866 ubox
22 60 0.037156380 ubox
23 35 0.004719776 ubox
23 40 0.007573530 ubox
23 47 0.304683991 ubox
23 58 0.005662955 ubox
23 59 0.037159487 ubox
24 40 0.093382747 ubox
24 47 0.040549165 ubox
24 58 0.036727032 ubox
25 37 0.005137825 ubox
25 39 0.095178049 ubox
25 41 0.022707249 ubox
25 44 0.866232441 ubox
25 45 0.068310332 ubox
25 46 0.045062868 ubox
25 56 0.027397992 ubox
25 57 0.026051602 ubox
26 32 0.003707268 ubox
26 36 0.005536414 ubox
26 38 0.094852035 ubox
26 40 0.037948907 ubox
26 42 0.306583679 ubox
26 43 0.875068526 ubox
26 47 0.003256233 ubox
26 48 0.008429343 ubox
26 55 0.037774061 ubox
27 31 0.003726066 ubox
27 35 0.004740504 ubox
27 36 0.097411598 ubox
27 40 0.008193025 ubox
27 42 0.867419341 ubox
27 43 0.333080508 ubox
27 54 0.037847801 ubox
28 35 0.097751690 ubox
28 36 0.025078919 ubox
28 38 0.051610481 ubox
28 40 0.881616407 ubox
28 42 0.344620329 ubox
28 53 0.038003691 ubox
29 34 0.100349923 ubox
29 37 0.051683370 ubox
29 39 0.926566519 ubox
29 41 0.354960697 ubox
29 52 0.038050156 ubox
30 36 0.050120732 ubox
30 38 0.927323871 ubox
30 40 0.353469234 ubox
30 42 0.005102945 ubox
31 37 0.926619235 ubox
31 39 0.353374864 ubox
31 41 0.005153155 ubox
31 50 0.037179572 ubox
31 51 0.008041385 ubox
31 72 0.003170805 ubox
32 37 0.042733971 ubox
32 49 0.036526191 ubox
32 50 0.008040012 ubox
33 37 0.053608736 ubox
33 39 0.004900006 ubox
33 49 0.008253762 ubox
34 38 0.019386358 ubox
34 47 0.037194381 ubox
34 48 0.008632456 ubox
35 46 0.038943881 ubox
36 45 0.039003914 ubox
36 69 0.003284648 ubox
37 68 0.003332208 ubox
38 67 0.003331614 ubox
39 73 0.007360326 ubox
40 69 0.004443739 ubox
40 72 0.007276292 ubox
41 68 0.006243448 ubox
41 73 0.003755602 ubox
42 67 0.006167756 ubox
42 70 0.015059276 ubox
42 72 0.003703651 ubox
43 69 0.015135198 ubox
45 63 0.003950395 ubox
45 65 0.004632554 ubox
45 66 0.082497972 ubox
46 65 0.083703525 ubox
47 64 0.020861255 ubox
48 64 0.273893616 ubox
49 61 0.020907286 ubox
49 62 0.176384822 ubox
49 63 0.977245855 ubox
50 60 0.020989504 ubox
50 61 0.177636801 ubox
50 62 0.979031212 ubox
50 63 0.087559250 ubox
51 59 0.020772681 ubox
51 60 0.177967799 ubox
51 61 0.978983754 ubox
51 62 0.087585024 ubox
52 58 0.021929398 ubox
52 59 0.164890471 ubox
52 60 0.977907094 ubox
52 61 0.087431519 ubox
53 57 0.029394439 ubox
1 71 0.9500000 lbox
2 70 0.9500000 lbox
3 69 0.9500000 lbox
4 68 0.9500000 lbox
5 67 0.9500000 lbox
6 66 0.9500000 lbox
7 65 0.9500000 lbox
8 64 0.9500000 lbox
17 48 0.9500000 lbox
18 47 0.9500000 lbox
19 46 0.9500000 lbox
20 45 0.9500000 lbox
25 44 0.9500000 lbox
26 43 0.9500000 lbox
27 42 0.9500000 lbox
28 40 0.9500000 lbox
29 39 0.9500000 lbox
30 38 0.9500000 lbox
31 37 0.9500000 lbox
49 63 0.9500000 lbox
50 62 0.9500000 lbox
51 61 0.9500000 lbox
52 60 0.9500000 lbox
showpage
end
%%EOF
