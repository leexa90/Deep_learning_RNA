%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:42 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (4v7e_ae)
} def

/sequence { (\
CCGUGAUAGUUUAAUGGUCAGAAUGGGCGCUUGUCGCGUGCCAGAUCGGGGUUCAAUUCCCCGUCGCGGAGCCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 17 0.020820454 ubox
1 26 0.013322471 ubox
1 40 0.017791609 ubox
1 68 0.003819179 ubox
1 69 0.992911488 ubox
1 71 0.004329484 ubox
2 16 0.021102063 ubox
2 21 0.005024663 ubox
2 25 0.013503235 ubox
2 38 0.054746885 ubox
2 68 0.997385870 ubox
2 69 0.004591514 ubox
3 15 0.021008520 ubox
3 24 0.013316004 ubox
3 37 0.062465589 ubox
3 67 0.997460508 ubox
4 13 0.010087978 ubox
4 14 0.019429471 ubox
4 20 0.034972549 ubox
4 23 0.010415985 ubox
4 36 0.062455622 ubox
4 66 0.996371391 ubox
5 12 0.015529857 ubox
5 19 0.072915732 ubox
5 35 0.062523878 ubox
5 65 0.993745227 ubox
6 10 0.003848478 ubox
6 11 0.018547347 ubox
6 12 0.014071290 ubox
6 15 0.025224014 ubox
6 18 0.073196483 ubox
6 24 0.004315888 ubox
6 34 0.062498217 ubox
6 64 0.980999381 ubox
7 13 0.025395228 ubox
7 14 0.028519654 ubox
7 16 0.045336715 ubox
7 17 0.066898367 ubox
7 20 0.007232082 ubox
7 22 0.004433952 ubox
7 23 0.005155844 ubox
7 25 0.012870176 ubox
7 33 0.061431572 ubox
7 63 0.917855276 ubox
8 12 0.031113828 ubox
8 15 0.097299161 ubox
8 18 0.032079268 ubox
8 24 0.015719277 ubox
8 31 0.033829935 ubox
8 32 0.050629989 ubox
8 46 0.003470574 ubox
8 58 0.008224233 ubox
8 64 0.004067553 ubox
9 15 0.068876403 ubox
9 18 0.017970953 ubox
9 19 0.068784902 ubox
9 24 0.123162991 ubox
9 28 0.016504183 ubox
9 30 0.047232878 ubox
9 31 0.030521216 ubox
9 37 0.003821888 ubox
9 46 0.032471750 ubox
9 47 0.025159093 ubox
9 57 0.008438390 ubox
9 59 0.005263583 ubox
9 61 0.017901145 ubox
9 62 0.048302472 ubox
10 14 0.066540026 ubox
10 16 0.037956331 ubox
10 17 0.049272149 ubox
10 20 0.006851524 ubox
10 21 0.014593559 ubox
10 22 0.035007556 ubox
10 23 0.136154441 ubox
10 25 0.003889415 ubox
10 27 0.016682734 ubox
10 29 0.045527818 ubox
10 36 0.003785404 ubox
10 45 0.034078802 ubox
10 56 0.008504239 ubox
10 63 0.008266509 ubox
11 16 0.054865127 ubox
11 17 0.020651176 ubox
11 20 0.020967017 ubox
11 21 0.037617964 ubox
11 22 0.141382278 ubox
11 23 0.012368392 ubox
11 25 0.004793683 ubox
11 26 0.016988519 ubox
11 27 0.003902013 ubox
11 29 0.008532841 ubox
11 44 0.033986138 ubox
11 45 0.019470242 ubox
11 55 0.007826433 ubox
11 63 0.005952787 ubox
12 16 0.020158435 ubox
12 17 0.017732681 ubox
12 20 0.037068145 ubox
12 21 0.141031109 ubox
12 22 0.013434416 ubox
12 23 0.005924627 ubox
12 25 0.021532687 ubox
12 26 0.003557370 ubox
12 27 0.004616513 ubox
12 33 0.007856260 ubox
12 43 0.016578932 ubox
12 44 0.019474807 ubox
12 45 0.012108328 ubox
12 63 0.005078296 ubox
13 18 0.015077657 ubox
13 24 0.020955119 ubox
13 31 0.006693939 ubox
13 32 0.012207025 ubox
13 46 0.009172771 ubox
13 53 0.007021013 ubox
13 57 0.004931942 ubox
13 58 0.004713028 ubox
14 18 0.011398107 ubox
14 24 0.041461259 ubox
14 31 0.015328130 ubox
14 46 0.006835567 ubox
14 52 0.007307849 ubox
14 57 0.005054477 ubox
14 64 0.012863225 ubox
15 20 0.015666578 ubox
15 21 0.009647961 ubox
15 22 0.032716961 ubox
15 23 0.043966398 ubox
15 25 0.006218817 ubox
15 26 0.009559683 ubox
15 29 0.024106843 ubox
15 43 0.104115663 ubox
15 45 0.005354448 ubox
15 48 0.072058561 ubox
15 51 0.006920211 ubox
15 55 0.011044822 ubox
15 56 0.004367184 ubox
15 63 0.023101639 ubox
15 74 0.013507646 ubox
16 24 0.010249699 ubox
16 28 0.038196400 ubox
16 30 0.014268231 ubox
16 42 0.114928247 ubox
16 46 0.005970848 ubox
16 47 0.871274168 ubox
16 52 0.007175351 ubox
16 54 0.011642342 ubox
16 60 0.003365695 ubox
16 61 0.008372459 ubox
16 62 0.036710089 ubox
16 73 0.016712607 ubox
17 24 0.022864051 ubox
17 28 0.044731681 ubox
17 41 0.114802420 ubox
17 46 0.880354675 ubox
17 47 0.035286229 ubox
17 53 0.010493518 ubox
17 59 0.003316310 ubox
17 60 0.008439030 ubox
17 61 0.036551017 ubox
17 72 0.016708770 ubox
18 22 0.005911848 ubox
18 23 0.022774108 ubox
18 25 0.005331517 ubox
18 26 0.039112229 ubox
18 27 0.044744718 ubox
18 40 0.107709487 ubox
18 45 0.881809610 ubox
18 49 0.004703076 ubox
18 50 0.011107350 ubox
18 51 0.003553154 ubox
18 70 0.008967236 ubox
18 71 0.013685403 ubox
19 25 0.075944831 ubox
19 26 0.045354555 ubox
19 38 0.004817688 ubox
19 40 0.037765218 ubox
19 44 0.881120292 ubox
19 48 0.011562298 ubox
19 49 0.011627164 ubox
19 50 0.005305083 ubox
19 51 0.003612001 ubox
19 69 0.010342374 ubox
20 24 0.061997376 ubox
20 39 0.033668445 ubox
20 46 0.035834177 ubox
21 35 0.004990548 ubox
21 37 0.006002996 ubox
21 39 0.004907401 ubox
21 41 0.027453536 ubox
21 42 0.199667407 ubox
21 46 0.027808348 ubox
21 47 0.309335830 ubox
21 58 0.005376374 ubox
21 59 0.037078132 ubox
21 67 0.006922100 ubox
22 34 0.004717831 ubox
22 39 0.007558699 ubox
22 46 0.303998645 ubox
22 57 0.005650951 ubox
22 58 0.037081253 ubox
23 39 0.093189946 ubox
23 46 0.040467636 ubox
23 57 0.036649717 ubox
24 36 0.005129128 ubox
24 38 0.094981985 ubox
24 40 0.022669446 ubox
24 43 0.864389390 ubox
24 44 0.068158167 ubox
24 45 0.044970522 ubox
24 55 0.027340890 ubox
24 56 0.025996760 ubox
24 74 0.005565390 ubox
25 31 0.003716018 ubox
25 35 0.005531880 ubox
25 37 0.094661951 ubox
25 39 0.037890421 ubox
25 41 0.305942238 ubox
25 42 0.873235558 ubox
25 46 0.003249536 ubox
25 47 0.008410255 ubox
25 54 0.037695073 ubox
25 73 0.006852277 ubox
26 30 0.003736773 ubox
26 34 0.004736630 ubox
26 35 0.097256989 ubox
26 39 0.008180286 ubox
26 41 0.865602471 ubox
26 42 0.332705318 ubox
26 53 0.037768655 ubox
26 72 0.006640089 ubox
26 73 0.005969741 ubox
27 34 0.097597858 ubox
27 35 0.025029290 ubox
27 37 0.051846004 ubox
27 39 0.879855309 ubox
27 41 0.344213563 ubox
27 52 0.037924220 ubox
27 72 0.005994315 ubox
27 73 0.005548406 ubox
28 33 0.100190064 ubox
28 36 0.051918975 ubox
28 38 0.924713549 ubox
28 40 0.354522998 ubox
28 51 0.037970598 ubox
28 71 0.005941273 ubox
29 35 0.050349301 ubox
29 37 0.925475895 ubox
29 39 0.353033422 ubox
29 41 0.005111308 ubox
29 72 0.009116118 ubox
30 36 0.924772687 ubox
30 38 0.352939178 ubox
30 40 0.005163096 ubox
30 49 0.037101834 ubox
30 50 0.008024580 ubox
30 71 0.009162604 ubox
31 36 0.042680231 ubox
31 48 0.036449819 ubox
31 49 0.008023210 ubox
31 70 0.008962163 ubox
32 36 0.053542632 ubox
32 38 0.004898858 ubox
32 48 0.008236514 ubox
32 69 0.006788365 ubox
33 37 0.019364107 ubox
33 46 0.037119293 ubox
33 47 0.008614445 ubox
34 45 0.038865380 ubox
34 69 0.005954207 ubox
35 44 0.038925462 ubox
35 68 0.009793049 ubox
36 67 0.009955936 ubox
36 72 0.003205994 ubox
37 66 0.009954086 ubox
37 71 0.003217552 ubox
38 65 0.008705683 ubox
38 72 0.028352219 ubox
38 73 0.004093476 ubox
39 68 0.017089829 ubox
39 70 0.007946245 ubox
39 71 0.028041774 ubox
39 74 0.005289668 ubox
40 64 0.003213767 ubox
40 67 0.022912332 ubox
40 72 0.014462061 ubox
40 73 0.006527617 ubox
41 66 0.022624178 ubox
41 68 0.006172084 ubox
41 69 0.057108062 ubox
41 71 0.014260770 ubox
42 66 0.005165816 ubox
42 68 0.057395334 ubox
42 69 0.011359701 ubox
43 64 0.003256810 ubox
44 62 0.003955617 ubox
44 64 0.004804740 ubox
44 65 0.104012350 ubox
44 67 0.005254095 ubox
45 64 0.104633018 ubox
46 63 0.025962364 ubox
47 63 0.281063826 ubox
48 60 0.020864053 ubox
48 61 0.176103144 ubox
48 62 0.977327825 ubox
49 59 0.020946106 ubox
49 60 0.177353629 ubox
49 61 0.979104815 ubox
49 62 0.087359972 ubox
50 58 0.020729771 ubox
50 59 0.177685270 ubox
50 60 0.979057269 ubox
50 61 0.087385911 ubox
51 57 0.021887418 ubox
51 58 0.164629801 ubox
51 59 0.977980446 ubox
51 60 0.087232974 ubox
52 56 0.029365753 ubox
66 72 0.009544512 ubox
67 71 0.009515037 ubox
68 73 0.003390328 ubox
69 73 0.003902833 ubox
1 69 0.9500000 lbox
2 68 0.9500000 lbox
3 67 0.9500000 lbox
4 66 0.9500000 lbox
5 65 0.9500000 lbox
6 64 0.9500000 lbox
7 63 0.9500000 lbox
16 47 0.9500000 lbox
17 46 0.9500000 lbox
18 45 0.9500000 lbox
19 44 0.9500000 lbox
24 43 0.9500000 lbox
25 42 0.9500000 lbox
26 41 0.9500000 lbox
27 39 0.9500000 lbox
28 38 0.9500000 lbox
29 37 0.9500000 lbox
30 36 0.9500000 lbox
48 62 0.9500000 lbox
49 61 0.9500000 lbox
50 60 0.9500000 lbox
51 59 0.9500000 lbox
showpage
end
%%EOF
