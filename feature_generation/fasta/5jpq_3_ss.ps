%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:05:06 2017
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
CCACAGAUCCCACCCGGGUUGAUGAACGAGAUCCUCGGCGCCCAACAGUGAGGUCCAUUUUUUACUCUCGCUCUACCUGCAAAGGUGGCGGUCGCGUGCCUCGUCUCGCGGCUGUAUAGAGAGUGGCGAUGAUCUGUACCCCGGCUUUCCUGAGGUCUUGCCUUCGGGCGCUCAGGCGGGGUGGGUGUCGAUGGAAGUCUGACCGGC\
) def
/coor [
[45.38109207 410.23742676]
[36.80544662 409.81115723]
[31.06519508 423.66934204]
[36.86998749 438.12417603]
[30.85114098 452.09658813]
[17.03489494 457.54147339]
[11.29464340 471.39968872]
[5.55439234 485.25787354]
[-0.18585925 499.11605835]
[-5.92611074 512.97424316]
[-1.13982737 528.28668213]
[-10.24637413 541.49468994]
[-26.25998688 542.46612549]
[-36.89639282 530.45587158]
[-33.99625397 514.67712402]
[-19.78430367 507.23400879]
[-14.04405212 493.37582397]
[-8.30380058 479.51760864]
[-2.56354928 465.65942383]
[3.17670226 451.80123901]
[-2.74273133 438.18154907]
[2.88128471 424.04559326]
[17.20700264 417.92907715]
[22.94725418 404.07089233]
[10.09696674 386.76950073]
[10.30164719 365.08779907]
[23.63661575 347.82449341]
[44.81663513 342.08087158]
[49.06238174 327.69430542]
[41.73871613 314.77532959]
[45.83956528 300.12481689]
[59.43981552 292.53067017]
[63.68556213 278.14410400]
[67.93131256 263.75753784]
[72.06829071 249.33929443]
[76.09626770 234.89022827]
[80.12424469 220.44116211]
[84.15222168 205.99211121]
[88.18019867 191.54304504]
[92.20817566 177.09397888]
[96.23616028 162.64491272]
[100.26413727 148.19586182]
[104.29211426 133.74679565]
[108.32009125 119.29773712]
[95.84519196 129.97035217]
[75.08448792 130.64949036]
[54.10483551 116.41126251]
[39.48815155 113.04190063]
[24.87147141 109.67254639]
[10.25478745 106.30318451]
[-4.36189461 102.93382263]
[-18.97857666 99.56446075]
[-33.62028885 96.30558014]
[-48.28619385 93.15736389]
[-59.09183502 104.16834259]
[-74.14015198 107.56710815]
[-88.62928772 102.26912689]
[-97.93580627 89.96496582]
[-99.09002686 74.58084106]
[-91.72364807 61.02576828]
[-78.18725586 53.62512207]
[-62.80025864 54.74042130]
[-50.47259521 64.01577759]
[-45.13797379 78.49146271]
[-30.47207260 81.63967896]
[-23.27076912 79.96959686]
[-15.60921764 84.94777679]
[-0.99253470 88.31713867]
[13.62414837 91.68650055]
[28.24083138 95.05586243]
[42.85751343 98.42521667]
[57.47419739 101.79457855]
[65.23426056 88.95786285]
[55.45813370 77.58125305]
[45.68199921 66.20464325]
[35.90586853 54.82802963]
[26.12973785 43.45141983]
[16.35360718 32.07481003]
[0.70797372 27.16093254]
[-2.59471297 11.09779739]
[9.84306717 0.40978244]
[25.22639275 6.09180117]
[27.73021698 22.29867935]
[37.50634766 33.67528915]
[47.28247833 45.05189896]
[57.05860901 56.42850876]
[66.83473969 67.80512238]
[76.61087036 79.18173218]
[90.46906281 73.44147491]
[89.33735657 58.48423004]
[88.20565033 43.52698517]
[87.07393646 28.56973839]
[85.94223022 13.61249065]
[84.81051636 -1.34475613]
[83.67881012 -16.30200386]
[82.54710388 -31.25925064]
[73.79066467 -44.43632889]
[80.54567719 -57.71108627]
[68.39722443 -67.82002258]
[67.03827667 -83.56577301]
[77.27509308 -95.60667419]
[93.03433228 -96.79906464]
[104.96633148 -86.43552399]
[105.99204254 -70.66455841]
[95.50292206 -58.84279633]
[104.17840576 -46.73555756]
[97.50434875 -32.39096069]
[98.63605499 -17.43371201]
[99.76776886 -2.47646546]
[100.89947510 12.48078156]
[102.03118134 27.43802834]
[103.16289520 42.39527512]
[104.29460144 57.35252380]
[105.42631531 72.30976868]
[119.74712372 76.77231598]
[129.17518616 65.10562897]
[138.60325623 53.43893814]
[148.03131104 41.77224731]
[157.45938110 30.10556030]
[166.88743591 18.43887138]
[165.41146851 2.93212223]
[175.13906860 -8.76525307]
[189.93147278 -10.07680225]
[199.35954285 -21.74349022]
[201.37272644 -38.01859665]
[216.57742310 -44.16264725]
[229.33233643 -33.85516739]
[226.51631165 -17.69960976]
[211.02622986 -12.31542778]
[201.59815979 -0.64873874]
[203.42047119 14.08946896]
[194.02526855 26.05545616]
[178.55413818 27.86693382]
[169.12606812 39.53362274]
[159.69799805 51.20031357]
[150.26994324 62.86700058]
[140.84187317 74.53369141]
[131.41381836 86.20037842]
[137.04925537 100.10152435]
[151.93988037 101.90957642]
[166.83052063 103.71762848]
[181.72114563 105.52567291]
[196.61178589 107.33372498]
[189.56890869 94.08993530]
[195.38948059 80.26528931]
[209.78424072 76.04735565]
[222.14547729 84.54439545]
[223.36402893 99.49481964]
[212.54185486 109.88146973]
[227.25363159 112.80782318]
[241.96540833 115.73418427]
[256.67718506 118.66053772]
[271.38897705 121.58689117]
[286.10073853 124.51324463]
[290.16494751 122.96972656]
[294.11166382 122.81662750]
[297.51785278 123.84600067]
[300.07162476 125.73378754]
[301.60037231 128.08613586]
[316.10861206 131.89543152]
[330.61685181 135.70471191]
[345.12512207 139.51400757]
[360.79260254 134.67031860]
[372.63558960 146.01388550]
[368.47097778 161.87541199]
[352.58297729 165.93792725]
[341.31582642 154.02226257]
[326.80758667 150.21296692]
[312.29931641 146.40367126]
[297.79107666 142.59439087]
[283.17437744 139.22502136]
[268.46261597 136.29867554]
[253.75083923 133.37231445]
[239.03904724 130.44595337]
[224.32727051 127.51960754]
[209.61549377 124.59324646]
[194.80372620 122.22435760]
[179.91310120 120.41630554]
[165.02246094 118.60826111]
[150.13183594 116.80020905]
[135.24119568 114.99215698]
[122.76914978 123.32571411]
[118.74117279 137.77478027]
[114.71319580 152.22383118]
[110.68521881 166.67289734]
[106.65724182 181.12196350]
[102.62926483 195.57101440]
[98.60128784 210.02008057]
[94.57331085 224.46914673]
[90.54532623 238.91821289]
[86.51734924 253.36726379]
[87.22731781 262.47647095]
[82.31788635 268.00326538]
[78.07214355 282.38986206]
[73.82639313 296.77642822]
[81.12419128 310.53796387]
[76.61345673 325.06750488]
[63.44895935 331.94003296]
[59.20321274 346.32662964]
[66.23405457 351.57983398]
[71.70085907 358.42156982]
[75.25768280 366.40347290]
[76.68333435 375.00564575]
[75.89513397 383.67031860]
[72.95359039 391.83822632]
[68.05791473 398.98449707]
[61.53255081 404.65255737]
] def
/pairs [
[2 24]
[3 23]
[6 20]
[7 19]
[8 18]
[9 17]
[10 16]
[28 199]
[29 198]
[32 195]
[33 194]
[34 193]
[35 191]
[36 190]
[37 189]
[38 188]
[39 187]
[40 186]
[41 185]
[42 184]
[43 183]
[44 182]
[47 72]
[48 71]
[49 70]
[50 69]
[51 68]
[52 67]
[53 65]
[54 64]
[73 88]
[74 87]
[75 86]
[76 85]
[77 84]
[78 83]
[89 114]
[90 113]
[91 112]
[92 111]
[93 110]
[94 109]
[95 108]
[96 107]
[98 105]
[115 138]
[116 137]
[117 136]
[118 135]
[119 134]
[120 133]
[123 130]
[124 129]
[139 181]
[140 180]
[141 179]
[142 178]
[143 177]
[149 176]
[150 175]
[151 174]
[152 173]
[153 172]
[154 171]
[159 170]
[160 169]
[161 168]
[162 167]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
