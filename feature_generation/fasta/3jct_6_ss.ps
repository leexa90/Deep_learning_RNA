%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:34 2017
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
CCUUCUCAAACAUUCUGUUUGGUAGUGAGUGAUACUCUUUGGAGUUAACUUGAAAUUGCUGGCCUUUUCAUUGGAUGUUUUUUUUCCAAAGAGAGGUUUCUCUGCGUGCUUGAGGUAUAAUGCAAGUACGGUCGUUUUAGGUUUUACCAACUGCGGCUAAUCUUUUUUUAUACUGAGCGUAUUGGAACGUUAUCGAUAAGAAGAGAGCGUCUAGGCGAACAAUGUUCUUAAA\
) def
/coor [
[181.25007629 128.28636169]
[174.25726318 141.55665588]
[162.44767761 150.80508423]
[147.88807678 154.41313171]
[133.12585449 151.74908447]
[131.29339600 136.86143494]
[125.76400757 150.80509949]
[120.23461914 164.74876404]
[114.70523071 178.69242859]
[109.17583466 192.63609314]
[103.64644623 206.57977295]
[98.11705780 220.52343750]
[97.89888763 237.47598267]
[81.54846191 241.95925903]
[72.71413422 227.48890686]
[84.17339325 214.99404907]
[89.70278168 201.05036926]
[95.23217010 187.10670471]
[100.76155853 173.16304016]
[106.29094696 159.21937561]
[111.82034302 145.27571106]
[117.34973145 131.33204651]
[111.68461609 126.41711426]
[101.85458374 137.74717712]
[90.52466583 127.91697693]
[100.35439301 116.58725739]
[94.68928528 111.67232513]
[81.66532898 119.11386871]
[68.64137268 126.55540466]
[55.61741257 133.99694824]
[53.59545135 147.30403137]
[44.41617203 156.88053894]
[31.58837128 159.38931274]
[19.83279419 154.13516235]
[6.70968771 161.40042114]
[-6.41341925 168.66567993]
[-19.53652573 175.93095398]
[-27.52182388 190.25460815]
[-43.92095566 190.23037720]
[-51.86389542 175.88319397]
[-43.17963409 161.97219849]
[-26.80179024 162.80784607]
[-13.67868328 155.54258728]
[-0.55557674 148.27731323]
[12.56753063 141.01205444]
[16.52280045 124.65885925]
[31.37794113 116.06327820]
[48.17587280 120.97299194]
[61.19982910 113.53144836]
[74.22378540 106.08991241]
[87.24774933 98.64836884]
[98.37685394 88.59138489]
[107.09517670 76.38520050]
[115.81349182 64.17901611]
[124.44932556 51.91433716]
[133.00227356 39.59171295]
[141.55522156 27.26909065]
[150.10818481 14.94646931]
[151.62074280 -0.80226862]
[165.23403931 -6.84604263]
[166.74659729 -22.59477997]
[180.35990906 -28.63855362]
[188.91285706 -40.96117783]
[197.46580505 -53.28379822]
[206.01875305 -65.60642242]
[191.29486084 -62.74163055]
[178.11946106 -69.91162109]
[172.52949524 -83.83110809]
[177.08625793 -98.12221527]
[189.70187378 -106.23678589]
[204.59588623 -104.45673370]
[214.94387817 -93.59767914]
[216.00439453 -78.63510132]
[225.68058777 -90.09682465]
[235.35679626 -101.55854797]
[245.03298950 -113.02027130]
[254.70918274 -124.48200226]
[264.38537598 -135.94372559]
[274.06158447 -147.40545654]
[283.73779297 -158.86717224]
[293.41400146 -170.32890320]
[303.09017944 -181.79063416]
[312.76638794 -193.25234985]
[322.44259644 -204.71408081]
[332.11877441 -216.17581177]
[325.97363281 -230.10414124]
[326.48315430 -245.25759888]
[333.49279785 -258.63238525]
[345.56478882 -267.60055542]
[360.27276611 -270.42633057]
[374.68936157 -266.60183716]
[384.36557007 -278.06353760]
[393.96426392 -289.59024048]
[403.48504639 -301.18139648]
[406.26535034 -316.75640869]
[420.32254028 -321.68029785]
[429.84332275 -333.27145386]
[439.36410522 -344.86257935]
[448.88488770 -356.45373535]
[458.40567017 -368.04489136]
[457.05337524 -383.56289673]
[466.87393188 -395.18234253]
[481.67633057 -396.37591553]
[491.19711304 -407.96707153]
[500.71789551 -419.55819702]
[510.23867798 -431.14935303]
[519.75946045 -442.74050903]
[516.07183838 -451.67712402]
[515.88470459 -461.28503418]
[519.18164062 -470.24993896]
[525.47247314 -477.36068726]
[533.86572266 -481.67306519]
[543.19470215 -482.63482666]
[552.17974854 -480.15634155]
[562.31152344 -491.21737671]
[572.44329834 -502.27844238]
[582.57513428 -513.33947754]
[592.70690918 -524.40057373]
[602.83868408 -535.46160889]
[612.97045898 -546.52270508]
[610.02532959 -561.64324951]
[616.47308350 -575.43750000]
[629.65112305 -582.70404053]
[644.40447998 -580.83984375]
[654.53625488 -591.90087891]
[664.66809082 -602.96191406]
[661.72296143 -618.08251953]
[668.17065430 -631.87677002]
[681.34869385 -639.14331055]
[696.10211182 -637.27905273]
[706.23388672 -648.34014893]
[716.36566162 -659.40118408]
[726.49743652 -670.46221924]
[736.62921143 -681.52331543]
[746.76104736 -692.58435059]
[742.25689697 -707.20147705]
[745.65161133 -722.01275635]
[755.93572998 -733.06274414]
[770.27416992 -737.45208740]
[784.78668213 -734.09771729]
[794.91845703 -745.15875244]
[805.05023193 -756.21978760]
[811.29022217 -771.98364258]
[828.16540527 -770.35144043]
[831.26849365 -753.68383789]
[816.11132812 -746.08801270]
[805.97955322 -735.02697754]
[795.84771729 -723.96594238]
[800.45953369 -709.80267334]
[797.34204102 -695.13513184]
[787.23461914 -683.92321777]
[772.77734375 -679.24517822]
[757.82208252 -682.45257568]
[747.69030762 -671.39154053]
[737.55853271 -660.33044434]
[727.42675781 -649.26940918]
[717.29492188 -638.20837402]
[707.16314697 -627.14727783]
[710.31158447 -612.61370850]
[704.22637939 -598.85021973]
[691.04949951 -591.21984863]
[675.72912598 -592.83013916]
[665.59735107 -581.76910400]
[655.46557617 -570.70800781]
[658.61401367 -556.17443848]
[652.52874756 -542.41094971]
[639.35186768 -534.78057861]
[624.03149414 -536.39086914]
[613.89971924 -525.32983398]
[603.76794434 -514.26879883]
[593.63616943 -503.20773315]
[583.50439453 -492.14666748]
[573.37261963 -481.08560181]
[563.24084473 -470.02453613]
[565.82623291 -449.73605347]
[552.38073730 -433.93496704]
[531.35058594 -433.21972656]
[521.82983398 -421.62857056]
[512.30902100 -410.03741455]
[502.78826904 -398.44628906]
[493.26748657 -386.85513306]
[494.97222900 -372.10287476]
[485.48190308 -360.21215820]
[469.99682617 -358.52410889]
[460.47604370 -346.93295288]
[450.95526123 -335.34179688]
[441.43444824 -323.75067139]
[431.91366577 -312.15951538]
[429.81439209 -297.41357422]
[415.07620239 -291.66061401]
[405.55541992 -280.06945801]
[403.74154663 -272.91677856]
[395.82730103 -268.38735962]
[386.15109253 -256.92562866]
[392.33972168 -243.35482788]
[392.02114868 -228.38125610]
[385.20504761 -214.97596741]
[373.19558716 -205.82211304]
[358.34231567 -202.77790833]
[343.58050537 -206.49960327]
[333.90432739 -195.03787231]
[324.22811890 -183.57615662]
[314.55191040 -172.11442566]
[304.87570190 -160.65270996]
[295.19952393 -149.19097900]
[285.52331543 -137.72924805]
[275.84710693 -126.26752472]
[266.17092896 -114.80580139]
[256.49472046 -103.34407806]
[246.81851196 -91.88234711]
[237.14231873 -80.42062378]
[227.46611023 -68.95890045]
[218.34138489 -57.05347061]
[209.78842163 -44.73084641]
[201.23547363 -32.40822601]
[192.68252563 -20.08560181]
[191.78173828 -5.21826124]
[177.55665588 1.70690906]
[176.65586853 16.57425117]
[162.43080139 23.49942017]
[153.87785339 35.82204437]
[145.32489014 48.14466476]
[136.77194214 60.46728897]
[135.54200745 67.74315643]
[128.01966858 72.89733887]
[119.30136108 85.10352325]
[110.58303833 97.30970764]
[124.08603668 90.77755737]
[137.43957520 83.94506073]
[152.41970825 83.17316437]
[166.40478516 88.59696198]
[176.94732666 99.26723480]
] def
/pairs [
[6 22]
[7 21]
[8 20]
[9 19]
[10 18]
[11 17]
[12 16]
[27 51]
[28 50]
[29 49]
[30 48]
[34 45]
[35 44]
[36 43]
[37 42]
[52 227]
[53 226]
[54 225]
[55 223]
[56 222]
[57 221]
[58 220]
[60 218]
[62 216]
[63 215]
[64 214]
[65 213]
[73 212]
[74 211]
[75 210]
[76 209]
[77 208]
[78 207]
[79 206]
[80 205]
[81 204]
[82 203]
[83 202]
[84 201]
[85 200]
[91 194]
[92 193]
[93 191]
[94 190]
[96 188]
[97 187]
[98 186]
[99 185]
[100 184]
[103 181]
[104 180]
[105 179]
[106 178]
[107 177]
[114 174]
[115 173]
[116 172]
[117 171]
[118 170]
[119 169]
[120 168]
[124 164]
[125 163]
[126 162]
[130 158]
[131 157]
[132 156]
[133 155]
[134 154]
[135 153]
[140 148]
[141 147]
[142 146]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
