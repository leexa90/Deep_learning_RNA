%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:05:06 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (5lzs_3)
} def

/sequence { (\
CCCGGAUAGCUCAGCUGUAGAGCAUCAGACUUUUAAUCUGAGGGUCCAGGGUUCAAGUCCCUGUUCGGGCGCCA\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 43 0.006669108 ubox
1 44 0.003610553 ubox
1 50 0.025356106 ubox
1 51 0.099011765 ubox
1 68 0.013634596 ubox
1 69 0.978931910 ubox
1 71 0.013468455 ubox
2 42 0.006701009 ubox
2 43 0.004127342 ubox
2 49 0.026384057 ubox
2 50 0.100055956 ubox
2 67 0.012058901 ubox
2 68 0.992663022 ubox
2 69 0.024836182 ubox
3 28 0.004701867 ubox
3 40 0.009684168 ubox
3 42 0.004121278 ubox
3 49 0.100066939 ubox
3 67 0.992730600 ubox
3 68 0.024602000 ubox
3 71 0.003817185 ubox
4 26 0.008914875 ubox
4 39 0.009744535 ubox
4 47 0.104720721 ubox
4 65 0.006757993 ubox
4 66 0.987601337 ubox
4 70 0.003888662 ubox
4 73 0.039552443 ubox
5 10 0.005107594 ubox
5 12 0.021672285 ubox
5 25 0.009108777 ubox
5 26 0.639707862 ubox
5 38 0.009758599 ubox
5 46 0.113536014 ubox
5 64 0.012770187 ubox
5 65 0.725129797 ubox
5 66 0.031715906 ubox
5 72 0.039463865 ubox
5 73 0.004675942 ubox
6 11 0.019897960 ubox
6 18 0.226428658 ubox
6 25 0.642314010 ubox
6 37 0.009720714 ubox
6 45 0.113473868 ubox
6 64 0.651043126 ubox
6 65 0.035328153 ubox
7 13 0.003791107 ubox
7 17 0.246053662 ubox
7 19 0.005016069 ubox
7 24 0.637767700 ubox
7 27 0.020204095 ubox
7 36 0.009033270 ubox
7 44 0.111652604 ubox
7 63 0.380831419 ubox
7 71 0.011956399 ubox
8 16 0.251953199 ubox
8 18 0.003815758 ubox
8 25 0.045764367 ubox
8 31 0.004938078 ubox
8 34 0.003238301 ubox
8 45 0.004368999 ubox
8 62 0.317618426 ubox
8 64 0.011643878 ubox
8 65 0.004231341 ubox
9 15 0.252804582 ubox
9 18 0.031456045 ubox
9 23 0.911028268 ubox
9 26 0.010131871 ubox
9 30 0.005004912 ubox
9 45 0.034145079 ubox
9 46 0.006752411 ubox
9 52 0.004573448 ubox
9 58 0.083563861 ubox
9 59 0.019156282 ubox
9 60 0.016596201 ubox
9 61 0.246776542 ubox
9 64 0.003652161 ubox
9 70 0.041977737 ubox
10 14 0.250974277 ubox
10 17 0.032715942 ubox
10 20 0.003556623 ubox
10 22 0.911790257 ubox
10 28 0.006898959 ubox
10 42 0.123156741 ubox
10 43 0.004604337 ubox
10 44 0.036071563 ubox
10 51 0.007472559 ubox
10 57 0.158825820 ubox
10 63 0.003600464 ubox
10 69 0.042041803 ubox
11 19 0.003751062 ubox
11 20 0.003325395 ubox
11 21 0.911613607 ubox
11 24 0.004865875 ubox
11 27 0.008546768 ubox
11 41 0.123427993 ubox
11 43 0.035978403 ubox
11 50 0.007424309 ubox
11 55 0.034255343 ubox
11 56 0.151573643 ubox
11 57 0.025439770 ubox
11 68 0.041965722 ubox
12 17 0.009898303 ubox
12 20 0.911083846 ubox
12 40 0.123485487 ubox
12 42 0.035795939 ubox
12 49 0.006946945 ubox
12 51 0.003781651 ubox
12 57 0.047109264 ubox
12 67 0.041772827 ubox
13 18 0.222263299 ubox
13 25 0.012997448 ubox
13 31 0.005921968 ubox
13 39 0.123418817 ubox
13 52 0.009714670 ubox
13 53 0.162963759 ubox
13 58 0.011678407 ubox
13 65 0.004776370 ubox
14 18 0.048236476 ubox
14 23 0.153993514 ubox
14 26 0.006600190 ubox
14 30 0.006298354 ubox
14 38 0.123002256 ubox
14 52 0.180167593 ubox
14 53 0.012526847 ubox
14 54 0.003826392 ubox
14 58 0.169603257 ubox
14 59 0.018647072 ubox
14 60 0.009790709 ubox
15 20 0.005963466 ubox
15 22 0.154168238 ubox
15 28 0.018471977 ubox
15 49 0.014981885 ubox
15 50 0.010398448 ubox
15 51 0.181414658 ubox
15 57 0.173584301 ubox
16 21 0.152621072 ubox
16 24 0.010874536 ubox
16 27 0.019482212 ubox
16 35 0.014810113 ubox
16 36 0.093092475 ubox
16 48 0.015602184 ubox
16 49 0.010368999 ubox
16 50 0.180651061 ubox
16 55 0.007769011 ubox
16 56 0.171219002 ubox
16 57 0.004877236 ubox
17 23 0.013851488 ubox
17 26 0.020171922 ubox
17 34 0.015338087 ubox
17 37 0.007187453 ubox
17 47 0.015909442 ubox
17 54 0.007545591 ubox
18 22 0.012975713 ubox
18 35 0.018808950 ubox
18 36 0.007059737 ubox
18 48 0.169585591 ubox
18 55 0.046168714 ubox
18 56 0.013507645 ubox
19 25 0.005555871 ubox
19 33 0.116743363 ubox
19 34 0.019209056 ubox
20 26 0.034438112 ubox
20 30 0.003180850 ubox
20 32 0.120317347 ubox
20 33 0.018553930 ubox
20 46 0.300110689 ubox
20 47 0.011062798 ubox
20 53 0.013212351 ubox
20 54 0.173739931 ubox
20 66 0.003204997 ubox
21 25 0.029999207 ubox
21 31 0.120815160 ubox
21 32 0.017610888 ubox
21 45 0.300034550 ubox
21 52 0.013838645 ubox
21 53 0.174325029 ubox
21 65 0.003378087 ubox
22 26 0.006448170 ubox
22 30 0.120857531 ubox
22 31 0.015666517 ubox
22 45 0.026242792 ubox
22 46 0.005393761 ubox
22 52 0.174421994 ubox
22 64 0.003539403 ubox
23 28 0.098100752 ubox
23 42 0.016497117 ubox
23 43 0.291090450 ubox
23 44 0.030635941 ubox
23 50 0.015106172 ubox
23 51 0.174299490 ubox
23 63 0.003506555 ubox
24 45 0.005235214 ubox
24 52 0.008751942 ubox
25 41 0.322925620 ubox
25 42 0.004999354 ubox
25 44 0.003824633 ubox
25 48 0.013308528 ubox
25 49 0.041454950 ubox
25 50 0.068527767 ubox
25 51 0.009335193 ubox
26 40 0.342637309 ubox
26 49 0.075589703 ubox
26 50 0.012662419 ubox
27 39 0.342640908 ubox
27 45 0.004314990 ubox
28 38 0.342657227 ubox
28 45 0.005257202 ubox
28 46 0.924368767 ubox
28 47 0.022486888 ubox
28 59 0.075721476 ubox
28 60 0.003500037 ubox
29 34 0.003414589 ubox
29 37 0.327064162 ubox
29 45 0.927060784 ubox
29 58 0.076052741 ubox
30 42 0.011920848 ubox
30 43 0.043776890 ubox
30 44 0.926889842 ubox
30 57 0.076087428 ubox
31 35 0.068444022 ubox
31 36 0.053250244 ubox
31 41 0.012395679 ubox
31 42 0.054565654 ubox
31 43 0.925048699 ubox
31 56 0.075517081 ubox
32 36 0.014998260 ubox
32 40 0.013036141 ubox
32 41 0.063802166 ubox
32 42 0.921166099 ubox
32 43 0.013657882 ubox
32 55 0.070353940 ubox
32 56 0.005013297 ubox
33 40 0.065096695 ubox
33 41 0.921911433 ubox
33 42 0.019127487 ubox
33 55 0.006528492 ubox
34 40 0.913729322 ubox
34 41 0.021987789 ubox
34 42 0.003502617 ubox
35 39 0.760771255 ubox
35 52 0.028216174 ubox
35 53 0.021552077 ubox
36 45 0.003808103 ubox
36 52 0.022725305 ubox
37 44 0.003940174 ubox
37 50 0.070960867 ubox
37 51 0.020749264 ubox
38 43 0.004036136 ubox
38 49 0.073820870 ubox
38 50 0.018431799 ubox
39 48 0.074440615 ubox
39 49 0.015508250 ubox
40 46 0.007189907 ubox
40 47 0.074331129 ubox
40 73 0.004061106 ubox
41 45 0.007851205 ubox
41 62 0.026686185 ubox
42 46 0.017899260 ubox
42 47 0.016268745 ubox
42 60 0.004694372 ubox
42 61 0.054164639 ubox
42 66 0.006467194 ubox
42 72 0.010697467 ubox
42 73 0.024030938 ubox
43 47 0.005227568 ubox
43 59 0.004721184 ubox
43 60 0.054828426 ubox
43 65 0.007027811 ubox
43 66 0.009598651 ubox
43 72 0.024049248 ubox
44 58 0.004218859 ubox
44 59 0.054787806 ubox
44 64 0.006127340 ubox
44 65 0.010221449 ubox
44 66 0.014923658 ubox
44 70 0.027560516 ubox
45 57 0.003522045 ubox
45 69 0.027560296 ubox
46 57 0.047317798 ubox
46 63 0.006144559 ubox
46 68 0.027552395 ubox
47 57 0.010306695 ubox
47 63 0.912677727 ubox
47 67 0.024044093 ubox
48 53 0.003828093 ubox
48 62 0.938431627 ubox
49 54 0.039587784 ubox
49 59 0.004038634 ubox
49 60 0.043835697 ubox
49 61 0.955713728 ubox
49 62 0.010900213 ubox
50 54 0.009265324 ubox
50 58 0.004096759 ubox
50 59 0.044431699 ubox
50 60 0.955952624 ubox
50 61 0.016213715 ubox
50 73 0.013768555 ubox
51 58 0.034839302 ubox
51 59 0.954963693 ubox
51 60 0.016472418 ubox
51 72 0.014666024 ubox
52 56 0.019686431 ubox
52 57 0.145921975 ubox
52 71 0.014601978 ubox
52 74 0.003257949 ubox
53 57 0.082529254 ubox
53 74 0.005850467 ubox
54 71 0.004657088 ubox
57 70 0.090917807 ubox
57 72 0.043915305 ubox
57 73 0.009412757 ubox
58 69 0.084229906 ubox
58 71 0.043603947 ubox
59 68 0.084249726 ubox
59 69 0.058091559 ubox
59 71 0.005711015 ubox
60 67 0.084021241 ubox
60 68 0.058347602 ubox
60 69 0.019213612 ubox
61 67 0.058430715 ubox
61 68 0.019239138 ubox
62 67 0.018004691 ubox
67 73 0.007177132 ubox
68 72 0.007076107 ubox
69 73 0.006459011 ubox
1 69 0.9500000 lbox
2 68 0.9500000 lbox
3 67 0.9500000 lbox
4 66 0.9500000 lbox
5 26 0.9500000 lbox
6 25 0.9500000 lbox
7 24 0.9500000 lbox
9 23 0.9500000 lbox
10 22 0.9500000 lbox
11 21 0.9500000 lbox
12 20 0.9500000 lbox
28 46 0.9500000 lbox
29 45 0.9500000 lbox
30 44 0.9500000 lbox
31 43 0.9500000 lbox
32 42 0.9500000 lbox
33 41 0.9500000 lbox
34 40 0.9500000 lbox
35 39 0.9500000 lbox
47 63 0.9500000 lbox
48 62 0.9500000 lbox
49 61 0.9500000 lbox
50 60 0.9500000 lbox
51 59 0.9500000 lbox
showpage
end
%%EOF
