%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:07:13 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (5xjc_b)
} def

/sequence { (\
GGUUUCUCUUCAGAUCGCAUAAAUCUUUCGCCUUUUACUAAAGAUUUCCGUGGAGAGGAACAACUCUGAGUCUUAACCCAAUUUUUUGAGGCCUUGC\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 61 0.062205298 ubox
1 64 0.086615978 ubox
1 65 0.038546353 ubox
1 66 0.047982870 ubox
1 67 0.012423120 ubox
1 72 0.003833337 ubox
1 78 0.003452400 ubox
1 92 0.006673481 ubox
1 93 0.033768578 ubox
1 94 0.004909328 ubox
1 95 0.007159454 ubox
1 97 0.014726299 ubox
2 15 0.003172374 ubox
2 61 0.993830335 ubox
2 64 0.045390461 ubox
2 65 0.011557997 ubox
2 66 0.009115104 ubox
2 77 0.003440242 ubox
2 92 0.018029896 ubox
3 14 0.003182370 ubox
3 59 0.003713580 ubox
3 60 0.997110783 ubox
3 63 0.043430750 ubox
3 76 0.003394698 ubox
3 91 0.015704258 ubox
4 13 0.003169995 ubox
4 59 0.998204676 ubox
4 60 0.006344988 ubox
4 62 0.034690804 ubox
4 90 0.013033432 ubox
5 14 0.003511806 ubox
5 58 0.998388392 ubox
5 59 0.007762169 ubox
5 89 0.012810200 ubox
6 13 0.003796994 ubox
6 57 0.999286785 ubox
6 58 0.006234563 ubox
6 88 0.012553263 ubox
7 12 0.003484711 ubox
7 14 0.003850605 ubox
7 56 0.999223348 ubox
7 59 0.031788264 ubox
8 13 0.004103017 ubox
8 55 0.999342673 ubox
8 58 0.032232270 ubox
8 91 0.003283565 ubox
9 54 0.997674712 ubox
9 55 0.006145662 ubox
9 57 0.032209193 ubox
9 90 0.003537099 ubox
10 53 0.986322082 ubox
10 54 0.049665877 ubox
10 56 0.032249827 ubox
10 69 0.003958197 ubox
10 89 0.003778473 ubox
11 50 0.003577094 ubox
11 52 0.970330395 ubox
11 53 0.068904025 ubox
11 55 0.032260552 ubox
11 68 0.004108636 ubox
11 88 0.003840078 ubox
12 26 0.009677278 ubox
12 47 0.019478722 ubox
12 51 0.935394689 ubox
12 67 0.003868771 ubox
12 87 0.003852039 ubox
13 18 0.022821650 ubox
13 20 0.003534761 ubox
13 25 0.012735474 ubox
13 29 0.005895111 ubox
13 35 0.003982873 ubox
13 46 0.047994449 ubox
13 47 0.008769722 ubox
13 48 0.083550870 ubox
13 49 0.070421099 ubox
13 51 0.035040170 ubox
13 66 0.003781154 ubox
13 86 0.003741795 ubox
14 20 0.009814712 ubox
14 24 0.012693935 ubox
14 28 0.005833227 ubox
14 34 0.004062430 ubox
14 45 0.049204274 ubox
14 46 0.007400482 ubox
14 47 0.077651065 ubox
14 51 0.067959940 ubox
14 65 0.003633798 ubox
14 85 0.003460194 ubox
15 19 0.009042167 ubox
15 23 0.012221062 ubox
15 44 0.049896023 ubox
15 50 0.041124487 ubox
15 52 0.004468146 ubox
15 53 0.141061067 ubox
15 54 0.010516532 ubox
16 30 0.004725280 ubox
16 43 0.049826839 ubox
16 50 0.890194304 ubox
16 52 0.232787998 ubox
16 53 0.012120026 ubox
17 29 0.004940061 ubox
17 31 0.025745805 ubox
17 46 0.013114086 ubox
17 47 0.027647058 ubox
17 48 0.144612348 ubox
17 49 0.890476081 ubox
17 51 0.300032253 ubox
18 30 0.025786598 ubox
18 43 0.003501700 ubox
18 50 0.329788408 ubox
18 52 0.026097713 ubox
19 27 0.003283003 ubox
19 28 0.010878680 ubox
19 39 0.007944195 ubox
19 45 0.005373280 ubox
19 46 0.013826950 ubox
19 47 0.098304518 ubox
19 51 0.029481313 ubox
20 37 0.031069157 ubox
20 40 0.005907037 ubox
20 44 0.003297397 ubox
20 50 0.032059891 ubox
21 27 0.008986727 ubox
21 28 0.004704359 ubox
21 35 0.005153132 ubox
21 36 0.032311002 ubox
21 39 0.005869996 ubox
21 45 0.010406469 ubox
21 46 0.036019639 ubox
21 47 0.953858547 ubox
22 26 0.006972554 ubox
22 27 0.004407104 ubox
22 34 0.005320027 ubox
22 35 0.032363566 ubox
22 36 0.006129707 ubox
22 45 0.026656291 ubox
22 46 0.989781052 ubox
22 47 0.011669242 ubox
23 33 0.004922112 ubox
23 34 0.031589508 ubox
23 35 0.006470452 ubox
23 36 0.003808423 ubox
23 45 0.996113437 ubox
23 46 0.009255408 ubox
24 44 0.997975953 ubox
25 30 0.007661308 ubox
25 43 0.998250295 ubox
26 41 0.023269831 ubox
26 42 0.996641749 ubox
27 37 0.007027947 ubox
27 40 0.032224480 ubox
27 41 0.988260171 ubox
27 42 0.015763430 ubox
28 37 0.020793774 ubox
28 40 0.921212589 ubox
28 41 0.020714795 ubox
28 44 0.003621931 ubox
29 43 0.003721605 ubox
30 34 0.008796284 ubox
30 35 0.022273216 ubox
30 36 0.062916071 ubox
30 38 0.800664307 ubox
30 39 0.153825117 ubox
32 43 0.027474120 ubox
33 37 0.033887070 ubox
33 40 0.023394896 ubox
33 41 0.013634537 ubox
33 42 0.028820280 ubox
33 44 0.003499018 ubox
34 40 0.018849694 ubox
34 41 0.031320386 ubox
34 42 0.004013909 ubox
34 43 0.003761282 ubox
35 40 0.032297411 ubox
35 41 0.006506795 ubox
35 42 0.004622212 ubox
36 40 0.006933587 ubox
36 41 0.005602055 ubox
54 67 0.012513202 ubox
55 66 0.013108206 ubox
56 65 0.013135475 ubox
57 64 0.013157338 ubox
60 71 0.004295941 ubox
61 68 0.012319997 ubox
61 70 0.004824383 ubox
61 96 0.015434172 ubox
62 67 0.021778682 ubox
62 71 0.003824731 ubox
62 73 0.005483521 ubox
62 74 0.005424160 ubox
62 94 0.006354939 ubox
62 95 0.025349886 ubox
63 67 0.012498394 ubox
63 71 0.062261488 ubox
63 73 0.004595942 ubox
63 94 0.025860070 ubox
63 95 0.011131765 ubox
64 68 0.020542968 ubox
64 70 0.066153494 ubox
64 90 0.088775551 ubox
64 91 0.006930914 ubox
64 96 0.119262067 ubox
65 69 0.060173777 ubox
65 89 0.089045414 ubox
65 90 0.003392613 ubox
65 91 0.013279761 ubox
65 96 0.088395433 ubox
66 70 0.004944379 ubox
66 88 0.088965875 ubox
66 90 0.018268852 ubox
66 96 0.185459649 ubox
67 75 0.016052271 ubox
67 76 0.007728706 ubox
67 80 0.020845965 ubox
67 88 0.003285392 ubox
67 89 0.018177488 ubox
67 96 0.272692524 ubox
68 72 0.005839739 ubox
68 74 0.016954069 ubox
68 78 0.004652973 ubox
68 79 0.021897214 ubox
68 84 0.025829322 ubox
68 85 0.024778245 ubox
68 86 0.056815892 ubox
68 87 0.019333721 ubox
68 92 0.009365742 ubox
68 93 0.521034561 ubox
68 94 0.127976962 ubox
68 95 0.466877073 ubox
68 97 0.016928780 ubox
69 73 0.014550292 ubox
69 74 0.004496165 ubox
69 82 0.003271061 ubox
69 83 0.026873980 ubox
69 84 0.025070922 ubox
69 85 0.062517465 ubox
69 86 0.020658831 ubox
69 87 0.016752253 ubox
69 94 0.481774858 ubox
69 95 0.036307251 ubox
70 77 0.023612021 ubox
70 78 0.004540516 ubox
70 79 0.004235391 ubox
70 82 0.027009196 ubox
70 83 0.023859932 ubox
70 84 0.058226647 ubox
70 85 0.019445970 ubox
70 86 0.016029382 ubox
70 92 0.912970029 ubox
70 93 0.345617553 ubox
70 94 0.006812613 ubox
70 97 0.034134827 ubox
71 76 0.022040466 ubox
71 80 0.004371461 ubox
71 81 0.026292831 ubox
71 89 0.009745683 ubox
71 91 0.974347311 ubox
71 96 0.030708583 ubox
72 88 0.010044571 ubox
72 90 0.976467555 ubox
72 91 0.046947748 ubox
72 96 0.029964225 ubox
73 80 0.008024313 ubox
73 81 0.020274792 ubox
73 88 0.004697862 ubox
73 89 0.976116323 ubox
73 90 0.045561760 ubox
73 96 0.008815329 ubox
74 80 0.021350300 ubox
74 81 0.012885141 ubox
74 88 0.970796884 ubox
74 89 0.043605943 ubox
74 96 0.031300896 ubox
75 82 0.008952080 ubox
75 83 0.017441886 ubox
75 84 0.032737911 ubox
75 85 0.028547714 ubox
75 86 0.086504884 ubox
75 87 0.954773681 ubox
75 94 0.007307120 ubox
75 95 0.034702888 ubox
76 82 0.022313224 ubox
76 83 0.042035128 ubox
76 84 0.038672565 ubox
76 85 0.116945255 ubox
76 86 0.843302962 ubox
76 87 0.019640790 ubox
76 94 0.030227863 ubox
76 95 0.005791443 ubox
77 88 0.006472314 ubox
77 90 0.024857264 ubox
77 91 0.181914175 ubox
78 88 0.008338185 ubox
78 90 0.182757726 ubox
78 91 0.012151790 ubox
79 88 0.208051668 ubox
79 90 0.012167005 ubox
79 96 0.003410221 ubox
80 84 0.054843030 ubox
80 85 0.069726108 ubox
80 86 0.034648356 ubox
80 87 0.208777914 ubox
80 95 0.003406535 ubox
81 85 0.037240589 ubox
81 86 0.201213360 ubox
81 87 0.014686340 ubox
82 89 0.004960495 ubox
83 88 0.005472785 ubox
90 97 0.003244295 ubox
91 97 0.021362614 ubox
92 96 0.022120809 ubox
2 61 0.9500000 lbox
3 60 0.9500000 lbox
4 59 0.9500000 lbox
5 58 0.9500000 lbox
6 57 0.9500000 lbox
7 56 0.9500000 lbox
8 55 0.9500000 lbox
9 54 0.9500000 lbox
10 53 0.9500000 lbox
11 52 0.9500000 lbox
12 51 0.9500000 lbox
16 50 0.9500000 lbox
17 49 0.9500000 lbox
21 47 0.9500000 lbox
22 46 0.9500000 lbox
23 45 0.9500000 lbox
24 44 0.9500000 lbox
25 43 0.9500000 lbox
26 42 0.9500000 lbox
27 41 0.9500000 lbox
28 40 0.9500000 lbox
30 38 0.9500000 lbox
70 92 0.9500000 lbox
71 91 0.9500000 lbox
72 90 0.9500000 lbox
73 89 0.9500000 lbox
74 88 0.9500000 lbox
75 87 0.9500000 lbox
76 86 0.9500000 lbox
showpage
end
%%EOF
