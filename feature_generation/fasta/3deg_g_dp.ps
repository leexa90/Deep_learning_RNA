%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:28 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (3deg_g)
} def

/sequence { (\
CCCAGACAGCCAGGAUGUUGGCUUAGAAGCAGCCAUCAUUUAAAGAAAGCGUAAUAGCUCACUGGUCGAG\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 5 0.028073586 ubox
1 9 0.004751461 ubox
1 14 0.004870102 ubox
1 65 0.018273234 ubox
1 68 0.040161063 ubox
1 70 0.026673689 ubox
2 9 0.009867987 ubox
2 13 0.005020985 ubox
2 14 0.009436221 ubox
2 64 0.014809080 ubox
2 65 0.329950342 ubox
2 68 0.029084541 ubox
2 70 0.065521318 ubox
3 9 0.011693633 ubox
3 13 0.009631590 ubox
3 64 0.331881287 ubox
3 68 0.073957766 ubox
3 70 0.057420066 ubox
4 63 0.331139624 ubox
4 66 0.005024291 ubox
5 10 0.007388788 ubox
5 11 0.011715141 ubox
5 60 0.006317560 ubox
5 62 0.329432460 ubox
5 66 0.007010701 ubox
5 67 0.197092055 ubox
6 18 0.012434917 ubox
6 24 0.006227568 ubox
6 52 0.006043240 ubox
6 59 0.005013744 ubox
6 66 0.165183005 ubox
7 13 0.029425277 ubox
7 14 0.008313039 ubox
7 17 0.013156084 ubox
7 20 0.004599432 ubox
7 26 0.005840492 ubox
7 45 0.012446893 ubox
7 51 0.006068131 ubox
7 64 0.059570467 ubox
7 65 0.122929532 ubox
7 68 0.517817345 ubox
7 70 0.086948605 ubox
8 16 0.012952374 ubox
8 19 0.005305916 ubox
8 23 0.047226066 ubox
8 59 0.215314021 ubox
8 63 0.077440001 ubox
8 66 0.027760452 ubox
9 18 0.006318600 ubox
9 22 0.051195548 ubox
9 41 0.003732843 ubox
9 50 0.008149236 ubox
9 58 0.219311436 ubox
9 60 0.021710536 ubox
9 62 0.078278314 ubox
9 63 0.007169375 ubox
9 66 0.884147951 ubox
9 67 0.187262176 ubox
10 14 0.004716902 ubox
10 17 0.006346921 ubox
10 21 0.051231765 ubox
10 45 0.033104251 ubox
10 49 0.008143286 ubox
10 57 0.218840027 ubox
10 64 0.007394452 ubox
10 65 0.931816996 ubox
11 20 0.051264009 ubox
11 45 0.055051131 ubox
11 49 0.004515481 ubox
11 51 0.006966987 ubox
11 57 0.008535372 ubox
11 64 0.933949008 ubox
12 19 0.050620970 ubox
12 40 0.004281052 ubox
12 41 0.019191014 ubox
12 52 0.007023816 ubox
12 55 0.152453004 ubox
12 59 0.004668660 ubox
12 63 0.926800420 ubox
13 18 0.046303544 ubox
13 34 0.006498996 ubox
13 39 0.003997150 ubox
13 40 0.017302621 ubox
13 41 0.308823572 ubox
13 50 0.010187788 ubox
13 52 0.004995144 ubox
13 55 0.010107865 ubox
13 58 0.003300048 ubox
13 60 0.014033677 ubox
13 62 0.915096871 ubox
13 63 0.006068839 ubox
14 33 0.006648105 ubox
14 37 0.108216911 ubox
14 39 0.019977275 ubox
14 40 0.893001731 ubox
14 41 0.078618574 ubox
14 50 0.006993432 ubox
14 52 0.004628569 ubox
14 55 0.003587126 ubox
14 59 0.003935813 ubox
14 60 0.204013513 ubox
14 62 0.011615030 ubox
15 36 0.108351405 ubox
15 39 0.957055446 ubox
15 40 0.059628199 ubox
15 41 0.010284820 ubox
15 52 0.175411482 ubox
15 59 0.077079060 ubox
16 31 0.007105801 ubox
16 35 0.104974281 ubox
16 38 0.969630180 ubox
16 51 0.176206123 ubox
16 56 0.008414626 ubox
16 61 0.011060346 ubox
17 30 0.007655052 ubox
17 33 0.047408569 ubox
17 34 0.092638520 ubox
17 36 0.011920520 ubox
17 37 0.969914536 ubox
17 39 0.007982166 ubox
17 50 0.176481716 ubox
17 55 0.009069826 ubox
17 58 0.016440416 ubox
17 60 0.011678401 ubox
18 29 0.007654647 ubox
18 32 0.065969736 ubox
18 35 0.024526957 ubox
18 38 0.008133634 ubox
18 48 0.004766197 ubox
18 49 0.175839097 ubox
18 54 0.009079420 ubox
18 57 0.016250198 ubox
19 28 0.007619961 ubox
19 31 0.062863289 ubox
19 32 0.028320714 ubox
19 35 0.962899755 ubox
19 47 0.003933552 ubox
19 48 0.144844688 ubox
19 53 0.008706412 ubox
19 56 0.010788844 ubox
20 30 0.048058042 ubox
20 34 0.983624278 ubox
20 52 0.007995621 ubox
20 55 0.007817564 ubox
20 59 0.006758942 ubox
21 30 0.092823688 ubox
21 33 0.983682722 ubox
21 50 0.009725590 ubox
21 58 0.008281971 ubox
22 29 0.101614398 ubox
22 32 0.983452895 ubox
22 45 0.135851288 ubox
22 49 0.009735965 ubox
22 57 0.008288979 ubox
23 27 0.008271154 ubox
23 28 0.094791508 ubox
23 29 0.024486727 ubox
23 31 0.946181158 ubox
23 32 0.013119783 ubox
23 43 0.031735932 ubox
23 44 0.132279730 ubox
23 48 0.009598755 ubox
23 56 0.007843749 ubox
24 28 0.048135874 ubox
24 29 0.231351503 ubox
24 31 0.082404983 ubox
24 42 0.045164951 ubox
24 43 0.119178102 ubox
24 47 0.008872868 ubox
24 56 0.003655385 ubox
25 39 0.006378948 ubox
25 40 0.003606538 ubox
25 41 0.054191801 ubox
25 55 0.004377330 ubox
26 30 0.102973920 ubox
26 33 0.005928820 ubox
26 34 0.006207457 ubox
26 37 0.028487445 ubox
26 40 0.053441993 ubox
26 41 0.117029119 ubox
26 60 0.008314299 ubox
27 36 0.028117114 ubox
27 39 0.051429612 ubox
27 40 0.119927019 ubox
27 41 0.018751452 ubox
27 59 0.005963163 ubox
28 36 0.007553654 ubox
28 39 0.117274240 ubox
28 40 0.018560975 ubox
28 41 0.004035050 ubox
28 59 0.008710706 ubox
29 33 0.004044977 ubox
29 34 0.014685571 ubox
29 36 0.007228761 ubox
29 37 0.045471263 ubox
29 39 0.015299025 ubox
29 40 0.003695947 ubox
29 50 0.006164063 ubox
29 52 0.009654603 ubox
29 58 0.010675937 ubox
29 60 0.003349312 ubox
30 49 0.006160438 ubox
30 51 0.009854407 ubox
30 57 0.010649949 ubox
30 64 0.003461674 ubox
30 68 0.007060450 ubox
31 36 0.050269765 ubox
31 39 0.004165126 ubox
31 40 0.003355086 ubox
31 52 0.003274297 ubox
31 55 0.003788302 ubox
31 59 0.004723245 ubox
31 63 0.003456689 ubox
32 36 0.006997582 ubox
32 37 0.012928951 ubox
32 39 0.003365557 ubox
32 50 0.016959760 ubox
32 58 0.004925564 ubox
32 62 0.003426264 ubox
32 66 0.011003171 ubox
33 49 0.016960941 ubox
33 57 0.004913746 ubox
33 65 0.011508166 ubox
34 45 0.004275043 ubox
34 64 0.011516509 ubox
35 40 0.004751101 ubox
35 41 0.005098727 ubox
35 55 0.003241738 ubox
35 63 0.009221150 ubox
36 43 0.004385954 ubox
36 46 0.053492392 ubox
36 47 0.003303321 ubox
37 45 0.056918805 ubox
37 51 0.004259560 ubox
39 43 0.008382727 ubox
39 44 0.010102421 ubox
39 45 0.006722902 ubox
39 46 0.021934570 ubox
39 47 0.031623346 ubox
39 48 0.023326771 ubox
39 49 0.005492783 ubox
39 54 0.003337245 ubox
40 44 0.011709743 ubox
40 45 0.025333271 ubox
40 46 0.044800556 ubox
40 47 0.049482707 ubox
40 48 0.016723827 ubox
40 49 0.004373624 ubox
40 53 0.003518414 ubox
40 54 0.006989393 ubox
41 45 0.046515519 ubox
41 46 0.063166661 ubox
41 47 0.043669829 ubox
41 48 0.019368771 ubox
41 49 0.003423767 ubox
41 53 0.011712279 ubox
41 56 0.006820517 ubox
41 61 0.006464353 ubox
41 64 0.003425189 ubox
42 52 0.012266668 ubox
42 55 0.007398113 ubox
42 63 0.003815732 ubox
43 52 0.011404393 ubox
43 55 0.004067395 ubox
43 59 0.004267892 ubox
43 63 0.007015661 ubox
44 52 0.012291579 ubox
44 55 0.008444395 ubox
44 59 0.016498700 ubox
44 63 0.131219553 ubox
45 50 0.041290079 ubox
45 52 0.009951292 ubox
45 58 0.016469259 ubox
45 59 0.007815586 ubox
45 60 0.280411504 ubox
45 62 0.148202968 ubox
45 67 0.003240062 ubox
46 52 0.008569628 ubox
46 55 0.009599748 ubox
46 59 0.213135666 ubox
46 63 0.005204211 ubox
46 66 0.003176095 ubox
47 52 0.008675930 ubox
47 55 0.005969703 ubox
47 59 0.053155949 ubox
47 63 0.003253442 ubox
48 52 0.005160257 ubox
48 55 0.024310013 ubox
48 59 0.891511443 ubox
48 63 0.005232194 ubox
49 55 0.006492718 ubox
49 58 0.971599296 ubox
49 59 0.005353685 ubox
49 60 0.043623377 ubox
49 62 0.005739191 ubox
50 57 0.971790373 ubox
50 68 0.003748614 ubox
51 55 0.014976003 ubox
51 58 0.062563670 ubox
51 60 0.016137857 ubox
51 62 0.005183298 ubox
51 67 0.003795027 ubox
52 56 0.025675334 ubox
52 57 0.060708754 ubox
52 61 0.005417490 ubox
55 64 0.004382620 ubox
56 63 0.004804562 ubox
57 62 0.004894027 ubox
58 70 0.003355726 ubox
59 69 0.003934885 ubox
60 64 0.004018380 ubox
60 68 0.004348526 ubox
62 70 0.006035351 ubox
63 69 0.006124635 ubox
9 66 0.9500000 lbox
10 65 0.9500000 lbox
11 64 0.9500000 lbox
12 63 0.9500000 lbox
13 62 0.9500000 lbox
14 40 0.9500000 lbox
15 39 0.9500000 lbox
16 38 0.9500000 lbox
17 37 0.9500000 lbox
19 35 0.9500000 lbox
20 34 0.9500000 lbox
21 33 0.9500000 lbox
22 32 0.9500000 lbox
23 31 0.9500000 lbox
48 59 0.9500000 lbox
49 58 0.9500000 lbox
50 57 0.9500000 lbox
showpage
end
%%EOF
