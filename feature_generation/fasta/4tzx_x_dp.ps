%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:41 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (4tzx_x)
} def

/sequence { (\
GGGAAGAUAUAAUCCUAAUGAUAUGGUUUGGGAGUUUCUACCAAGAGCCUUAAACUCUUGAUUAUCUUCCC\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 70 0.010243386 ubox
1 71 0.988117612 ubox
2 69 0.008360576 ubox
2 70 0.999874882 ubox
2 71 0.004489211 ubox
3 68 0.005780694 ubox
3 69 0.999949692 ubox
3 70 0.003231252 ubox
4 67 0.004276751 ubox
4 68 0.999624152 ubox
5 39 0.005790753 ubox
5 67 0.999397663 ubox
6 38 0.006732076 ubox
6 66 0.999864033 ubox
7 37 0.007196050 ubox
7 39 0.004986848 ubox
7 65 0.993019386 ubox
8 40 0.012205312 ubox
8 61 0.005976139 ubox
8 64 0.967411254 ubox
9 22 0.003367516 ubox
9 24 0.009654216 ubox
9 35 0.030499037 ubox
9 36 0.023306141 ubox
9 37 0.045539694 ubox
9 39 0.018015228 ubox
9 62 0.129684778 ubox
9 63 0.894001867 ubox
9 65 0.092707289 ubox
10 17 0.009117544 ubox
10 21 0.003485082 ubox
10 23 0.013247990 ubox
10 25 0.004928999 ubox
10 30 0.030770767 ubox
10 33 0.007273239 ubox
10 34 0.040815983 ubox
10 40 0.021621708 ubox
10 60 0.020082318 ubox
10 61 0.174825864 ubox
10 64 0.204340726 ubox
11 16 0.009172510 ubox
11 19 0.003218307 ubox
11 22 0.010395963 ubox
11 24 0.007187465 ubox
11 28 0.019570166 ubox
11 29 0.036629417 ubox
11 35 0.120281286 ubox
11 36 0.163573786 ubox
11 37 0.061264728 ubox
11 39 0.019585996 ubox
11 59 0.021538223 ubox
11 62 0.085015195 ubox
11 63 0.261511037 ubox
12 19 0.008241152 ubox
12 22 0.066215687 ubox
12 24 0.004462011 ubox
12 27 0.022811715 ubox
12 28 0.035818282 ubox
12 29 0.006306571 ubox
12 35 0.172270520 ubox
12 36 0.062583625 ubox
12 37 0.022283314 ubox
12 39 0.014318515 ubox
12 58 0.017811950 ubox
12 59 0.013707988 ubox
12 62 0.340494880 ubox
12 63 0.010548291 ubox
13 18 0.007887882 ubox
13 21 0.069856446 ubox
13 23 0.004174789 ubox
13 26 0.019480941 ubox
13 32 0.060273142 ubox
13 33 0.854872823 ubox
13 34 0.091227945 ubox
13 60 0.006013934 ubox
13 61 0.349161031 ubox
14 20 0.069628271 ubox
14 25 0.019738614 ubox
14 26 0.054106037 ubox
14 30 0.003797163 ubox
14 31 0.095743069 ubox
14 32 0.918906654 ubox
14 60 0.343366572 ubox
15 20 0.055373731 ubox
15 25 0.055361848 ubox
15 26 0.025384721 ubox
15 30 0.096353066 ubox
15 31 0.919178883 ubox
15 32 0.006102497 ubox
15 34 0.005284810 ubox
15 60 0.031242816 ubox
16 20 0.003537084 ubox
16 21 0.005948908 ubox
16 23 0.028149515 ubox
16 25 0.026197964 ubox
16 30 0.915718763 ubox
16 31 0.005790931 ubox
16 33 0.005284832 ubox
16 60 0.023118619 ubox
16 64 0.040643008 ubox
17 22 0.026910231 ubox
17 24 0.025931438 ubox
17 27 0.005231520 ubox
17 28 0.254813802 ubox
17 29 0.879234388 ubox
17 56 0.014738673 ubox
17 58 0.044111668 ubox
17 59 0.067052192 ubox
17 62 0.006301505 ubox
17 63 0.053503148 ubox
18 22 0.005683388 ubox
18 24 0.017852443 ubox
18 27 0.353680019 ubox
18 28 0.820358384 ubox
18 29 0.019900381 ubox
18 56 0.033579920 ubox
18 58 0.072804123 ubox
18 59 0.041851280 ubox
18 62 0.071849550 ubox
18 63 0.003626069 ubox
18 65 0.008118569 ubox
19 23 0.019433742 ubox
19 25 0.040657366 ubox
19 26 0.422014673 ubox
19 30 0.009375554 ubox
19 52 0.016522107 ubox
19 53 0.011947031 ubox
19 54 0.029087640 ubox
19 60 0.013906618 ubox
19 61 0.071653142 ubox
19 64 0.017374319 ubox
20 24 0.029932479 ubox
20 27 0.073378411 ubox
20 28 0.106683823 ubox
20 29 0.038372844 ubox
20 38 0.003963530 ubox
20 51 0.017597435 ubox
20 55 0.064023588 ubox
20 56 0.010375496 ubox
20 57 0.131224124 ubox
20 58 0.006082457 ubox
20 59 0.083679174 ubox
20 62 0.008722428 ubox
20 63 0.024182019 ubox
21 27 0.130925724 ubox
21 28 0.047440537 ubox
21 29 0.005973139 ubox
21 37 0.003892328 ubox
21 50 0.017391419 ubox
21 51 0.011004749 ubox
21 56 0.111623719 ubox
21 58 0.083156565 ubox
21 59 0.063846672 ubox
21 62 0.029557954 ubox
22 26 0.123291612 ubox
22 30 0.003335422 ubox
22 52 0.174893676 ubox
22 53 0.016562208 ubox
22 54 0.012319179 ubox
22 60 0.024524989 ubox
22 61 0.028144250 ubox
23 27 0.010940186 ubox
23 28 0.012768213 ubox
23 29 0.005234732 ubox
23 50 0.026375717 ubox
23 51 0.177539897 ubox
23 56 0.005547559 ubox
23 58 0.051449666 ubox
23 59 0.043973352 ubox
23 62 0.007327975 ubox
24 40 0.004554829 ubox
24 43 0.018300594 ubox
24 52 0.005342263 ubox
24 53 0.007299179 ubox
24 60 0.004011776 ubox
24 61 0.007465307 ubox
25 39 0.005140937 ubox
25 42 0.027498214 ubox
25 48 0.007596533 ubox
25 49 0.288420157 ubox
25 50 0.004849659 ubox
25 55 0.008062967 ubox
25 56 0.202128525 ubox
25 57 0.062240268 ubox
25 58 0.004508482 ubox
25 63 0.003989426 ubox
26 38 0.005190181 ubox
26 41 0.028568001 ubox
26 48 0.288791465 ubox
26 49 0.004591514 ubox
26 55 0.235870991 ubox
26 56 0.007716184 ubox
26 57 0.003655508 ubox
26 62 0.006489351 ubox
27 40 0.026233397 ubox
27 45 0.039246087 ubox
27 46 0.021354357 ubox
27 47 0.283818451 ubox
27 54 0.236135712 ubox
27 61 0.006165693 ubox
28 44 0.128093324 ubox
28 45 0.022578155 ubox
28 46 0.249541943 ubox
28 53 0.235975089 ubox
28 60 0.005352327 ubox
28 61 0.020956134 ubox
29 40 0.037713141 ubox
29 43 0.170290569 ubox
29 44 0.021411487 ubox
29 45 0.227860498 ubox
29 52 0.235882670 ubox
29 60 0.023195533 ubox
30 37 0.006371701 ubox
30 38 0.013909712 ubox
30 39 0.046705610 ubox
30 41 0.007899375 ubox
30 42 0.188981768 ubox
30 50 0.014894885 ubox
30 51 0.235117467 ubox
30 59 0.029156586 ubox
31 36 0.005380268 ubox
31 37 0.012992142 ubox
31 38 0.047743015 ubox
31 39 0.035902951 ubox
31 41 0.188789878 ubox
31 42 0.152835949 ubox
31 49 0.020260016 ubox
31 50 0.234895652 ubox
31 58 0.032129807 ubox
32 36 0.008667508 ubox
32 37 0.037734867 ubox
32 38 0.048029043 ubox
32 39 0.011128205 ubox
32 41 0.153354447 ubox
32 42 0.154124629 ubox
32 48 0.020232000 ubox
32 49 0.235063059 ubox
32 51 0.011048939 ubox
32 57 0.033819790 ubox
33 37 0.042330934 ubox
33 39 0.148021963 ubox
33 50 0.014309175 ubox
33 56 0.033946746 ubox
33 63 0.004618896 ubox
34 38 0.169309582 ubox
34 39 0.036826529 ubox
34 41 0.494892363 ubox
34 42 0.007786814 ubox
34 48 0.228277098 ubox
34 49 0.015907757 ubox
34 55 0.034057938 ubox
34 62 0.016524804 ubox
35 40 0.483507934 ubox
35 45 0.007759635 ubox
35 46 0.035693414 ubox
35 47 0.196193767 ubox
35 54 0.033959625 ubox
35 61 0.017007126 ubox
36 40 0.017826197 ubox
36 44 0.008381725 ubox
36 45 0.035759388 ubox
36 46 0.157153071 ubox
36 47 0.125631866 ubox
36 53 0.031629252 ubox
36 60 0.005730157 ubox
36 61 0.007943676 ubox
37 43 0.008234809 ubox
37 44 0.031665589 ubox
37 45 0.103811171 ubox
37 46 0.172566783 ubox
37 52 0.026467612 ubox
37 61 0.017168789 ubox
38 45 0.208448829 ubox
38 47 0.015198749 ubox
38 60 0.014667954 ubox
39 43 0.021334196 ubox
39 44 0.198892607 ubox
39 45 0.003272974 ubox
39 46 0.014843677 ubox
39 60 0.003179690 ubox
39 61 0.020612345 ubox
39 64 0.009781267 ubox
40 62 0.086049021 ubox
40 63 0.012997207 ubox
41 45 0.003759163 ubox
41 47 0.005651903 ubox
41 60 0.027081553 ubox
42 47 0.012837301 ubox
42 60 0.922967264 ubox
43 51 0.009577462 ubox
43 59 0.925463079 ubox
44 50 0.009709107 ubox
44 58 0.926196492 ubox
45 49 0.009515040 ubox
45 57 0.926822383 ubox
46 56 0.926473592 ubox
47 55 0.923591761 ubox
50 54 0.028458976 ubox
50 61 0.014212865 ubox
51 60 0.015466315 ubox
52 59 0.015615862 ubox
53 58 0.013687150 ubox
55 60 0.008150999 ubox
1 71 0.9500000 lbox
2 70 0.9500000 lbox
3 69 0.9500000 lbox
4 68 0.9500000 lbox
5 67 0.9500000 lbox
6 66 0.9500000 lbox
7 65 0.9500000 lbox
8 64 0.9500000 lbox
9 63 0.9500000 lbox
13 33 0.9500000 lbox
14 32 0.9500000 lbox
15 31 0.9500000 lbox
16 30 0.9500000 lbox
17 29 0.9500000 lbox
18 28 0.9500000 lbox
42 60 0.9500000 lbox
43 59 0.9500000 lbox
44 58 0.9500000 lbox
45 57 0.9500000 lbox
46 56 0.9500000 lbox
47 55 0.9500000 lbox
showpage
end
%%EOF
