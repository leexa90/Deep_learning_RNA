%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:26 2017
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def
end
%%EndProlog
RNAplot begin
% data start here
/sequence (\
GCCGUGUGCCUUGCGCCGGGAAACCACGCAAGGGAUGGUGUCAAAUUCGGCGAAACCUAAGCGCCCGCCCGGGCGUAUGGCAACGCCGAGCCAAGCUUCGCAGCCAUUGCACUCCGGCUGCGAUGAAGGUGUAGAGACUAGACGGCACCCACCUAAGGCAAACGCUAUGGUGAAGGCAUAGUCCAGGGAGUGGCG\
) def
/coor [
[80.86750031 165.40065002]
[76.59958649 151.02062988]
[72.33167267 136.64060974]
[64.96997833 135.20692444]
[50.24659348 132.33955383]
[42.88489914 130.90585327]
[33.53255081 142.63333130]
[30.97754860 158.24687195]
[16.99295998 163.37332153]
[7.64061308 175.10079956]
[-1.71173418 186.82826233]
[-11.06408119 198.55574036]
[-20.41642761 210.28320312]
[-29.76877594 222.01068115]
[-39.12112045 233.73815918]
[-38.45640564 246.62733459]
[-46.49776840 256.20437622]
[-58.51174164 257.68075562]
[-68.05085754 269.25683594]
[-70.21945953 285.51196289]
[-85.48217010 291.51043701]
[-98.13801575 281.08154297]
[-95.16774750 264.95364380]
[-79.62692261 259.71771240]
[-70.08781433 248.14164734]
[-68.13780212 230.70666504]
[-50.84859467 224.38580322]
[-41.49624634 212.65834045]
[-32.14390182 200.93086243]
[-22.79155350 189.20338440]
[-13.43920612 177.47592163]
[-4.08685923 165.74844360]
[5.26548767 154.02098083]
[7.15154696 139.24626160]
[21.80507851 133.28097534]
[31.15742493 121.55351257]
[92.28394318 89.78411102]
[89.88993835 74.97638702]
[87.49594116 60.16865921]
[85.10194397 45.36093140]
[82.70794678 30.55320549]
[80.31394958 15.74547768]
[66.14497375 19.30966759]
[49.29550171 14.83735275]
[34.19261932 1.14573610]
[25.59238625 -20.63619995]
[13.28980255 -29.21794891]
[0.98721898 -37.79969788]
[-11.31536484 -46.38145065]
[-23.61794853 -54.96319962]
[-35.92053223 -63.54494858]
[-48.22311783 -72.12670135]
[-60.88309097 -66.65769196]
[-74.48396301 -68.14974213]
[-85.48170471 -76.10639191]
[-91.06385803 -88.36077881]
[-89.86845398 -101.66479492]
[-102.03191376 -110.44262695]
[-114.19537354 -119.22045898]
[-129.91366577 -121.02201080]
[-135.70640564 -134.74401855]
[-147.86985779 -143.52185059]
[-160.03330994 -152.29968262]
[-172.19676208 -161.07751465]
[-184.36022949 -169.85534668]
[-196.52368164 -178.63317871]
[-212.88435364 -179.75585938]
[-219.84840393 -194.60287476]
[-210.25180054 -207.90090942]
[-193.96672058 -205.97006226]
[-187.74584961 -190.79663086]
[-175.58239746 -182.01879883]
[-163.41893005 -173.24096680]
[-151.25547791 -164.46313477]
[-139.09202576 -155.68530273]
[-126.92856598 -146.90747070]
[-112.08027649 -145.73377991]
[-105.41754150 -131.38391113]
[-93.25408173 -122.60607910]
[-81.09062958 -113.82824707]
[-65.67299652 -119.44850159]
[-49.78296661 -114.72863007]
[-39.73398972 -101.33747101]
[-39.64136505 -84.42928314]
[-27.33878326 -75.84753418]
[-15.03619862 -67.26578522]
[-2.73361492 -58.68403244]
[9.56896877 -50.10228348]
[21.87155342 -41.52053452]
[34.17413712 -32.93878174]
[41.38101578 -35.01504898]
[32.97764587 -47.44015884]
[42.19786453 -59.27179337]
[56.29961395 -54.15900040]
[55.79477692 -39.16758347]
[63.00165558 -41.24384689]
[61.26038742 -56.96894073]
[73.34935760 -65.66986847]
[79.20048523 -79.48161316]
[85.05161285 -93.29335785]
[90.90274048 -107.10510254]
[96.75387573 -120.91684723]
[102.60500336 -134.72859192]
[108.45613098 -148.54032898]
[114.30725861 -162.35208130]
[104.99139404 -174.56314087]
[103.04506683 -189.79821777]
[108.99182892 -203.95913696]
[121.23204041 -213.23667908]
[136.47314453 -215.13523865]
[150.61534119 -209.14411926]
[159.85447693 -196.87489319]
[161.70526123 -181.62791443]
[155.66983032 -167.50456238]
[143.37170410 -158.30392456]
[128.11900330 -156.50094604]
[122.26787567 -142.68920898]
[116.41674805 -128.87745667]
[110.56562042 -115.06571960]
[104.71448517 -101.25397491]
[98.86335754 -87.44223022]
[93.01222992 -73.63048553]
[87.16110229 -59.81873703]
[89.32088470 -45.08155441]
[76.81340027 -35.39271927]
[81.98767853 -29.96345711]
[96.56563568 -33.49660492]
[92.33621979 -19.10493279]
[97.51049805 -13.67567158]
[111.58752441 -18.85614777]
[121.86635590 -30.88345718]
[136.48269653 -28.01779938]
[150.55972290 -33.19827652]
[164.63674927 -38.37874985]
[177.41307068 -49.52333069]
[191.65896606 -40.33143234]
[186.76994324 -24.09770775]
[169.81721497 -24.30172539]
[155.74018860 -19.12124825]
[141.66316223 -13.94077301]
[132.39122009 -2.28400588]
[116.76799774 -4.77912045]
[102.69097137 0.40135518]
[95.12167358 13.35147953]
[97.51567078 28.15920639]
[99.90967560 42.96693420]
[102.30367279 57.77465820]
[104.69766998 72.58238983]
[107.09166718 87.39011383]
[116.06332397 99.41131592]
[129.57786560 105.91957092]
[143.09239197 112.42783356]
[156.60691833 118.93608856]
[168.73085022 113.05169678]
[181.83824158 115.19705963]
[191.17562866 124.36692047]
[193.48794556 137.05033875]
[206.89643860 143.77435303]
[220.30491638 150.49838257]
[236.63505554 148.99551392]
[245.87940979 162.54077148]
[238.52819824 177.19995117]
[222.14369202 177.89294434]
[213.58088684 163.90687561]
[200.17240906 157.18284607]
[186.76391602 150.45881653]
[171.05046082 156.43687439]
[155.56785583 149.06083679]
[150.09866333 132.45062256]
[136.58413696 125.94235992]
[123.06960297 119.43410492]
[109.55506897 112.92584991]
[103.84422302 117.78756714]
[92.42253876 127.51098633]
[86.71169281 132.37269592]
[90.97960663 146.75271606]
[95.24752045 161.13273621]
[107.75452423 166.15173340]
[114.97846985 177.29718018]
[114.46775818 190.37434387]
[106.63308716 200.61317444]
[111.96293640 208.04710388]
[110.61691284 215.32369995]
[114.42173004 229.83312988]
[118.22654724 244.34254456]
[131.29586792 253.64698792]
[132.02603149 269.67340088]
[119.85694122 280.12771606]
[104.12367249 276.99026489]
[96.89543915 262.66784668]
[103.71712494 248.14736938]
[99.91230774 233.63793945]
[96.10749054 219.12852478]
[92.18650818 204.65005493]
[77.19690704 197.03678894]
] def
/pairs [
[1 177]
[2 176]
[3 175]
[6 36]
[7 35]
[9 33]
[10 32]
[11 31]
[12 30]
[13 29]
[14 28]
[15 27]
[18 25]
[19 24]
[37 149]
[38 148]
[39 147]
[40 146]
[41 145]
[42 144]
[46 90]
[47 89]
[48 88]
[49 87]
[50 86]
[51 85]
[52 84]
[57 80]
[58 79]
[59 78]
[61 76]
[62 75]
[63 74]
[64 73]
[65 72]
[66 71]
[96 125]
[98 123]
[99 122]
[100 121]
[101 120]
[102 119]
[103 118]
[104 117]
[105 116]
[129 143]
[130 142]
[132 140]
[133 139]
[134 138]
[150 172]
[151 171]
[152 170]
[153 169]
[157 166]
[158 165]
[159 164]
[181 194]
[183 193]
[184 192]
[185 191]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
