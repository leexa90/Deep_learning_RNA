%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA Dot Plot
%%Creator: ViennaRNA-2.4.1
%%CreationDate: Mon Sep  4 18:04:39 2017
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox

%%BeginProlog
/DPdict 100 dict def
DPdict begin
/logscale false def
/lpmin 1e-05 log def

/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def

/min { 2 copy gt { exch } if pop } bind def

/max { 2 copy lt { exch } if pop } bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

/drawseq {
% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def

/drawgrid{
  gsave
  0.5 dup translate  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  %% draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def

/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def

/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def

/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def

/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def

/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def

/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def

/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def

/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def

/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def

/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def

/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def

/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def

% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def

% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i

          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]

          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key

            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]

          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

end
%EndProlog

DPdict begin

/DPtitle {
  (4mgn_a)
} def

/sequence { (\
GAAUCAAUAGUAGUUAACCCUCUCUUCCGAAGCGAGCCGGGGGCGGUGGGAGCCCGGUGAAGACGGUUAAUGAAACGGCAGUUCC\
) } def

/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 5 0.020555924 ubox
1 8 0.005135579 ubox
1 76 0.025146693 ubox
1 79 0.028803162 ubox
1 82 0.009649243 ubox
1 83 0.040281658 ubox
1 84 0.896483610 ubox
1 85 0.027269627 ubox
2 8 0.008376287 ubox
2 11 0.008743972 ubox
2 15 0.004364353 ubox
2 82 0.046919367 ubox
2 83 0.899359421 ubox
3 8 0.007153261 ubox
3 11 0.020322534 ubox
3 14 0.006124411 ubox
3 82 0.892558358 ubox
3 83 0.025209528 ubox
4 9 0.005837267 ubox
4 10 0.019693208 ubox
4 12 0.006363631 ubox
4 13 0.006359061 ubox
4 73 0.065857096 ubox
4 74 0.003451842 ubox
4 77 0.005627394 ubox
4 78 0.053415847 ubox
4 80 0.059981751 ubox
4 81 0.841253614 ubox
5 10 0.025436694 ubox
5 13 0.006969352 ubox
5 72 0.070092041 ubox
5 77 0.079652066 ubox
5 78 0.203276129 ubox
5 81 0.175218954 ubox
6 11 0.006737962 ubox
6 15 0.004432551 ubox
6 71 0.053602048 ubox
6 82 0.010421284 ubox
6 83 0.025272459 ubox
7 11 0.004799471 ubox
7 14 0.007002789 ubox
7 71 0.005683292 ubox
7 82 0.028438228 ubox
7 83 0.004167702 ubox
8 12 0.004018826 ubox
8 13 0.007272836 ubox
8 69 0.005637332 ubox
8 70 0.005562447 ubox
8 72 0.007908182 ubox
8 73 0.007129305 ubox
8 74 0.021432517 ubox
8 75 0.060586201 ubox
8 77 0.185684555 ubox
8 78 0.096645884 ubox
8 80 0.021291367 ubox
8 81 0.025715611 ubox
9 68 0.005313061 ubox
9 71 0.005911321 ubox
9 82 0.003805592 ubox
10 67 0.003914951 ubox
10 71 0.008841351 ubox
10 76 0.628457709 ubox
10 79 0.058440393 ubox
10 84 0.008482636 ubox
10 85 0.004427034 ubox
11 70 0.007868427 ubox
11 72 0.063225624 ubox
11 73 0.179903916 ubox
11 74 0.161146082 ubox
11 75 0.595047337 ubox
11 77 0.005464166 ubox
11 78 0.055177402 ubox
12 71 0.063644722 ubox
13 53 0.008558883 ubox
13 64 0.003200842 ubox
13 71 0.972557768 ubox
13 76 0.049853327 ubox
13 79 0.009035186 ubox
14 52 0.008543799 ubox
14 63 0.003172291 ubox
14 69 0.005651000 ubox
14 70 0.992519804 ubox
14 72 0.011955832 ubox
14 73 0.008914733 ubox
14 74 0.004614243 ubox
14 75 0.045881885 ubox
14 78 0.008496660 ubox
15 51 0.006836063 ubox
15 69 0.997975326 ubox
15 70 0.008075846 ubox
15 72 0.007936335 ubox
15 73 0.003478394 ubox
15 74 0.027456779 ubox
15 77 0.004234133 ubox
16 68 0.998835899 ubox
16 71 0.006140897 ubox
17 67 0.999244345 ubox
18 50 0.017601369 ubox
18 66 0.998906581 ubox
18 78 0.004541502 ubox
19 48 0.003198419 ubox
19 49 0.017743685 ubox
19 65 0.997252236 ubox
19 66 0.040192871 ubox
19 77 0.004559101 ubox
20 32 0.004925209 ubox
20 34 0.003991260 ubox
20 36 0.029166895 ubox
20 48 0.017752367 ubox
20 52 0.003996126 ubox
20 62 0.023106643 ubox
20 65 0.056200239 ubox
20 66 0.010095128 ubox
21 30 0.008468537 ubox
21 31 0.004474999 ubox
21 35 0.032427533 ubox
21 46 0.012002479 ubox
21 51 0.004021810 ubox
21 60 0.006284280 ubox
21 61 0.022510438 ubox
21 62 0.007241811 ubox
21 63 0.687420147 ubox
21 65 0.012951124 ubox
21 66 0.003178321 ubox
21 73 0.005553652 ubox
22 29 0.009125747 ubox
22 32 0.004611756 ubox
22 34 0.032753918 ubox
22 36 0.004607193 ubox
22 45 0.012841945 ubox
22 46 0.012764925 ubox
22 50 0.004021958 ubox
22 59 0.007787957 ubox
22 62 0.692551327 ubox
22 65 0.011146653 ubox
22 72 0.005646546 ubox
23 30 0.013517698 ubox
23 31 0.003732060 ubox
23 35 0.007781810 ubox
23 45 0.012572118 ubox
23 49 0.003784053 ubox
23 57 0.003311725 ubox
23 59 0.003845168 ubox
23 60 0.251497492 ubox
23 61 0.630839250 ubox
23 63 0.712506334 ubox
23 73 0.003585969 ubox
24 29 0.016947832 ubox
24 32 0.035682907 ubox
24 34 0.009579305 ubox
24 36 0.007592089 ubox
24 42 0.003229881 ubox
24 43 0.033414536 ubox
24 48 0.003614118 ubox
24 52 0.015641893 ubox
24 56 0.005227727 ubox
24 57 0.012626756 ubox
24 59 0.354334878 ubox
24 62 0.718394316 ubox
24 72 0.003679244 ubox
25 31 0.035467663 ubox
25 32 0.004921742 ubox
25 35 0.009243523 ubox
25 36 0.015819960 ubox
25 42 0.033941939 ubox
25 51 0.015714152 ubox
25 56 0.011852493 ubox
25 57 0.009035652 ubox
25 59 0.310279371 ubox
25 60 0.122398424 ubox
25 61 0.718789763 ubox
26 30 0.029571946 ubox
26 31 0.004743185 ubox
26 34 0.008502443 ubox
26 35 0.043601826 ubox
26 41 0.034592289 ubox
26 50 0.015705458 ubox
26 56 0.007872353 ubox
26 57 0.018053215 ubox
26 59 0.117471966 ubox
26 60 0.720119126 ubox
27 32 0.006110880 ubox
27 34 0.045352972 ubox
27 36 0.004240591 ubox
27 40 0.077335523 ubox
27 46 0.003951056 ubox
27 49 0.015721088 ubox
27 56 0.017773274 ubox
27 57 0.678402596 ubox
27 59 0.713814876 ubox
27 66 0.007792666 ubox
28 32 0.016100205 ubox
28 34 0.144052007 ubox
28 36 0.012358541 ubox
28 39 0.079183101 ubox
28 45 0.003958424 ubox
28 48 0.015716945 ubox
28 56 0.681519375 ubox
28 57 0.154427141 ubox
28 59 0.037939426 ubox
28 65 0.007879407 ubox
29 33 0.136266218 ubox
29 37 0.003422719 ubox
29 38 0.079217379 ubox
29 44 0.003919709 ubox
29 47 0.011865216 ubox
29 53 0.006190881 ubox
29 54 0.029193576 ubox
29 55 0.676867147 ubox
29 58 0.021650920 ubox
29 64 0.008112119 ubox
30 58 0.008115206 ubox
31 58 0.009111944 ubox
32 37 0.006322772 ubox
32 44 0.011363070 ubox
32 47 0.006486206 ubox
32 53 0.663024540 ubox
32 54 0.023896268 ubox
32 55 0.003669469 ubox
32 58 0.010467911 ubox
32 64 0.007423281 ubox
33 39 0.013535907 ubox
33 40 0.012895859 ubox
33 43 0.011314107 ubox
33 46 0.006863170 ubox
33 48 0.008358181 ubox
33 49 0.040346952 ubox
33 50 0.192537178 ubox
33 52 0.663834926 ubox
33 56 0.005390799 ubox
33 57 0.006961610 ubox
33 59 0.013489439 ubox
33 62 0.013697213 ubox
34 38 0.012837062 ubox
34 47 0.004905366 ubox
34 53 0.009740079 ubox
34 55 0.004717463 ubox
34 58 0.009323533 ubox
35 47 0.019203218 ubox
35 58 0.028370122 ubox
36 44 0.027738743 ubox
36 47 0.696554297 ubox
36 58 0.701377222 ubox
37 43 0.027772652 ubox
37 46 0.699138104 ubox
37 48 0.004205476 ubox
37 49 0.029559190 ubox
37 50 0.017452828 ubox
37 57 0.708416967 ubox
38 42 0.027571908 ubox
38 45 0.699136996 ubox
38 48 0.029554981 ubox
38 49 0.017484029 ubox
38 56 0.708445278 ubox
38 57 0.004216438 ubox
39 44 0.695987973 ubox
39 47 0.027964796 ubox
39 55 0.702237841 ubox
40 44 0.006749860 ubox
40 47 0.016456280 ubox
40 54 0.700509314 ubox
40 55 0.027190098 ubox
41 53 0.698642472 ubox
41 54 0.033635175 ubox
41 55 0.117390175 ubox
42 47 0.005276800 ubox
42 53 0.034601842 ubox
42 54 0.126282940 ubox
42 58 0.003735899 ubox
43 53 0.134696646 ubox
44 48 0.036540579 ubox
44 49 0.218003156 ubox
44 50 0.625227577 ubox
44 52 0.142170159 ubox
44 56 0.015157204 ubox
44 59 0.023871203 ubox
45 54 0.024032065 ubox
45 55 0.015233054 ubox
45 58 0.024108130 ubox
46 53 0.024471730 ubox
46 54 0.015013744 ubox
47 52 0.024612999 ubox
47 56 0.024370487 ubox
48 53 0.013986068 ubox
48 54 0.007931525 ubox
48 55 0.025634232 ubox
49 53 0.007852748 ubox
49 54 0.025610447 ubox
49 55 0.003276985 ubox
49 85 0.003202313 ubox
50 54 0.003339006 ubox
50 84 0.003933554 ubox
51 68 0.008083585 ubox
51 83 0.004085999 ubox
52 67 0.008902713 ubox
52 79 0.006766357 ubox
52 82 0.004123312 ubox
53 66 0.008024238 ubox
53 78 0.006501024 ubox
53 81 0.004107362 ubox
54 65 0.006915878 ubox
54 66 0.013929337 ubox
54 77 0.005975228 ubox
54 78 0.004689940 ubox
55 65 0.014932145 ubox
55 66 0.003253290 ubox
55 77 0.005081416 ubox
56 64 0.015542332 ubox
56 76 0.005352663 ubox
57 64 0.014744280 ubox
58 63 0.015023672 ubox
59 64 0.006280098 ubox
66 76 0.004361722 ubox
67 75 0.004384980 ubox
68 74 0.004221156 ubox
71 77 0.003942503 ubox
71 80 0.021752871 ubox
72 76 0.010555650 ubox
72 79 0.034171933 ubox
72 83 0.009428254 ubox
72 84 0.183471710 ubox
72 85 0.067584579 ubox
73 82 0.009380470 ubox
73 83 0.153678906 ubox
74 82 0.113399879 ubox
74 83 0.235924186 ubox
75 82 0.276581590 ubox
75 83 0.005119624 ubox
76 81 0.296819092 ubox
77 82 0.008018409 ubox
77 83 0.005689823 ubox
77 84 0.039558982 ubox
77 85 0.074556061 ubox
78 82 0.004683828 ubox
78 83 0.028263659 ubox
78 84 0.074564577 ubox
78 85 0.006132380 ubox
81 85 0.004265639 ubox
1 84 0.9500000 lbox
2 83 0.9500000 lbox
3 82 0.9500000 lbox
4 81 0.9500000 lbox
13 71 0.9500000 lbox
14 70 0.9500000 lbox
15 69 0.9500000 lbox
16 68 0.9500000 lbox
17 67 0.9500000 lbox
18 66 0.9500000 lbox
19 65 0.9500000 lbox
23 63 0.9500000 lbox
24 62 0.9500000 lbox
25 61 0.9500000 lbox
26 60 0.9500000 lbox
27 59 0.9500000 lbox
36 58 0.9500000 lbox
37 57 0.9500000 lbox
38 56 0.9500000 lbox
39 55 0.9500000 lbox
40 54 0.9500000 lbox
41 53 0.9500000 lbox
44 50 0.9500000 lbox
showpage
end
%%EOF
